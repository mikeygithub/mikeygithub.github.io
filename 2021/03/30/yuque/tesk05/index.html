

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <meta name="referrer" content="no-referrer"/>
  <link rel="apple-touch-icon" sizes="76x76" href="https://cdn.jsdelivr.net/gh/mikeygithub/jsDeliver@master/resource/img/favicon.png">
  <link rel="icon" href="https://cdn.jsdelivr.net/gh/mikeygithub/jsDeliver@master/resource/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Mikey">
  <meta name="keywords" content="">
  
    <meta name="description" content="一、 ElasticSerach 认识1.1 索引 index 一个索引可以理解成一个关系数据库的库  1.2 类型 type 一种type就像一类表，比如user表，order表  1.3 映射 mapping mapping定义了每个字段的类型等信息。相当于关系型数据库中的表结  1.4 文档 document 一个document相当于关系型数据库中的一⾏行行记录  1.5 字段 fiel">
<meta property="og:type" content="article">
<meta property="og:title" content="中间件篇-ElasticSearch7.x教程">
<meta property="og:url" content="https://mikeygithub.github.io/2021/03/30/yuque/tesk05/index.html">
<meta property="og:site_name" content="麦奇">
<meta property="og:description" content="一、 ElasticSerach 认识1.1 索引 index 一个索引可以理解成一个关系数据库的库  1.2 类型 type 一种type就像一类表，比如user表，order表  1.3 映射 mapping mapping定义了每个字段的类型等信息。相当于关系型数据库中的表结  1.4 文档 document 一个document相当于关系型数据库中的一⾏行行记录  1.5 字段 fiel">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/2630542/1657549273518-4faedd35-3eac-4bc9-b720-6a89cd313cc9.png">
<meta property="article:published_time" content="2021-03-30T13:34:11.000Z">
<meta property="article:modified_time" content="2023-02-18T16:47:17.866Z">
<meta property="article:author" content="Mikey">
<meta property="article:tag" content="Elasticsearch">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://cdn.nlark.com/yuque/0/2022/png/2630542/1657549273518-4faedd35-3eac-4bc9-b720-6a89cd313cc9.png">
  
  
<!--    <meta name="referrer" content="no-referrer-when-downgrade">-->
  
  
  <title>中间件篇-ElasticSearch7.x教程 - 麦奇</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/custom.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"mikeygithub.github.io","root":"/","version":"1.9.1","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":200}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":"74301a15e5497361e93588eeee69f4b2","google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>

  
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="麦奇" type="application/atom+xml">
</head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>麦奇</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/photo/">
                <i class="iconfont icon-image"></i>
                照片
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/music/">
                <i class="iconfont icon-music"></i>
                音乐
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/atom.xml">
                <i class="iconfont icon-rss"></i>
                RSS
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://cdn.jsdelivr.net/gh/mikeygithub/jsDeliver@master/resource/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="中间件篇-ElasticSearch7.x教程"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        Mikey
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2021-03-30 21:34" pubdate>
          2021年3月30日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          <!-- compatible with older versions-->
          90k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          <!-- compatible with older versions-->
          749 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">中间件篇-ElasticSearch7.x教程</h1>
            
            <div class="markdown-body">
              
              <p><img src="https://cdn.nlark.com/yuque/0/2022/png/2630542/1657549273518-4faedd35-3eac-4bc9-b720-6a89cd313cc9.png#clientId=u3ea2a62a-7bc2-4&from=markdown&id=CpuzB&name=image.png&originHeight=296&originWidth=556&originalType=url&ratio=1&rotation=0&showTitle=false&size=50344&status=done&style=none&taskId=u55f479e1-98ae-4cc9-b545-e30939d294a&title=" srcset="/img/loading.gif" lazyload alt="image.png"></p>
<h3 id="一、-ElasticSerach-认识"><a href="#一、-ElasticSerach-认识" class="headerlink" title="一、 ElasticSerach 认识"></a>一、 ElasticSerach 认识</h3><h4 id="1-1-索引-index"><a href="#1-1-索引-index" class="headerlink" title="1.1 索引 index"></a>1.1 索引 index</h4><ul>
<li>一个索引可以理解成一个关系数据库的库</li>
</ul>
<h4 id="1-2-类型-type"><a href="#1-2-类型-type" class="headerlink" title="1.2 类型 type"></a>1.2 类型 type</h4><ul>
<li>一种type就像一类表，比如user表，order表</li>
</ul>
<h4 id="1-3-映射-mapping"><a href="#1-3-映射-mapping" class="headerlink" title="1.3 映射 mapping"></a>1.3 映射 mapping</h4><ul>
<li>mapping定义了每个字段的类型等信息。相当于关系型数据库中的表结</li>
</ul>
<h4 id="1-4-文档-document"><a href="#1-4-文档-document" class="headerlink" title="1.4 文档 document"></a>1.4 文档 document</h4><ul>
<li>一个document相当于关系型数据库中的一⾏行行记录</li>
</ul>
<h4 id="1-5-字段-field"><a href="#1-5-字段-field" class="headerlink" title="1.5 字段 field"></a>1.5 字段 field</h4><ul>
<li>相当于关系型数据库表的字段</li>
</ul>
<h4 id="1-6-集群-cluster"><a href="#1-6-集群-cluster" class="headerlink" title="1.6 集群 cluster"></a>1.6 集群 cluster</h4><p>-集群由一个或多个节点组成，一个集群有一个默认名称”elasticsearch”</p>
<h4 id="1-7-节点-node"><a href="#1-7-节点-node" class="headerlink" title="1.7 节点 node"></a>1.7 节点 node</h4><ul>
<li>集群的节点，一台机器 或者一个进程</li>
</ul>
<h4 id="1-8-分片和副本-node"><a href="#1-8-分片和副本-node" class="headerlink" title="1.8 分片和副本 node"></a>1.8 分片和副本 node</h4><ul>
<li>副本是分片的副本。分⽚有主分片(primary Shard)和副本分片(replica Shard)之分。Index数据在物理理上被分布在多个主分片中，每个主分片只存放部分数据。每个主分⽚可以有多个副本，叫副本分片，是主分片的复制。</li>
</ul>
<h4 id="1-9-核心数据类型"><a href="#1-9-核心数据类型" class="headerlink" title="1.9 核心数据类型"></a>1.9 核心数据类型</h4><h5 id="1-9-1-字符串"><a href="#1-9-1-字符串" class="headerlink" title="1.9.1 字符串:"></a>1.9.1 字符串:</h5><ul>
<li>text</li>
</ul>
<ol>
<li>用于全文索引，该类型的字段将通过分词器 进⾏分词</li>
</ol>
<ul>
<li>keyword</li>
</ul>
<ol>
<li>不分词，只能搜索该字段的完整的值</li>
</ol>
<h5 id="1-9-2-数值型"><a href="#1-9-2-数值型" class="headerlink" title="1.9.2 数值型"></a>1.9.2 数值型</h5><ol>
<li>long, integer, short, byte, double, float, half_float, scaled_float</li>
</ol>
<h5 id="1-9-3-数值型-boolean"><a href="#1-9-3-数值型-boolean" class="headerlink" title="1.9.3 数值型 boolean"></a>1.9.3 数值型 boolean</h5><ul>
<li>boolean</li>
</ul>
<h5 id="1-9-3-二进制"><a href="#1-9-3-二进制" class="headerlink" title="1.9.3 二进制"></a>1.9.3 二进制</h5><ul>
<li>binary</li>
</ul>
<ol>
<li>该类型的字段把值当做经过 base64 编码的字符串，默认不存储，且不可搜索</li>
</ol>
<h5 id="1-9-4-范围类型"><a href="#1-9-4-范围类型" class="headerlink" title="1.9.4 范围类型"></a>1.9.4 范围类型</h5><ol>
<li>范围类型表示值是一个范围，而不是⼀个具体的值</li>
<li>integer_range, float_range, long_range, double_range, date_range</li>
<li>譬如 age 的类型是 integer_range，那么值可以是 {“gte” : 20, “lte” : 40}；搜索 “term” : {“age”: 21} 可以搜索该值</li>
</ol>
<h5 id="1-9-5-日期"><a href="#1-9-5-日期" class="headerlink" title="1.9.5 日期"></a>1.9.5 日期</h5><ul>
<li>date</li>
</ul>
<ol>
<li>由于Json没有date类型，所以es通过识别字符串是否符合format定义的格式来判断是否为date类型</li>
<li>format默认为：strict_date_optional_time||epoch_millis</li>
<li>“2022-01-01” “2022/01/01 12:10:30” 这种字符串格式</li>
</ol>
<h3 id="二、索引基本操作"><a href="#二、索引基本操作" class="headerlink" title="二、索引基本操作"></a>二、索引基本操作</h3><p><code>基于Kibana进行操作</code></p>
<h4 id="2-1-创建索引-PUT请求"><a href="#2-1-创建索引-PUT请求" class="headerlink" title="2.1 创建索引 PUT请求"></a>2.1 创建索引 PUT请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">PUT /person<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>    <span class="hljs-string">&quot;acknowledged&quot;</span>: <span class="hljs-keyword">true</span>,<br>    <span class="hljs-string">&quot;shards_acknowledged&quot;</span>: <span class="hljs-keyword">true</span>,<br>    <span class="hljs-string">&quot;index&quot;</span>: <span class="hljs-string">&quot;person&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="2-2-查看索引-GET请求"><a href="#2-2-查看索引-GET请求" class="headerlink" title="2.2 查看索引 GET请求"></a>2.2 查看索引 GET请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">PUT /person<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<p>点击展开</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;person&quot;</span> : &#123;<span class="hljs-comment">//索引</span><br>    <span class="hljs-attr">&quot;aliases&quot;</span> : &#123; &#125;,<span class="hljs-comment">//别名</span><br>    <span class="hljs-attr">&quot;mappings&quot;</span> : &#123; &#125;,<span class="hljs-comment">//表结构</span><br>    <span class="hljs-attr">&quot;settings&quot;</span> : &#123;<span class="hljs-comment">//设置</span><br>      <span class="hljs-attr">&quot;index&quot;</span> : &#123;<span class="hljs-comment">//不知道什么鬼</span><br>        <span class="hljs-attr">&quot;routing&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;allocation&quot;</span> : &#123;<br>            <span class="hljs-attr">&quot;include&quot;</span> : &#123;<br>              <span class="hljs-attr">&quot;_tier_preference&quot;</span> : <span class="hljs-string">&quot;data_content&quot;</span><br>            &#125;<br>          &#125;<br>        &#125;,<br>        <span class="hljs-attr">&quot;number_of_shards&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-comment">//分片</span><br>        <span class="hljs-attr">&quot;provided_name&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<span class="hljs-comment">//名字</span><br>        <span class="hljs-attr">&quot;creation_date&quot;</span> : <span class="hljs-string">&quot;1618297457022&quot;</span>,<span class="hljs-comment">//创建时间</span><br>        <span class="hljs-attr">&quot;number_of_replicas&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-comment">//副本</span><br>        <span class="hljs-attr">&quot;uuid&quot;</span> : <span class="hljs-string">&quot;tAkSyPwhT1y-YIXd8aPnrQ&quot;</span>,<span class="hljs-comment">//唯一id</span><br>        <span class="hljs-attr">&quot;version&quot;</span> : &#123;<span class="hljs-comment">//版本</span><br>          <span class="hljs-attr">&quot;created&quot;</span> : <span class="hljs-string">&quot;7120099&quot;</span><br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="2-4-删除索引-DELETE请求"><a href="#2-4-删除索引-DELETE请求" class="headerlink" title="2.4 删除索引 DELETE请求"></a>2.4 删除索引 DELETE请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">DELETE /person<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;acknowledged&quot;</span>: <span class="hljs-literal">true</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="2-5-批量获取索引-GET请求"><a href="#2-5-批量获取索引-GET请求" class="headerlink" title="2.5 批量获取索引 GET请求"></a>2.5 批量获取索引 GET请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /person,animal<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;animal&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;aliases&quot;</span> : &#123; &#125;,<br>    <span class="hljs-attr">&quot;mappings&quot;</span> : &#123; &#125;,<br>    <span class="hljs-attr">&quot;settings&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;index&quot;</span> : &#123;<br>        <span class="hljs-attr">&quot;routing&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;allocation&quot;</span> : &#123;<br>            <span class="hljs-attr">&quot;include&quot;</span> : &#123;<br>              <span class="hljs-attr">&quot;_tier_preference&quot;</span> : <span class="hljs-string">&quot;data_content&quot;</span><br>            &#125;<br>          &#125;<br>        &#125;,<br>        <span class="hljs-attr">&quot;number_of_shards&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>        <span class="hljs-attr">&quot;provided_name&quot;</span> : <span class="hljs-string">&quot;animal&quot;</span>,<br>        <span class="hljs-attr">&quot;creation_date&quot;</span> : <span class="hljs-string">&quot;1618297759538&quot;</span>,<br>        <span class="hljs-attr">&quot;number_of_replicas&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>        <span class="hljs-attr">&quot;uuid&quot;</span> : <span class="hljs-string">&quot;xvlEQJznT_GszJp21OJl4g&quot;</span>,<br>        <span class="hljs-attr">&quot;version&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;created&quot;</span> : <span class="hljs-string">&quot;7120099&quot;</span><br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;person&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;aliases&quot;</span> : &#123; &#125;,<br>    <span class="hljs-attr">&quot;mappings&quot;</span> : &#123; &#125;,<br>    <span class="hljs-attr">&quot;settings&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;index&quot;</span> : &#123;<br>        <span class="hljs-attr">&quot;routing&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;allocation&quot;</span> : &#123;<br>            <span class="hljs-attr">&quot;include&quot;</span> : &#123;<br>              <span class="hljs-attr">&quot;_tier_preference&quot;</span> : <span class="hljs-string">&quot;data_content&quot;</span><br>            &#125;<br>          &#125;<br>        &#125;,<br>        <span class="hljs-attr">&quot;number_of_shards&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>        <span class="hljs-attr">&quot;provided_name&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>        <span class="hljs-attr">&quot;creation_date&quot;</span> : <span class="hljs-string">&quot;1618297742637&quot;</span>,<br>        <span class="hljs-attr">&quot;number_of_replicas&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>        <span class="hljs-attr">&quot;uuid&quot;</span> : <span class="hljs-string">&quot;oZslJJlaRaiOwVktJZEwYw&quot;</span>,<br>        <span class="hljs-attr">&quot;version&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;created&quot;</span> : <span class="hljs-string">&quot;7120099&quot;</span><br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="2-6-获取全部索引-GET请求"><a href="#2-6-获取全部索引-GET请求" class="headerlink" title="2.6 获取全部索引 GET请求"></a>2.6 获取全部索引 GET请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">GET _all<br></code></pre></td></tr></table></figure>


<h4 id="2-7-使用-cat获取全部索引-GET请求"><a href="#2-7-使用-cat获取全部索引-GET请求" class="headerlink" title="2.7 使用_cat获取全部索引 GET请求"></a>2.7 使用_cat获取全部索引 GET请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /_cat/indices?v<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs latex">yellow open   person                          oZslJJlaRaiOwVktJZEwYw   1   1          0            0       208b           208b<br>yellow open   animal                          xvlEQJznT_GszJp21OJl4g   1   1          0            0       208b           208b<br></code></pre></td></tr></table></figure>


<h4 id="2-8-判断索引是否存在-HEAD请求"><a href="#2-8-判断索引是否存在-HEAD请求" class="headerlink" title="2.8 判断索引是否存在 HEAD请求"></a>2.8 判断索引是否存在 HEAD请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">HEAD /person<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs latex">200 - OK<br></code></pre></td></tr></table></figure>


<h4 id="2-9-关闭索引-不删除-POST请求"><a href="#2-9-关闭索引-不删除-POST请求" class="headerlink" title="2.9 关闭索引 不删除 POST请求"></a>2.9 关闭索引 不删除 POST请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">POST /person/_close<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;acknowledged&quot;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">&quot;shards_acknowledged&quot;</span>: <span class="hljs-literal">true</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="2-10-打开索引-POST请求"><a href="#2-10-打开索引-POST请求" class="headerlink" title="2.10 打开索引 POST请求"></a>2.10 打开索引 POST请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">POST /person/_open<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;acknowledged&quot;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">&quot;shards_acknowledged&quot;</span>: <span class="hljs-literal">true</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h3 id="三、映射的介绍与使用"><a href="#三、映射的介绍与使用" class="headerlink" title="三、映射的介绍与使用"></a>三、映射的介绍与使用</h3><ul>
<li>type: text 可分词<code>(划重点)</code></li>
<li>type: keyword 不可分词</li>
</ul>
<h4 id="3-1-创建Mapping-PUT请求"><a href="#3-1-创建Mapping-PUT请求" class="headerlink" title="3.1 创建Mapping PUT请求"></a>3.1 创建Mapping PUT请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java">PUT /person/_mapping<br>&#123;<br>  	<span class="hljs-string">&quot;properties&quot;</span>:&#123;<br>		<span class="hljs-string">&quot;name&quot;</span>:&#123;<br>			<span class="hljs-string">&quot;type&quot;</span>:<span class="hljs-string">&quot;text&quot;</span><br>		&#125;,<br>		<span class="hljs-string">&quot;sex&quot;</span>:&#123;<br>			<span class="hljs-string">&quot;type&quot;</span>:<span class="hljs-string">&quot;keyword&quot;</span><br>		&#125;,<br>		<span class="hljs-string">&quot;idcard&quot;</span>:&#123;<br>			<span class="hljs-string">&quot;type&quot;</span>:<span class="hljs-string">&quot;keyword&quot;</span><br>		&#125;,<br>		<span class="hljs-string">&quot;birthday&quot;</span>:&#123;<br>			<span class="hljs-string">&quot;type&quot;</span>:<span class="hljs-string">&quot;keyword&quot;</span><br>		&#125;,<br>		<span class="hljs-string">&quot;desc&quot;</span>:&#123;<br>			<span class="hljs-string">&quot;type&quot;</span>:<span class="hljs-string">&quot;text&quot;</span><br>		&#125;<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;acknowledged&quot;</span>: <span class="hljs-literal">true</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="3-2-查看Mapping信息-GET请求"><a href="#3-2-查看Mapping信息-GET请求" class="headerlink" title="3.2 查看Mapping信息 GET请求"></a>3.2 查看Mapping信息 GET请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /person/_mapping<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;person&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;mappings&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;properties&quot;</span> : &#123;<br>        <span class="hljs-attr">&quot;birthday&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;keyword&quot;</span><br>        &#125;,<br>        <span class="hljs-attr">&quot;desc&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;text&quot;</span><br>        &#125;,<br>        <span class="hljs-attr">&quot;idcard&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;keyword&quot;</span><br>        &#125;,<br>        <span class="hljs-attr">&quot;name&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;text&quot;</span><br>        &#125;,<br>        <span class="hljs-attr">&quot;sex&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;keyword&quot;</span><br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="3-3-批量获取Mapping信息-GET请求"><a href="#3-3-批量获取Mapping信息-GET请求" class="headerlink" title="3.3 批量获取Mapping信息 GET请求"></a>3.3 批量获取Mapping信息 GET请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /person,animal/_mapping<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;person&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;mappings&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;properties&quot;</span> : &#123;<br>        <span class="hljs-attr">&quot;birthday&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;keyword&quot;</span><br>        &#125;,<br>        <span class="hljs-attr">&quot;desc&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;text&quot;</span><br>        &#125;,<br>        <span class="hljs-attr">&quot;idcard&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;keyword&quot;</span><br>        &#125;,<br>        <span class="hljs-attr">&quot;name&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;text&quot;</span><br>        &#125;,<br>        <span class="hljs-attr">&quot;sex&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;keyword&quot;</span><br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;animal&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;mappings&quot;</span> : &#123; &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="3-4-获取所有Mapping信息第一种方式-GET请求"><a href="#3-4-获取所有Mapping信息第一种方式-GET请求" class="headerlink" title="3.4 获取所有Mapping信息第一种方式 GET请求"></a>3.4 获取所有Mapping信息第一种方式 GET请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /_mapping<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;animal&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;mappings&quot;</span> : &#123; &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;person&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;mappings&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;properties&quot;</span> : &#123;<br>        <span class="hljs-attr">&quot;birthday&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;keyword&quot;</span><br>        &#125;,<br>        <span class="hljs-attr">&quot;desc&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;text&quot;</span><br>        &#125;,<br>        <span class="hljs-attr">&quot;idcard&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;keyword&quot;</span><br>        &#125;,<br>        <span class="hljs-attr">&quot;name&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;text&quot;</span><br>        &#125;,<br>        <span class="hljs-attr">&quot;sex&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;keyword&quot;</span><br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="3-5-获取所有Mapping信息第二种方式-GET请求"><a href="#3-5-获取所有Mapping信息第二种方式-GET请求" class="headerlink" title="3.5 获取所有Mapping信息第二种方式 GET请求"></a>3.5 获取所有Mapping信息第二种方式 GET请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /_all/_mapping<br></code></pre></td></tr></table></figure>


<h4 id="3-6-增加Mapping字段-POST请求"><a href="#3-6-增加Mapping字段-POST请求" class="headerlink" title="3.6 增加Mapping字段 POST请求"></a>3.6 增加Mapping字段 POST请求</h4><ul>
<li> Mapping 只可增加字段<code>不可修改字段</code> </li>
<li> 请求 </li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs json">POST /person/_mapping<br>&#123;<br>  	<span class="hljs-attr">&quot;properties&quot;</span>:&#123;<br>		<span class="hljs-attr">&quot;name&quot;</span>:&#123;<br>			<span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;text&quot;</span><br>		&#125;,<br>		<span class="hljs-attr">&quot;sex&quot;</span>:&#123;<br>			<span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;keyword&quot;</span><br>		&#125;,<br>		<span class="hljs-attr">&quot;idcard&quot;</span>:&#123;<br>			<span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;keyword&quot;</span><br>		&#125;,<br>		<span class="hljs-attr">&quot;birthday&quot;</span>:&#123;<br>			<span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;keyword&quot;</span><br>		&#125;,<br>		<span class="hljs-attr">&quot;desc&quot;</span>:&#123;<br>			<span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;text&quot;</span><br>		&#125;,<br>		<span class="hljs-attr">&quot;hobby&quot;</span>:&#123;<br>		  <span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;text&quot;</span><br>		&#125;<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;acknowledged&quot;</span>: <span class="hljs-literal">true</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h3 id="四、文档的增删改查"><a href="#四、文档的增删改查" class="headerlink" title="四、文档的增删改查"></a>四、文档的增删改查</h3><h4 id="4-1-新增文档-指定ID-PUT-POST请求"><a href="#4-1-新增文档-指定ID-PUT-POST请求" class="headerlink" title="4.1 新增文档 指定ID PUT/POST请求"></a>4.1 新增文档 指定ID PUT/POST请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java">PUT /person/_doc/<span class="hljs-number">1</span><br>&#123;<br>  <span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;麦奇&quot;</span>,<br>  <span class="hljs-string">&quot;sex&quot;</span>:<span class="hljs-string">&quot;男&quot;</span>,<br>  <span class="hljs-string">&quot;idcard&quot;</span>:<span class="hljs-string">&quot;123456789&quot;</span>,<br>  <span class="hljs-string">&quot;birthday&quot;</span>:<span class="hljs-string">&quot;1999/02/20&quot;</span>,<br>  <span class="hljs-string">&quot;desc&quot;</span>:<span class="hljs-string">&quot;麦奇&quot;</span>,<br>  <span class="hljs-string">&quot;hobby&quot;</span>:<span class="hljs-string">&quot;Downhill,table tennis,program design&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>  <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>  <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>  <span class="hljs-attr">&quot;_version&quot;</span> : <span class="hljs-number">1</span>,<br>  <span class="hljs-attr">&quot;result&quot;</span> : <span class="hljs-string">&quot;created&quot;</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">2</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;_seq_no&quot;</span> : <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;_primary_term&quot;</span> : <span class="hljs-number">3</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="4-2-新增文档-自动生成ID-POST请求"><a href="#4-2-新增文档-自动生成ID-POST请求" class="headerlink" title="4.2 新增文档 自动生成ID POST请求"></a>4.2 新增文档 自动生成ID POST请求</h4><ul>
<li> 注意: 不指定IP只能使用<code>POST</code>请求 </li>
<li> 注意: 自动生成ID开关要打开,关闭状态无法自动创建ID </li>
<li> 请求 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java">POST /person/_doc<br>&#123;<br>  <span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;里奥&quot;</span>,<br>  <span class="hljs-string">&quot;sex&quot;</span>:<span class="hljs-string">&quot;男&quot;</span>,<br>  <span class="hljs-string">&quot;idcard&quot;</span>:<span class="hljs-string">&quot;343232323&quot;</span>,<br>  <span class="hljs-string">&quot;birthday&quot;</span>:<span class="hljs-string">&quot;1998/02/20&quot;</span>,<br>  <span class="hljs-string">&quot;desc&quot;</span>:<span class="hljs-string">&quot;一个充满智慧的乌龟&quot;</span>,<br>  <span class="hljs-string">&quot;hobby&quot;</span>:<span class="hljs-string">&quot;program design,双节棍,高科技产品&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>  <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>  <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;khRPyngBRjMpykU9O0ps&quot;</span>,<span class="hljs-comment">// 自动生成ID</span><br>  <span class="hljs-attr">&quot;_version&quot;</span> : <span class="hljs-number">1</span>,<br>  <span class="hljs-attr">&quot;result&quot;</span> : <span class="hljs-string">&quot;created&quot;</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">2</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;_seq_no&quot;</span> : <span class="hljs-number">1</span>,<br>  <span class="hljs-attr">&quot;_primary_term&quot;</span> : <span class="hljs-number">3</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="4-3-自动创建索引-POST请求"><a href="#4-3-自动创建索引-POST请求" class="headerlink" title="4.3 自动创建索引 POST请求"></a>4.3 自动创建索引 POST请求</h4><ul>
<li> 查看auto_create_index开关状态，请求<a target="_blank" rel="noopener" href="http://localhost:9200/_cluster/settings">http://localhost:9200/_cluster/settings</a> </li>
<li> 注意:当索引不存在并且auto_create_index为true的时候，新增文档时会⾃动创建索引，若为false是不能自动创建索引 </li>
<li> 请求 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java">POST /china_person/_doc/<span class="hljs-number">1</span><br>&#123;<br>  <span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;杨虎三&quot;</span>,<br>  <span class="hljs-string">&quot;sex&quot;</span>:<span class="hljs-string">&quot;男&quot;</span>,<br>  <span class="hljs-string">&quot;idcard&quot;</span>:<span class="hljs-string">&quot;765432345&quot;</span>,<br>  <span class="hljs-string">&quot;birthday&quot;</span>:<span class="hljs-string">&quot;1998/02/20&quot;</span>,<br>  <span class="hljs-string">&quot;desc&quot;</span>:<span class="hljs-string">&quot;一个中国人&quot;</span>,<br>  <span class="hljs-string">&quot;hobby&quot;</span>:<span class="hljs-string">&quot;吃、喝、玩、乐&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;china_person&quot;</span>,<span class="hljs-comment">// 自动创建的索引</span><br>  <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>  <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>  <span class="hljs-attr">&quot;_version&quot;</span> : <span class="hljs-number">1</span>,<br>  <span class="hljs-attr">&quot;result&quot;</span> : <span class="hljs-string">&quot;created&quot;</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">2</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;_seq_no&quot;</span> : <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;_primary_term&quot;</span> : <span class="hljs-number">1</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="4-4-查看自动创建的索引-GET请求"><a href="#4-4-查看自动创建的索引-GET请求" class="headerlink" title="4.4 查看自动创建的索引 GET请求"></a>4.4 查看自动创建的索引 GET请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/wperson<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;china_person&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;aliases&quot;</span> : &#123; &#125;,<br>    <span class="hljs-attr">&quot;mappings&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;properties&quot;</span> : &#123;<br>        <span class="hljs-attr">&quot;birthday&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;date&quot;</span>,<br>          <span class="hljs-attr">&quot;format&quot;</span> : <span class="hljs-string">&quot;yyyy/MM/dd HH:mm:ss||yyyy/MM/dd||epoch_millis&quot;</span><br>        &#125;,<br>        <span class="hljs-attr">&quot;desc&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;text&quot;</span>,<br>          <span class="hljs-attr">&quot;fields&quot;</span> : &#123;<br>            <span class="hljs-attr">&quot;keyword&quot;</span> : &#123;<br>              <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;keyword&quot;</span>,<br>              <span class="hljs-attr">&quot;ignore_above&quot;</span> : <span class="hljs-number">256</span><br>            &#125;<br>          &#125;<br>        &#125;,<br>        <span class="hljs-attr">&quot;hobby&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;text&quot;</span>,<br>          <span class="hljs-attr">&quot;fields&quot;</span> : &#123;<br>            <span class="hljs-attr">&quot;keyword&quot;</span> : &#123;<br>              <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;keyword&quot;</span>,<br>              <span class="hljs-attr">&quot;ignore_above&quot;</span> : <span class="hljs-number">256</span><br>            &#125;<br>          &#125;<br>        &#125;,<br>        <span class="hljs-attr">&quot;idcard&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;text&quot;</span>,<br>          <span class="hljs-attr">&quot;fields&quot;</span> : &#123;<br>            <span class="hljs-attr">&quot;keyword&quot;</span> : &#123;<br>              <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;keyword&quot;</span>,<br>              <span class="hljs-attr">&quot;ignore_above&quot;</span> : <span class="hljs-number">256</span><br>            &#125;<br>          &#125;<br>        &#125;,<br>        <span class="hljs-attr">&quot;name&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;text&quot;</span>,<br>          <span class="hljs-attr">&quot;fields&quot;</span> : &#123;<br>            <span class="hljs-attr">&quot;keyword&quot;</span> : &#123;<br>              <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;keyword&quot;</span>,<br>              <span class="hljs-attr">&quot;ignore_above&quot;</span> : <span class="hljs-number">256</span><br>            &#125;<br>          &#125;<br>        &#125;,<br>        <span class="hljs-attr">&quot;sex&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;text&quot;</span>,<br>          <span class="hljs-attr">&quot;fields&quot;</span> : &#123;<br>            <span class="hljs-attr">&quot;keyword&quot;</span> : &#123;<br>              <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;keyword&quot;</span>,<br>              <span class="hljs-attr">&quot;ignore_above&quot;</span> : <span class="hljs-number">256</span><br>            &#125;<br>          &#125;<br>        &#125;<br>      &#125;<br>    &#125;,<br>    <span class="hljs-attr">&quot;settings&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;index&quot;</span> : &#123;<br>        <span class="hljs-attr">&quot;routing&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;allocation&quot;</span> : &#123;<br>            <span class="hljs-attr">&quot;include&quot;</span> : &#123;<br>              <span class="hljs-attr">&quot;_tier_preference&quot;</span> : <span class="hljs-string">&quot;data_content&quot;</span><br>            &#125;<br>          &#125;<br>        &#125;,<br>        <span class="hljs-attr">&quot;number_of_shards&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>        <span class="hljs-attr">&quot;provided_name&quot;</span> : <span class="hljs-string">&quot;china_person&quot;</span>,<br>        <span class="hljs-attr">&quot;creation_date&quot;</span> : <span class="hljs-string">&quot;1618541251930&quot;</span>,<br>        <span class="hljs-attr">&quot;number_of_replicas&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>        <span class="hljs-attr">&quot;uuid&quot;</span> : <span class="hljs-string">&quot;eRdkAL-FQMyPqfef4W9ZbA&quot;</span>,<br>        <span class="hljs-attr">&quot;version&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;created&quot;</span> : <span class="hljs-string">&quot;7120099&quot;</span><br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="4-5-指定操作类型"><a href="#4-5-指定操作类型" class="headerlink" title="4.5 指定操作类型"></a>4.5 指定操作类型</h4><ul>
<li> 新增或修改的时候可能会把原有文档修改掉，这里可以指定类型 </li>
<li> 比如文档存在，我要新增一条文档，但是没有指定类型可能修改掉原有的文档 </li>
<li> 请求 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person/_doc/<span class="hljs-number">1</span>?op_type=create<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json">POST /person/_doc/<span class="hljs-number">2</span>?op_type=create<br>&#123;<br>  <span class="hljs-attr">&quot;name&quot;</span>:<span class="hljs-string">&quot;杨虎三&quot;</span>,<br>  <span class="hljs-attr">&quot;sex&quot;</span>:<span class="hljs-string">&quot;男&quot;</span>,<br>  <span class="hljs-attr">&quot;idcard&quot;</span>:<span class="hljs-string">&quot;765432345&quot;</span>,<br>  <span class="hljs-attr">&quot;birthday&quot;</span>:<span class="hljs-string">&quot;1998/02/20&quot;</span>,<br>  <span class="hljs-attr">&quot;desc&quot;</span>:<span class="hljs-string">&quot;一个中国人&quot;</span>,<br>  <span class="hljs-attr">&quot;hobby&quot;</span>:<span class="hljs-string">&quot;吃、喝、玩、乐&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;error&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;root_cause&quot;</span> : [<br>      &#123;<br>        <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;version_conflict_engine_exception&quot;</span>,<br>        <span class="hljs-attr">&quot;reason&quot;</span> : <span class="hljs-string">&quot;[2]: version conflict, document already exists (current version [1])&quot;</span>,<span class="hljs-comment">// 文档已经存在</span><br>        <span class="hljs-attr">&quot;index_uuid&quot;</span> : <span class="hljs-string">&quot;oZslJJlaRaiOwVktJZEwYw&quot;</span>,<br>        <span class="hljs-attr">&quot;shard&quot;</span> : <span class="hljs-string">&quot;0&quot;</span>,<br>        <span class="hljs-attr">&quot;index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span><br>      &#125;<br>    ],<br>    <span class="hljs-attr">&quot;type&quot;</span> : <span class="hljs-string">&quot;version_conflict_engine_exception&quot;</span>,<br>    <span class="hljs-attr">&quot;reason&quot;</span> : <span class="hljs-string">&quot;[2]: version conflict, document already exists (current version [1])&quot;</span>,<br>    <span class="hljs-attr">&quot;index_uuid&quot;</span> : <span class="hljs-string">&quot;oZslJJlaRaiOwVktJZEwYw&quot;</span>,<br>    <span class="hljs-attr">&quot;shard&quot;</span> : <span class="hljs-string">&quot;0&quot;</span>,<br>    <span class="hljs-attr">&quot;index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;status&quot;</span> : <span class="hljs-number">409</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="4-6-查看指定ID文档-GET请求"><a href="#4-6-查看指定ID文档-GET请求" class="headerlink" title="4.6 查看指定ID文档 GET请求"></a>4.6 查看指定ID文档 GET请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /person/_doc/<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>  <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>  <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>  <span class="hljs-attr">&quot;_version&quot;</span> : <span class="hljs-number">1</span>,<br>  <span class="hljs-attr">&quot;_seq_no&quot;</span> : <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;_primary_term&quot;</span> : <span class="hljs-number">3</span>,<br>  <span class="hljs-attr">&quot;found&quot;</span> : <span class="hljs-literal">true</span>,<br>  <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;麦奇&quot;</span>,<br>    <span class="hljs-attr">&quot;sex&quot;</span> : <span class="hljs-string">&quot;男&quot;</span>,<br>    <span class="hljs-attr">&quot;idcard&quot;</span> : <span class="hljs-string">&quot;123456789&quot;</span>,<br>    <span class="hljs-attr">&quot;birthday&quot;</span> : <span class="hljs-string">&quot;1999/02/20&quot;</span>,<br>    <span class="hljs-attr">&quot;desc&quot;</span> : <span class="hljs-string">&quot;麦奇&quot;</span>,<br>    <span class="hljs-attr">&quot;hobby&quot;</span> : <span class="hljs-string">&quot;Downhill,table tennis,program design&quot;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="4-7-查看多条文档-第一种方式-GET-POST请求"><a href="#4-7-查看多条文档-第一种方式-GET-POST请求" class="headerlink" title="4.7 查看多条文档 第一种方式 GET/POST请求"></a>4.7 查看多条文档 第一种方式 GET/POST请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /_mget<br>&#123;<br>	<span class="hljs-string">&quot;docs&quot;</span> : [<span class="hljs-comment">//  指定标签</span><br>		&#123;<br>			<span class="hljs-string">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>, <span class="hljs-comment">// 指定索引</span><br>			<span class="hljs-string">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>, <span class="hljs-comment">// 默认类型</span><br>			<span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>      <span class="hljs-comment">// 对应id</span><br>		&#125;,<br>		&#123;<br>			<span class="hljs-string">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>			<span class="hljs-string">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>			<span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;2&quot;</span><br>		&#125;<br>	]<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;docs&quot;</span> : [<br>    &#123;<br>      <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>      <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>      <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>      <span class="hljs-attr">&quot;_version&quot;</span> : <span class="hljs-number">1</span>,<br>      <span class="hljs-attr">&quot;_seq_no&quot;</span> : <span class="hljs-number">0</span>,<br>      <span class="hljs-attr">&quot;_primary_term&quot;</span> : <span class="hljs-number">3</span>,<br>      <span class="hljs-attr">&quot;found&quot;</span> : <span class="hljs-literal">true</span>,<br>      <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>        <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;麦奇&quot;</span>,<br>        <span class="hljs-attr">&quot;sex&quot;</span> : <span class="hljs-string">&quot;男&quot;</span>,<br>        <span class="hljs-attr">&quot;idcard&quot;</span> : <span class="hljs-string">&quot;123456789&quot;</span>,<br>        <span class="hljs-attr">&quot;birthday&quot;</span> : <span class="hljs-string">&quot;1999/02/20&quot;</span>,<br>        <span class="hljs-attr">&quot;desc&quot;</span> : <span class="hljs-string">&quot;麦奇&quot;</span>,<br>        <span class="hljs-attr">&quot;hobby&quot;</span> : <span class="hljs-string">&quot;Downhill,table tennis,program design&quot;</span><br>      &#125;<br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>      <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>      <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;2&quot;</span>,<br>      <span class="hljs-attr">&quot;_version&quot;</span> : <span class="hljs-number">1</span>,<br>      <span class="hljs-attr">&quot;_seq_no&quot;</span> : <span class="hljs-number">2</span>,<br>      <span class="hljs-attr">&quot;_primary_term&quot;</span> : <span class="hljs-number">4</span>,<br>      <span class="hljs-attr">&quot;found&quot;</span> : <span class="hljs-literal">true</span>,<br>      <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>        <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;杨虎三&quot;</span>,<br>        <span class="hljs-attr">&quot;sex&quot;</span> : <span class="hljs-string">&quot;男&quot;</span>,<br>        <span class="hljs-attr">&quot;idcard&quot;</span> : <span class="hljs-string">&quot;765432345&quot;</span>,<br>        <span class="hljs-attr">&quot;birthday&quot;</span> : <span class="hljs-string">&quot;1998/02/20&quot;</span>,<br>        <span class="hljs-attr">&quot;desc&quot;</span> : <span class="hljs-string">&quot;一个中国人&quot;</span>,<br>        <span class="hljs-attr">&quot;hobby&quot;</span> : <span class="hljs-string">&quot;吃、喝、玩、乐&quot;</span><br>      &#125;<br>    &#125;<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="4-8-查看多条文档-第二种方式-GET-POST请求"><a href="#4-8-查看多条文档-第二种方式-GET-POST请求" class="headerlink" title="4.8 查看多条文档 第二种方式 GET/POST请求"></a>4.8 查看多条文档 第二种方式 GET/POST请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /person/_mget <span class="hljs-comment">//指定索引</span><br>&#123;<br>  <span class="hljs-string">&quot;docs&quot;</span>:[&#123;<br>    <span class="hljs-string">&quot;_type&quot;</span>: <span class="hljs-string">&quot;_doc&quot;</span>,<br>    <span class="hljs-string">&quot;_id&quot;</span>: <span class="hljs-string">&quot;1&quot;</span><br>  &#125;,&#123;<br>    <span class="hljs-string">&quot;_type&quot;</span>: <span class="hljs-string">&quot;_doc&quot;</span>,<br>    <span class="hljs-string">&quot;_id&quot;</span>: <span class="hljs-string">&quot;2&quot;</span><br>  &#125;]<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;docs&quot;</span> : [<br>    &#123;<br>      <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>      <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>      <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>      <span class="hljs-attr">&quot;_version&quot;</span> : <span class="hljs-number">1</span>,<br>      <span class="hljs-attr">&quot;_seq_no&quot;</span> : <span class="hljs-number">0</span>,<br>      <span class="hljs-attr">&quot;_primary_term&quot;</span> : <span class="hljs-number">3</span>,<br>      <span class="hljs-attr">&quot;found&quot;</span> : <span class="hljs-literal">true</span>,<br>      <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>        <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;麦奇&quot;</span>,<br>        <span class="hljs-attr">&quot;sex&quot;</span> : <span class="hljs-string">&quot;男&quot;</span>,<br>        <span class="hljs-attr">&quot;idcard&quot;</span> : <span class="hljs-string">&quot;123456789&quot;</span>,<br>        <span class="hljs-attr">&quot;birthday&quot;</span> : <span class="hljs-string">&quot;1999/02/20&quot;</span>,<br>        <span class="hljs-attr">&quot;desc&quot;</span> : <span class="hljs-string">&quot;麦奇&quot;</span>,<br>        <span class="hljs-attr">&quot;hobby&quot;</span> : <span class="hljs-string">&quot;Downhill,table tennis,program design&quot;</span><br>      &#125;<br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>      <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>      <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;2&quot;</span>,<br>      <span class="hljs-attr">&quot;_version&quot;</span> : <span class="hljs-number">1</span>,<br>      <span class="hljs-attr">&quot;_seq_no&quot;</span> : <span class="hljs-number">2</span>,<br>      <span class="hljs-attr">&quot;_primary_term&quot;</span> : <span class="hljs-number">4</span>,<br>      <span class="hljs-attr">&quot;found&quot;</span> : <span class="hljs-literal">true</span>,<br>      <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>        <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;杨虎三&quot;</span>,<br>        <span class="hljs-attr">&quot;sex&quot;</span> : <span class="hljs-string">&quot;男&quot;</span>,<br>        <span class="hljs-attr">&quot;idcard&quot;</span> : <span class="hljs-string">&quot;765432345&quot;</span>,<br>        <span class="hljs-attr">&quot;birthday&quot;</span> : <span class="hljs-string">&quot;1998/02/20&quot;</span>,<br>        <span class="hljs-attr">&quot;desc&quot;</span> : <span class="hljs-string">&quot;一个中国人&quot;</span>,<br>        <span class="hljs-attr">&quot;hobby&quot;</span> : <span class="hljs-string">&quot;吃、喝、玩、乐&quot;</span><br>      &#125;<br>    &#125;<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="4-9-查看多条文档-第三种方式-GET-POST请求"><a href="#4-9-查看多条文档-第三种方式-GET-POST请求" class="headerlink" title="4.9 查看多条文档 第三种方式 GET/POST请求"></a>4.9 查看多条文档 第三种方式 GET/POST请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /person/_doc/_mget    <span class="hljs-comment">//指定索引、类型</span><br>&#123;<br>	<span class="hljs-string">&quot;docs&quot;</span> : [<br>		&#123;<br>			<span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;1&quot;</span><br>		&#125;,<br>		&#123;<br>			<span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;2&quot;</span><br>		&#125;<br>	]<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;docs&quot;</span> : [<br>    &#123;<br>      <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>      <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>      <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>      <span class="hljs-attr">&quot;_version&quot;</span> : <span class="hljs-number">1</span>,<br>      <span class="hljs-attr">&quot;_seq_no&quot;</span> : <span class="hljs-number">0</span>,<br>      <span class="hljs-attr">&quot;_primary_term&quot;</span> : <span class="hljs-number">3</span>,<br>      <span class="hljs-attr">&quot;found&quot;</span> : <span class="hljs-literal">true</span>,<br>      <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>        <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;麦奇&quot;</span>,<br>        <span class="hljs-attr">&quot;sex&quot;</span> : <span class="hljs-string">&quot;男&quot;</span>,<br>        <span class="hljs-attr">&quot;idcard&quot;</span> : <span class="hljs-string">&quot;123456789&quot;</span>,<br>        <span class="hljs-attr">&quot;birthday&quot;</span> : <span class="hljs-string">&quot;1999/02/20&quot;</span>,<br>        <span class="hljs-attr">&quot;desc&quot;</span> : <span class="hljs-string">&quot;麦奇&quot;</span>,<br>        <span class="hljs-attr">&quot;hobby&quot;</span> : <span class="hljs-string">&quot;Downhill,table tennis,program design&quot;</span><br>      &#125;<br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>      <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>      <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;2&quot;</span>,<br>      <span class="hljs-attr">&quot;_version&quot;</span> : <span class="hljs-number">1</span>,<br>      <span class="hljs-attr">&quot;_seq_no&quot;</span> : <span class="hljs-number">2</span>,<br>      <span class="hljs-attr">&quot;_primary_term&quot;</span> : <span class="hljs-number">4</span>,<br>      <span class="hljs-attr">&quot;found&quot;</span> : <span class="hljs-literal">true</span>,<br>      <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>        <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;杨虎三&quot;</span>,<br>        <span class="hljs-attr">&quot;sex&quot;</span> : <span class="hljs-string">&quot;男&quot;</span>,<br>        <span class="hljs-attr">&quot;idcard&quot;</span> : <span class="hljs-string">&quot;765432345&quot;</span>,<br>        <span class="hljs-attr">&quot;birthday&quot;</span> : <span class="hljs-string">&quot;1998/02/20&quot;</span>,<br>        <span class="hljs-attr">&quot;desc&quot;</span> : <span class="hljs-string">&quot;一个中国人&quot;</span>,<br>        <span class="hljs-attr">&quot;hobby&quot;</span> : <span class="hljs-string">&quot;吃、喝、玩、乐&quot;</span><br>      &#125;<br>    &#125;<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="4-10-查看多条文档-第四种方式-GET-POST请求"><a href="#4-10-查看多条文档-第四种方式-GET-POST请求" class="headerlink" title="4.10 查看多条文档 第四种方式 GET/POST请求"></a>4.10 查看多条文档 第四种方式 GET/POST请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /person/_doc/_mget<br>&#123;<br>	<span class="hljs-string">&quot;ids&quot;</span>:[<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;2&quot;</span>]<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应 同上</li>
</ul>
<h4 id="4-11-修改文档-POST请求"><a href="#4-11-修改文档-POST请求" class="headerlink" title="4.11 修改文档 POST请求"></a>4.11 修改文档 POST请求</h4><ul>
<li> 根据提供的文档片段更新数据 </li>
<li> 请求 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java">POST /person/_update/<span class="hljs-number">2</span><br>&#123;<br>  <span class="hljs-string">&quot;doc&quot;</span>: &#123;<span class="hljs-comment">// doc标签必须存在</span><br>  	<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;杨虎三&quot;</span>,<br>  	<span class="hljs-string">&quot;sex&quot;</span>:<span class="hljs-string">&quot;男&quot;</span>,<br>  	<span class="hljs-string">&quot;idcard&quot;</span>:<span class="hljs-string">&quot;765432345&quot;</span>,<br>  	<span class="hljs-string">&quot;birthday&quot;</span>:<span class="hljs-string">&quot;1998/02/20&quot;</span>,<br>  	<span class="hljs-string">&quot;desc&quot;</span>:<span class="hljs-string">&quot;实习生小白&quot;</span>,<br>  	<span class="hljs-string">&quot;hobby&quot;</span>:<span class="hljs-string">&quot;coding&quot;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>  <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>  <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;2&quot;</span>,<br>  <span class="hljs-attr">&quot;_version&quot;</span> : <span class="hljs-number">2</span>,<br>  <span class="hljs-attr">&quot;result&quot;</span> : <span class="hljs-string">&quot;updated&quot;</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">2</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;_seq_no&quot;</span> : <span class="hljs-number">3</span>,<br>  <span class="hljs-attr">&quot;_primary_term&quot;</span> : <span class="hljs-number">4</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="4-12-向-source增加字段-POST请求"><a href="#4-12-向-source增加字段-POST请求" class="headerlink" title="4.12 向_source增加字段 POST请求"></a>4.12 向_source增加字段 POST请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">POST /person/_update/<span class="hljs-number">1</span><br>&#123;<br>   <span class="hljs-comment">// script:标签 ctx:上下文 ._source = _source</span><br>   <span class="hljs-comment">// 语义:通过上下文拿到 _source字段,新增age为18</span><br>	<span class="hljs-string">&quot;script&quot;</span>: <span class="hljs-string">&quot;ctx._source.age = 18&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>  <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>  <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>  <span class="hljs-attr">&quot;_version&quot;</span> : <span class="hljs-number">2</span>,<br>  <span class="hljs-attr">&quot;result&quot;</span> : <span class="hljs-string">&quot;updated&quot;</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">2</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;_seq_no&quot;</span> : <span class="hljs-number">4</span>,<br>  <span class="hljs-attr">&quot;_primary_term&quot;</span> : <span class="hljs-number">4</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="4-13-向-source删除字段-POST请求"><a href="#4-13-向-source删除字段-POST请求" class="headerlink" title="4.13 向_source删除字段 POST请求"></a>4.13 向_source删除字段 POST请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">POST /person/_update/<span class="hljs-number">1</span><br>&#123;<br>    <span class="hljs-comment">// json格式无法出现多个&quot; 所以需要转义符</span><br>	<span class="hljs-string">&quot;script&quot;</span>: <span class="hljs-string">&quot;ctx._source.remove(\&quot;age\&quot;)&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>  <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>  <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>  <span class="hljs-attr">&quot;_version&quot;</span> : <span class="hljs-number">3</span>,<br>  <span class="hljs-attr">&quot;result&quot;</span> : <span class="hljs-string">&quot;updated&quot;</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">2</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;_seq_no&quot;</span> : <span class="hljs-number">5</span>,<br>  <span class="hljs-attr">&quot;_primary_term&quot;</span> : <span class="hljs-number">4</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="4-14-更新指定文档的字段-POST请求"><a href="#4-14-更新指定文档的字段-POST请求" class="headerlink" title="4.14 更新指定文档的字段 POST请求"></a>4.14 更新指定文档的字段 POST请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java">POST /person/_update/<span class="hljs-number">1</span><br>&#123;<br>	<span class="hljs-string">&quot;script&quot;</span>: &#123;<br>        <span class="hljs-comment">// 先获取ID为1的数据，之后进行age+4</span><br>		<span class="hljs-string">&quot;source&quot;</span>: <span class="hljs-string">&quot;ctx._source.age += params.age&quot;</span>,<br>        <span class="hljs-comment">// 指定参数</span><br>		<span class="hljs-string">&quot;params&quot;</span>: &#123;<br>			<span class="hljs-string">&quot;age&quot;</span>: <span class="hljs-number">4</span><br>		&#125;<br>	&#125;,<br>    <span class="hljs-comment">// 若存在则修改,若不存在则新增</span><br>	<span class="hljs-string">&quot;upsert&quot;</span>:&#123;<br>		<span class="hljs-string">&quot;age&quot;</span>: <span class="hljs-number">1</span><br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>  <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>  <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>  <span class="hljs-attr">&quot;_version&quot;</span> : <span class="hljs-number">5</span>,<br>  <span class="hljs-attr">&quot;result&quot;</span> : <span class="hljs-string">&quot;updated&quot;</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">2</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;_seq_no&quot;</span> : <span class="hljs-number">7</span>,<br>  <span class="hljs-attr">&quot;_primary_term&quot;</span> : <span class="hljs-number">4</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>查询更新结果</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /person/_doc/<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>  <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>  <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>  <span class="hljs-attr">&quot;_version&quot;</span> : <span class="hljs-number">6</span>,<br>  <span class="hljs-attr">&quot;_seq_no&quot;</span> : <span class="hljs-number">8</span>,<br>  <span class="hljs-attr">&quot;_primary_term&quot;</span> : <span class="hljs-number">4</span>,<br>  <span class="hljs-attr">&quot;found&quot;</span> : <span class="hljs-literal">true</span>,<br>  <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;麦奇&quot;</span>,<br>    <span class="hljs-attr">&quot;sex&quot;</span> : <span class="hljs-string">&quot;男&quot;</span>,<br>    <span class="hljs-attr">&quot;idcard&quot;</span> : <span class="hljs-string">&quot;123456789&quot;</span>,<br>    <span class="hljs-attr">&quot;birthday&quot;</span> : <span class="hljs-string">&quot;1999/02/20&quot;</span>,<br>    <span class="hljs-attr">&quot;desc&quot;</span> : <span class="hljs-string">&quot;麦奇&quot;</span>,<br>    <span class="hljs-attr">&quot;hobby&quot;</span> : <span class="hljs-string">&quot;Downhill,table tennis,program design&quot;</span>,<br>    <span class="hljs-attr">&quot;age&quot;</span> : <span class="hljs-number">22</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="4-15-upsert介绍"><a href="#4-15-upsert介绍" class="headerlink" title="4.15 upsert介绍"></a>4.15 upsert介绍</h4><ul>
<li> upsert 当指定的⽂文档不不存在时，upsert参数包含的内容将会被插⼊入到索引中，作为⼀一个新⽂文档；如果指定的⽂文档存在，ElasticSearch引擎将会执⾏行行指定的更更新逻辑 </li>
<li> 请求 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java">POST /person/_update/<span class="hljs-number">3</span><br>&#123;<br>	<span class="hljs-string">&quot;script&quot;</span>: &#123;<br>		<span class="hljs-string">&quot;source&quot;</span>: <span class="hljs-string">&quot;ctx._source.allstar += params.allstar&quot;</span>,<br>		<span class="hljs-string">&quot;params&quot;</span>: &#123;<br>			<span class="hljs-string">&quot;allstar&quot;</span>: <span class="hljs-number">4</span><br>		&#125;<br>	&#125;,<br>	<span class="hljs-string">&quot;upsert&quot;</span>: &#123;<br>		<span class="hljs-string">&quot;allstar&quot;</span>: <span class="hljs-number">1</span><br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>  <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>  <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;3&quot;</span>,<br>  <span class="hljs-attr">&quot;_version&quot;</span> : <span class="hljs-number">1</span>,<br>  <span class="hljs-attr">&quot;result&quot;</span> : <span class="hljs-string">&quot;created&quot;</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">2</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;_seq_no&quot;</span> : <span class="hljs-number">9</span>,<br>  <span class="hljs-attr">&quot;_primary_term&quot;</span> : <span class="hljs-number">4</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>查询更新结果upsert结果</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /person/_doc/<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>  <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>  <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;3&quot;</span>,<br>  <span class="hljs-attr">&quot;_version&quot;</span> : <span class="hljs-number">1</span>,<br>  <span class="hljs-attr">&quot;_seq_no&quot;</span> : <span class="hljs-number">9</span>,<br>  <span class="hljs-attr">&quot;_primary_term&quot;</span> : <span class="hljs-number">4</span>,<br>  <span class="hljs-attr">&quot;found&quot;</span> : <span class="hljs-literal">true</span>,<br>  <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;allstar&quot;</span> : <span class="hljs-number">1</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="4-16-删除文档-DELETE请求"><a href="#4-16-删除文档-DELETE请求" class="headerlink" title="4.16 删除文档 DELETE请求"></a>4.16 删除文档 DELETE请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">DELETE /person/_doc/<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>  <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>  <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;3&quot;</span>,<br>  <span class="hljs-attr">&quot;_version&quot;</span> : <span class="hljs-number">2</span>,<br>  <span class="hljs-attr">&quot;result&quot;</span> : <span class="hljs-string">&quot;deleted&quot;</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">2</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;_seq_no&quot;</span> : <span class="hljs-number">10</span>,<br>  <span class="hljs-attr">&quot;_primary_term&quot;</span> : <span class="hljs-number">4</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h3 id="五、文档的搜索"><a href="#五、文档的搜索" class="headerlink" title="五、文档的搜索"></a>五、文档的搜索</h3><ul>
<li> term(词条)查询和full text(全⽂)查询 </li>
<li> 词条查询：词条查询不会分析查询条件，只有当词条和查询字符串完全匹配时，才匹配搜索 </li>
<li> 全⽂查询：ElasticSearch引擎会先分析查询字符串，将其拆分成多个分词，只要已分析的字段中包含词条的任意⼀个，或全部包含，就匹配查询条件，返回该⽂档；如果不包含任意一个分词，表示没有任何文档匹配查询条件 </li>
</ul>
<h4 id="5-1-单条term查询-GET-POST请求"><a href="#5-1-单条term查询-GET-POST请求" class="headerlink" title="5.1 单条term查询 GET/POST请求"></a>5.1 单条term查询 GET/POST请求</h4><ul>
<li>term 关键字查询，精确查询</li>
<li>例如SQL的where条件</li>
<li>ES会对其插入的数据进行分词，当为text类型的字段时，分词后使用term查询可能查询不出，可采用精确查询。</li>
<li>请求</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json">GET /person/_search<br>&#123;<br>  <span class="hljs-comment">//查询idcard为765432345的人</span><br>  <span class="hljs-attr">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;term&quot;</span>: &#123;<span class="hljs-comment">//词条</span><br>      <span class="hljs-attr">&quot;idcard&quot;</span>: <span class="hljs-string">&quot;765432345&quot;</span><span class="hljs-comment">//字段名称</span><br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;took&quot;</span> : <span class="hljs-number">1</span>,<br>  <span class="hljs-attr">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;skipped&quot;</span> : <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;hits&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">1</span>,<br>      <span class="hljs-attr">&quot;relation&quot;</span> : <span class="hljs-string">&quot;eq&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;max_score&quot;</span> : <span class="hljs-number">1.6739764</span>,<br>    <span class="hljs-attr">&quot;hits&quot;</span> : [<br>      &#123;<br>        <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>        <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>        <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;2&quot;</span>,<br>        <span class="hljs-attr">&quot;_score&quot;</span> : <span class="hljs-number">1.6739764</span>,<br>        <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;杨虎三&quot;</span>,<br>          <span class="hljs-attr">&quot;sex&quot;</span> : <span class="hljs-string">&quot;男&quot;</span>,<br>          <span class="hljs-attr">&quot;idcard&quot;</span> : <span class="hljs-string">&quot;765432345&quot;</span>,<br>          <span class="hljs-attr">&quot;birthday&quot;</span> : <span class="hljs-string">&quot;1998/02/20&quot;</span>,<br>          <span class="hljs-attr">&quot;desc&quot;</span> : <span class="hljs-string">&quot;实习生小白&quot;</span>,<br>          <span class="hljs-attr">&quot;hobby&quot;</span> : <span class="hljs-string">&quot;coding&quot;</span><br>        &#125;<br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="5-2-多条trem查询-GET-POST请求"><a href="#5-2-多条trem查询-GET-POST请求" class="headerlink" title="5.2 多条trem查询 GET/POST请求"></a>5.2 多条trem查询 GET/POST请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /person/_search<br>&#123;<br>  <span class="hljs-string">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;terms&quot;</span>: &#123;<br>      <span class="hljs-string">&quot;idcard&quot;</span>: [<span class="hljs-string">&quot;343232323&quot;</span>,<span class="hljs-string">&quot;765432345&quot;</span>]<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;took&quot;</span> : <span class="hljs-number">1</span>,<br>  <span class="hljs-attr">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;skipped&quot;</span> : <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;hits&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">2</span>,<br>      <span class="hljs-attr">&quot;relation&quot;</span> : <span class="hljs-string">&quot;eq&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;max_score&quot;</span> : <span class="hljs-number">1.0</span>,<br>    <span class="hljs-attr">&quot;hits&quot;</span> : [<br>      &#123;<br>        <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>        <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>        <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;khRPyngBRjMpykU9O0ps&quot;</span>,<br>        <span class="hljs-attr">&quot;_score&quot;</span> : <span class="hljs-number">1.0</span>,<br>        <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;里奥&quot;</span>,<br>          <span class="hljs-attr">&quot;sex&quot;</span> : <span class="hljs-string">&quot;男&quot;</span>,<br>          <span class="hljs-attr">&quot;idcard&quot;</span> : <span class="hljs-string">&quot;343232323&quot;</span>,<br>          <span class="hljs-attr">&quot;birthday&quot;</span> : <span class="hljs-string">&quot;1998/02/20&quot;</span>,<br>          <span class="hljs-attr">&quot;desc&quot;</span> : <span class="hljs-string">&quot;一个充满智慧的乌龟&quot;</span>,<br>          <span class="hljs-attr">&quot;hobby&quot;</span> : <span class="hljs-string">&quot;program design,双节棍,高科技产品&quot;</span><br>        &#125;<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>        <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>        <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;2&quot;</span>,<br>        <span class="hljs-attr">&quot;_score&quot;</span> : <span class="hljs-number">1.0</span>,<br>        <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;杨虎三&quot;</span>,<br>          <span class="hljs-attr">&quot;sex&quot;</span> : <span class="hljs-string">&quot;男&quot;</span>,<br>          <span class="hljs-attr">&quot;idcard&quot;</span> : <span class="hljs-string">&quot;765432345&quot;</span>,<br>          <span class="hljs-attr">&quot;birthday&quot;</span> : <span class="hljs-string">&quot;1998/02/20&quot;</span>,<br>          <span class="hljs-attr">&quot;desc&quot;</span> : <span class="hljs-string">&quot;实习生小白&quot;</span>,<br>          <span class="hljs-attr">&quot;hobby&quot;</span> : <span class="hljs-string">&quot;coding&quot;</span><br>        &#125;<br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="5-2-match-all查询-GET-POST请求"><a href="#5-2-match-all查询-GET-POST请求" class="headerlink" title="5.2 match_all查询 GET/POST请求"></a>5.2 match_all查询 GET/POST请求</h4><ul>
<li> 全文查询 </li>
<li> 请求 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /person/_search<br>&#123;<br>	<span class="hljs-string">&quot;query&quot;</span>:&#123;<br>		<span class="hljs-string">&quot;match_all&quot;</span>:&#123;&#125; <span class="hljs-comment">// 查询全部文档，默认显示10条记录</span><br>	&#125;,<br>	<span class="hljs-string">&quot;from&quot;</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// 从0开始</span><br>	<span class="hljs-string">&quot;size&quot;</span>: <span class="hljs-number">100</span> <span class="hljs-comment">// 查询100条</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;took&quot;</span> : <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;skipped&quot;</span> : <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;hits&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">3</span>,<br>      <span class="hljs-attr">&quot;relation&quot;</span> : <span class="hljs-string">&quot;eq&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;max_score&quot;</span> : <span class="hljs-number">1.0</span>,<br>    <span class="hljs-attr">&quot;hits&quot;</span> : [<br>      &#123;<br>        <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>        <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>        <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;khRPyngBRjMpykU9O0ps&quot;</span>,<br>        <span class="hljs-attr">&quot;_score&quot;</span> : <span class="hljs-number">1.0</span>,<br>        <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;里奥&quot;</span>,<br>          <span class="hljs-attr">&quot;sex&quot;</span> : <span class="hljs-string">&quot;男&quot;</span>,<br>          <span class="hljs-attr">&quot;idcard&quot;</span> : <span class="hljs-string">&quot;343232323&quot;</span>,<br>          <span class="hljs-attr">&quot;birthday&quot;</span> : <span class="hljs-string">&quot;1998/02/20&quot;</span>,<br>          <span class="hljs-attr">&quot;desc&quot;</span> : <span class="hljs-string">&quot;一个充满智慧的乌龟&quot;</span>,<br>          <span class="hljs-attr">&quot;hobby&quot;</span> : <span class="hljs-string">&quot;program design,双节棍,高科技产品&quot;</span><br>        &#125;<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>        <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>        <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;2&quot;</span>,<br>        <span class="hljs-attr">&quot;_score&quot;</span> : <span class="hljs-number">1.0</span>,<br>        <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;杨虎三&quot;</span>,<br>          <span class="hljs-attr">&quot;sex&quot;</span> : <span class="hljs-string">&quot;男&quot;</span>,<br>          <span class="hljs-attr">&quot;idcard&quot;</span> : <span class="hljs-string">&quot;765432345&quot;</span>,<br>          <span class="hljs-attr">&quot;birthday&quot;</span> : <span class="hljs-string">&quot;1998/02/20&quot;</span>,<br>          <span class="hljs-attr">&quot;desc&quot;</span> : <span class="hljs-string">&quot;实习生小白&quot;</span>,<br>          <span class="hljs-attr">&quot;hobby&quot;</span> : <span class="hljs-string">&quot;coding&quot;</span><br>        &#125;<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>        <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>        <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>        <span class="hljs-attr">&quot;_score&quot;</span> : <span class="hljs-number">1.0</span>,<br>        <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;麦奇&quot;</span>,<br>          <span class="hljs-attr">&quot;sex&quot;</span> : <span class="hljs-string">&quot;男&quot;</span>,<br>          <span class="hljs-attr">&quot;idcard&quot;</span> : <span class="hljs-string">&quot;123456789&quot;</span>,<br>          <span class="hljs-attr">&quot;birthday&quot;</span> : <span class="hljs-string">&quot;1999/02/20&quot;</span>,<br>          <span class="hljs-attr">&quot;desc&quot;</span> : <span class="hljs-string">&quot;麦奇&quot;</span>,<br>          <span class="hljs-attr">&quot;hobby&quot;</span> : <span class="hljs-string">&quot;Downhill,table tennis,program design&quot;</span>,<br>          <span class="hljs-attr">&quot;age&quot;</span> : <span class="hljs-number">26</span><br>        &#125;<br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="5-3-match查询-GET-POST请求"><a href="#5-3-match查询-GET-POST请求" class="headerlink" title="5.3 match查询 GET/POST请求"></a>5.3 match查询 GET/POST请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /person/_search<br>&#123;<br>	<span class="hljs-string">&quot;query&quot;</span>:&#123;<br>		<span class="hljs-string">&quot;match&quot;</span>:&#123; <span class="hljs-comment">// 这里使用match</span><br>			<span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;麦小奇&quot;</span> <span class="hljs-comment">//name:字段 会进行分词匹配</span><br>		&#125;<br>	&#125;,<br>	<span class="hljs-string">&quot;from&quot;</span>: <span class="hljs-number">0</span>,<br>	<span class="hljs-string">&quot;size&quot;</span>: <span class="hljs-number">100</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;took&quot;</span> : <span class="hljs-number">14</span>,<br>  <span class="hljs-attr">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;skipped&quot;</span> : <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;hits&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">1</span>,<br>      <span class="hljs-attr">&quot;relation&quot;</span> : <span class="hljs-string">&quot;eq&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;max_score&quot;</span> : <span class="hljs-number">0.7703978</span>,<br>    <span class="hljs-attr">&quot;hits&quot;</span> : [<br>      &#123;<br>        <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>        <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>        <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>        <span class="hljs-attr">&quot;_score&quot;</span> : <span class="hljs-number">0.7703978</span>,<br>        <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;麦奇&quot;</span>,<br>          <span class="hljs-attr">&quot;sex&quot;</span> : <span class="hljs-string">&quot;男&quot;</span>,<br>          <span class="hljs-attr">&quot;idcard&quot;</span> : <span class="hljs-string">&quot;123456789&quot;</span>,<br>          <span class="hljs-attr">&quot;birthday&quot;</span> : <span class="hljs-string">&quot;1999/02/20&quot;</span>,<br>          <span class="hljs-attr">&quot;desc&quot;</span> : <span class="hljs-string">&quot;麦奇&quot;</span>,<br>          <span class="hljs-attr">&quot;hobby&quot;</span> : <span class="hljs-string">&quot;Downhill,table tennis,program design&quot;</span>,<br>          <span class="hljs-attr">&quot;age&quot;</span> : <span class="hljs-number">26</span><br>        &#125;<br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="5-4-multi-match-多个查询-GET-POST请求"><a href="#5-4-multi-match-多个查询-GET-POST请求" class="headerlink" title="5.4 multi_match 多个查询 GET/POST请求"></a>5.4 multi_match 多个查询 GET/POST请求</h4><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /person/_search<br>&#123;<br>	<span class="hljs-string">&quot;query&quot;</span>:&#123;<br>		<span class="hljs-string">&quot;multi_match&quot;</span>:&#123; <span class="hljs-comment">// 选定多个字段所以使用multi_match</span><br>			<span class="hljs-string">&quot;query&quot;</span>: <span class="hljs-string">&quot;麦奇&quot;</span>, <span class="hljs-comment">// 值</span><br>			<span class="hljs-string">&quot;fields&quot;</span>: [<span class="hljs-string">&quot;name&quot;</span>,<span class="hljs-string">&quot;desc&quot;</span>]  <span class="hljs-comment">// 指定查询的字段</span><br>		&#125;<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;took&quot;</span> : <span class="hljs-number">12</span>,<br>  <span class="hljs-attr">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;skipped&quot;</span> : <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;hits&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">2</span>,<br>      <span class="hljs-attr">&quot;relation&quot;</span> : <span class="hljs-string">&quot;eq&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;max_score&quot;</span> : <span class="hljs-number">1.987459</span>,<br>    <span class="hljs-attr">&quot;hits&quot;</span> : [<br>      &#123;<br>        <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>        <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>        <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>        <span class="hljs-attr">&quot;_score&quot;</span> : <span class="hljs-number">1.987459</span>,<br>        <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;麦奇&quot;</span>,<br>          <span class="hljs-attr">&quot;sex&quot;</span> : <span class="hljs-string">&quot;男&quot;</span>,<br>          <span class="hljs-attr">&quot;idcard&quot;</span> : <span class="hljs-string">&quot;123456789&quot;</span>,<br>          <span class="hljs-attr">&quot;birthday&quot;</span> : <span class="hljs-string">&quot;1999/02/20&quot;</span>,<br>          <span class="hljs-attr">&quot;desc&quot;</span> : <span class="hljs-string">&quot;麦奇&quot;</span>,<br>          <span class="hljs-attr">&quot;hobby&quot;</span> : <span class="hljs-string">&quot;Downhill,table tennis,program design&quot;</span>,<br>          <span class="hljs-attr">&quot;age&quot;</span> : <span class="hljs-number">26</span><br>        &#125;<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>        <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>        <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;_create&quot;</span>,<br>        <span class="hljs-attr">&quot;_score&quot;</span> : <span class="hljs-number">1.3365866</span>,<br>        <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;麦兜&quot;</span>,<br>          <span class="hljs-attr">&quot;sex&quot;</span> : <span class="hljs-string">&quot;男&quot;</span>,<br>          <span class="hljs-attr">&quot;idcard&quot;</span> : <span class="hljs-string">&quot;54343423&quot;</span>,<br>          <span class="hljs-attr">&quot;birthday&quot;</span> : <span class="hljs-string">&quot;1993/02/20&quot;</span>,<br>          <span class="hljs-attr">&quot;desc&quot;</span> : <span class="hljs-string">&quot;麦奇的好朋友&quot;</span>,<br>          <span class="hljs-attr">&quot;hobby&quot;</span> : <span class="hljs-string">&quot;哈哈哈哈哈&quot;</span>,<br>          <span class="hljs-attr">&quot;age&quot;</span> : <span class="hljs-number">26</span><br>        &#125;<br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="5-4-match-phrase-多个查询-GET-POST请求"><a href="#5-4-match-phrase-多个查询-GET-POST请求" class="headerlink" title="5.4 match_phrase 多个查询 GET/POST请求"></a>5.4 match_phrase 多个查询 GET/POST请求</h4><ul>
<li> 准确查询 类似词条查询 </li>
<li> 请求 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /person/_search<br>&#123;<br>	<span class="hljs-string">&quot;query&quot;</span>:&#123;<br>		<span class="hljs-string">&quot;match_phrase&quot;</span>:&#123;<br>			<span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;麦奇&quot;</span><br>		&#125;<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;took&quot;</span> : <span class="hljs-number">1</span>,<br>  <span class="hljs-attr">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;skipped&quot;</span> : <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;hits&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">1</span>,<br>      <span class="hljs-attr">&quot;relation&quot;</span> : <span class="hljs-string">&quot;eq&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;max_score&quot;</span> : <span class="hljs-number">1.987459</span>,<br>    <span class="hljs-attr">&quot;hits&quot;</span> : [<br>      &#123;<br>        <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>        <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>        <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>        <span class="hljs-attr">&quot;_score&quot;</span> : <span class="hljs-number">1.987459</span>,<br>        <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;麦奇&quot;</span>,<br>          <span class="hljs-attr">&quot;sex&quot;</span> : <span class="hljs-string">&quot;男&quot;</span>,<br>          <span class="hljs-attr">&quot;idcard&quot;</span> : <span class="hljs-string">&quot;123456789&quot;</span>,<br>          <span class="hljs-attr">&quot;birthday&quot;</span> : <span class="hljs-string">&quot;1999/02/20&quot;</span>,<br>          <span class="hljs-attr">&quot;desc&quot;</span> : <span class="hljs-string">&quot;麦奇&quot;</span>,<br>          <span class="hljs-attr">&quot;hobby&quot;</span> : <span class="hljs-string">&quot;Downhill,table tennis,program design&quot;</span>,<br>          <span class="hljs-attr">&quot;age&quot;</span> : <span class="hljs-number">26</span><br>        &#125;<br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="5-5-match-phrase-profix-多个查询-GET-POST请求"><a href="#5-5-match-phrase-profix-多个查询-GET-POST请求" class="headerlink" title="5.5 match_phrase_profix 多个查询 GET/POST请求"></a>5.5 match_phrase_profix 多个查询 GET/POST请求</h4><ul>
<li> 可以增加前缀 </li>
<li> 请求 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /person/_search<br>&#123;<br>	<span class="hljs-string">&quot;query&quot;</span>:&#123;<br>		<span class="hljs-string">&quot;match_phrase_prefix&quot;</span>:&#123;<br>			<span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;麦&quot;</span> <span class="hljs-comment">// 指定了前缀</span><br>		&#125;<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;took&quot;</span> : <span class="hljs-number">13</span>,<br>  <span class="hljs-attr">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;skipped&quot;</span> : <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;hits&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">2</span>,<br>      <span class="hljs-attr">&quot;relation&quot;</span> : <span class="hljs-string">&quot;eq&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;max_score&quot;</span> : <span class="hljs-number">0.72615415</span>,<br>    <span class="hljs-attr">&quot;hits&quot;</span> : [<br>      &#123;<br>        <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>        <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>        <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;_create&quot;</span>,<br>        <span class="hljs-attr">&quot;_score&quot;</span> : <span class="hljs-number">0.72615415</span>,<br>        <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;麦兜&quot;</span>,<br>          <span class="hljs-attr">&quot;sex&quot;</span> : <span class="hljs-string">&quot;男&quot;</span>,<br>          <span class="hljs-attr">&quot;idcard&quot;</span> : <span class="hljs-string">&quot;54343423&quot;</span>,<br>          <span class="hljs-attr">&quot;birthday&quot;</span> : <span class="hljs-string">&quot;1993/02/20&quot;</span>,<br>          <span class="hljs-attr">&quot;desc&quot;</span> : <span class="hljs-string">&quot;麦奇的好朋友&quot;</span>,<br>          <span class="hljs-attr">&quot;hobby&quot;</span> : <span class="hljs-string">&quot;哈哈哈哈哈&quot;</span>,<br>          <span class="hljs-attr">&quot;age&quot;</span> : <span class="hljs-number">26</span><br>        &#125;<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>        <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>        <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>        <span class="hljs-attr">&quot;_score&quot;</span> : <span class="hljs-number">0.72615415</span>,<br>        <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;麦奇&quot;</span>,<br>          <span class="hljs-attr">&quot;sex&quot;</span> : <span class="hljs-string">&quot;男&quot;</span>,<br>          <span class="hljs-attr">&quot;idcard&quot;</span> : <span class="hljs-string">&quot;123456789&quot;</span>,<br>          <span class="hljs-attr">&quot;birthday&quot;</span> : <span class="hljs-string">&quot;1999/02/20&quot;</span>,<br>          <span class="hljs-attr">&quot;desc&quot;</span> : <span class="hljs-string">&quot;麦奇&quot;</span>,<br>          <span class="hljs-attr">&quot;hobby&quot;</span> : <span class="hljs-string">&quot;Downhill,table tennis,program design&quot;</span>,<br>          <span class="hljs-attr">&quot;age&quot;</span> : <span class="hljs-number">26</span><br>        &#125;<br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h3 id="六、ElasticSerach-搜索"><a href="#六、ElasticSerach-搜索" class="headerlink" title="六、ElasticSerach 搜索"></a>六、ElasticSerach 搜索</h3><h4 id="6-1-批量导入数据"><a href="#6-1-批量导入数据" class="headerlink" title="6.1 批量导入数据"></a>6.1 批量导入数据</h4><ul>
<li>Bulkl</li>
</ul>
<ol>
<li>ES提供了Bulk的API 来进行批量操作</li>
</ol>
<ul>
<li>数据结构类型，以换行区分</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-comment">// 必须有一个索引叫book</span><br>&#123;<span class="hljs-attr">&quot;index&quot;</span>: &#123;<span class="hljs-attr">&quot;_index&quot;</span>: <span class="hljs-string">&quot;book&quot;</span>, <span class="hljs-attr">&quot;_type&quot;</span>: <span class="hljs-string">&quot;_doc&quot;</span>, <span class="hljs-attr">&quot;_id&quot;</span>: <span class="hljs-number">1</span>&#125;&#125;<br>&#123;<span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;Java编程思想&quot;</span>&#125;<br>&#123;<span class="hljs-attr">&quot;index&quot;</span>: &#123;<span class="hljs-attr">&quot;_index&quot;</span>: <span class="hljs-string">&quot;book&quot;</span>, <span class="hljs-attr">&quot;_type&quot;</span>: <span class="hljs-string">&quot;_doc&quot;</span>, <span class="hljs-attr">&quot;_id&quot;</span>: <span class="hljs-number">2</span>&#125;&#125;<br>&#123;<span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;设计模式&quot;</span>&#125;<br> <span class="hljs-comment">// 结尾必须有换行</span><br></code></pre></td></tr></table></figure>

<ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">curl -X POST <span class="hljs-string">&quot;localhost:9200/_bulk&quot;</span> -H <span class="hljs-string">&#x27;Content-Type: application/json&#x27;</span> --data-binary <span class="hljs-meta">@name</span> <span class="hljs-comment">// name就是文件的路径和名字</span><br></code></pre></td></tr></table></figure>

<ul>
<li>测试 查询</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>	<span class="hljs-attr">&quot;query&quot;</span>:&#123;<br>		<span class="hljs-attr">&quot;match_all&quot;</span>:&#123;&#125;<br>	&#125;,<br>	<span class="hljs-attr">&quot;from&quot;</span>: <span class="hljs-number">0</span>,<br>	<span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">100</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="6-2-trem多种查询"><a href="#6-2-trem多种查询" class="headerlink" title="6.2 trem多种查询"></a>6.2 trem多种查询</h4><ul>
<li>单词级别查询</li>
</ul>
<ol>
<li>这些查询通常⽤用于结构化的数据，⽐比如：number, date, keyword等，而不是对text。</li>
<li>也就是说，全⽂本查询之前要先对⽂本内容进⾏分词，⽽单词级别的查询直接在相应字段的反向索引中精确查找，单词级别的查询⼀般⽤于数值、⽇期等类型的字段上</li>
<li>去找个<a target="_blank" rel="noopener" href="http://www.yyyweb.com/demo/inner-show/json-generator.html">网站</a>生成数据导入</li>
</ol>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs json">[<br>  &#x27;&#123;&#123;repeat(20, 30)&#125;&#125;&#x27;,<br>&#123;<br>          name : &#x27;&#123;&#123;firstName()&#125;&#125; &#123;&#123;surname()&#125;&#125;&#x27;,<br>          sex : &#x27;&#123;&#123;random(<span class="hljs-attr">&quot;女&quot;</span>, <span class="hljs-attr">&quot;男&quot;</span>)&#125;&#125;&#x27;,<br>          idcard : &#x27;&#123;&#123;objectId()&#125;&#125;&#x27;,<br>          birthday : &#x27;&#123;&#123;date(new Date(2014, 0, 1), new Date(), <span class="hljs-attr">&quot;YYYY-MM-ddThh:mm:ss Z&quot;</span>)&#125;&#125;&#x27;,<br>          desc : &#x27;&#123;&#123;lorem(1, <span class="hljs-attr">&quot;paragraphs&quot;</span>)&#125;&#125;&#x27;,<br>          hobby : &#x27;&#123;&#123;lorem(1, <span class="hljs-attr">&quot;words&quot;</span>)&#125;&#125;&#x27;,<br>          age : &#x27;&#123;&#123;integer(20, 40)&#125;&#125;&#x27;<br>&#125;]<br></code></pre></td></tr></table></figure>


<h5 id="6-2-1-term-query-精准匹配查询-GET-POST请求"><a href="#6-2-1-term-query-精准匹配查询-GET-POST请求" class="headerlink" title="6.2.1 term query 精准匹配查询 GET/POST请求"></a>6.2.1 term query 精准匹配查询 GET/POST请求</h5><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /person/_search<br>&#123;<br>  <span class="hljs-string">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;term&quot;</span>: &#123;<br>      <span class="hljs-string">&quot;idcard&quot;</span>: <span class="hljs-number">343232323</span><br>    &#125;<br>  &#125;,<br>  <span class="hljs-string">&quot;from&quot;</span>: <span class="hljs-number">0</span>,<br>  <span class="hljs-string">&quot;size&quot;</span>: <span class="hljs-number">20</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;took&quot;</span> : <span class="hljs-number">9</span>,<br>  <span class="hljs-attr">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;skipped&quot;</span> : <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;hits&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">1</span>,<br>      <span class="hljs-attr">&quot;relation&quot;</span> : <span class="hljs-string">&quot;eq&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;max_score&quot;</span> : <span class="hljs-number">1.2039728</span>,<br>    <span class="hljs-attr">&quot;hits&quot;</span> : [<br>      &#123;<br>        <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>        <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>        <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;khRPyngBRjMpykU9O0ps&quot;</span>,<br>        <span class="hljs-attr">&quot;_score&quot;</span> : <span class="hljs-number">1.2039728</span>,<br>        <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;里奥&quot;</span>,<br>          <span class="hljs-attr">&quot;sex&quot;</span> : <span class="hljs-string">&quot;男&quot;</span>,<br>          <span class="hljs-attr">&quot;idcard&quot;</span> : <span class="hljs-string">&quot;343232323&quot;</span>,<br>          <span class="hljs-attr">&quot;birthday&quot;</span> : <span class="hljs-string">&quot;1998/02/20&quot;</span>,<br>          <span class="hljs-attr">&quot;desc&quot;</span> : <span class="hljs-string">&quot;一个充满智慧的乌龟&quot;</span>,<br>          <span class="hljs-attr">&quot;hobby&quot;</span> : <span class="hljs-string">&quot;program design,双节棍,高科技产品&quot;</span><br>        &#125;<br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="6-2-2-exsit-query-在特定的字段中查找非空值的文档-GET-POST请求"><a href="#6-2-2-exsit-query-在特定的字段中查找非空值的文档-GET-POST请求" class="headerlink" title="6.2.2 exsit query 在特定的字段中查找非空值的文档 GET/POST请求"></a>6.2.2 exsit query 在特定的字段中查找非空值的文档 GET/POST请求</h5><ul>
<li>请求</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">GET /person/_search<br>&#123;<br>  &quot;query&quot;: &#123;<br>    &quot;exists&quot;: &#123;<br>      &quot;field&quot;: &quot;age&quot;//查询存在age的记录<br>    &#125;<br>  &#125;,<br>  &quot;from&quot;: 0,<br>  &quot;size&quot;: 3<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;took&quot;</span> : <span class="hljs-number">6</span>,<br>  <span class="hljs-attr">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;skipped&quot;</span> : <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;hits&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">2</span>,<br>      <span class="hljs-attr">&quot;relation&quot;</span> : <span class="hljs-string">&quot;eq&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;max_score&quot;</span> : <span class="hljs-number">1.0</span>,<br>    <span class="hljs-attr">&quot;hits&quot;</span> : [<br>      &#123;<br>        <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>        <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>        <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>        <span class="hljs-attr">&quot;_score&quot;</span> : <span class="hljs-number">1.0</span>,<br>        <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;麦奇&quot;</span>,<br>          <span class="hljs-attr">&quot;sex&quot;</span> : <span class="hljs-string">&quot;男&quot;</span>,<br>          <span class="hljs-attr">&quot;idcard&quot;</span> : <span class="hljs-string">&quot;123456789&quot;</span>,<br>          <span class="hljs-attr">&quot;birthday&quot;</span> : <span class="hljs-string">&quot;1999/02/20&quot;</span>,<br>          <span class="hljs-attr">&quot;desc&quot;</span> : <span class="hljs-string">&quot;麦奇&quot;</span>,<br>          <span class="hljs-attr">&quot;hobby&quot;</span> : <span class="hljs-string">&quot;Downhill,table tennis,program design&quot;</span>,<br>          <span class="hljs-attr">&quot;age&quot;</span> : <span class="hljs-number">26</span><br>        &#125;<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>        <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>        <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;_create&quot;</span>,<br>        <span class="hljs-attr">&quot;_score&quot;</span> : <span class="hljs-number">1.0</span>,<br>        <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;Julie Peters&quot;</span>,<br>          <span class="hljs-attr">&quot;sex&quot;</span> : <span class="hljs-string">&quot;男&quot;</span>,<br>          <span class="hljs-attr">&quot;idcard&quot;</span> : <span class="hljs-string">&quot;6079270de8b8f59c77eb3cd2&quot;</span>,<br>          <span class="hljs-attr">&quot;birthday&quot;</span> : <span class="hljs-string">&quot;2021-01-26T05:17:20 -08:00&quot;</span>,<br>          <span class="hljs-attr">&quot;hobby&quot;</span> : <span class="hljs-string">&quot;quis&quot;</span>,<br>          <span class="hljs-attr">&quot;age&quot;</span> : <span class="hljs-number">29</span><br>        &#125;<br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="6-2-3-prefix-query-查找包含带有指定前缀term的文档-GET-POST请求"><a href="#6-2-3-prefix-query-查找包含带有指定前缀term的文档-GET-POST请求" class="headerlink" title="6.2.3 prefix query 查找包含带有指定前缀term的文档 GET/POST请求"></a>6.2.3 prefix query 查找包含带有指定前缀term的文档 GET/POST请求</h5><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /person/_search<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-comment">// 语义:查找teamNameEn 不为空的数据 teamNameEn必须为text类型</span><br>  <span class="hljs-comment">// 使用前缀类型必须为keyword,不能为text</span><br>  <span class="hljs-attr">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;prefix&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;麦&quot;</span><br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;from&quot;</span>: <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">3</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;took&quot;</span> : <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;skipped&quot;</span> : <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;hits&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">2</span>,<br>      <span class="hljs-attr">&quot;relation&quot;</span> : <span class="hljs-string">&quot;eq&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;max_score&quot;</span> : <span class="hljs-number">1.0</span>,<br>    <span class="hljs-attr">&quot;hits&quot;</span> : [<br>      &#123;<br>        <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>        <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>        <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>        <span class="hljs-attr">&quot;_score&quot;</span> : <span class="hljs-number">1.0</span>,<br>        <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;麦奇&quot;</span>,<br>          <span class="hljs-attr">&quot;sex&quot;</span> : <span class="hljs-string">&quot;男&quot;</span>,<br>          <span class="hljs-attr">&quot;idcard&quot;</span> : <span class="hljs-string">&quot;123456789&quot;</span>,<br>          <span class="hljs-attr">&quot;birthday&quot;</span> : <span class="hljs-string">&quot;1999/02/20&quot;</span>,<br>          <span class="hljs-attr">&quot;desc&quot;</span> : <span class="hljs-string">&quot;麦奇&quot;</span>,<br>          <span class="hljs-attr">&quot;hobby&quot;</span> : <span class="hljs-string">&quot;Downhill,table tennis,program design&quot;</span>,<br>          <span class="hljs-attr">&quot;age&quot;</span> : <span class="hljs-number">26</span><br>        &#125;<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>        <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>        <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;_create&quot;</span>,<br>        <span class="hljs-attr">&quot;_score&quot;</span> : <span class="hljs-number">1.0</span>,<br>        <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;麦兜&quot;</span>,<br>          <span class="hljs-attr">&quot;sex&quot;</span> : <span class="hljs-string">&quot;男&quot;</span>,<br>          <span class="hljs-attr">&quot;idcard&quot;</span> : <span class="hljs-string">&quot;54343423&quot;</span>,<br>          <span class="hljs-attr">&quot;birthday&quot;</span> : <span class="hljs-string">&quot;1993/02/20&quot;</span>,<br>          <span class="hljs-attr">&quot;desc&quot;</span> : <span class="hljs-string">&quot;麦奇的好朋友&quot;</span>,<br>          <span class="hljs-attr">&quot;hobby&quot;</span> : <span class="hljs-string">&quot;哈哈哈哈哈&quot;</span>,<br>          <span class="hljs-attr">&quot;age&quot;</span> : <span class="hljs-number">26</span><br>        &#125;<br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="6-2-4-wildcard-query-支持通配符查询-GET-POST请求"><a href="#6-2-4-wildcard-query-支持通配符查询-GET-POST请求" class="headerlink" title="6.2.4 wildcard query 支持通配符查询 GET/POST请求"></a>6.2.4 wildcard query 支持通配符查询 GET/POST请求</h5><ul>
<li> *表示任意字符，?表示任意单个字符,类似SQL模糊查询 </li>
<li> 请求 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /person/_search<br>&#123;<br>  <span class="hljs-comment">// 语义: 查询name为Ro*s *为模糊搜索</span><br>  <span class="hljs-string">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;wildcard&quot;</span>: &#123;<br>      <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Ro*s&quot;</span><br>    &#125;<br>  &#125;,<br>  <span class="hljs-string">&quot;from&quot;</span>: <span class="hljs-number">0</span>,<br>  <span class="hljs-string">&quot;size&quot;</span>: <span class="hljs-number">3</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="6-2-5-regexp-query-正则表达式查询-GET-POST请求"><a href="#6-2-5-regexp-query-正则表达式查询-GET-POST请求" class="headerlink" title="6.2.5 regexp query 正则表达式查询 GET/POST请求"></a>6.2.5 regexp query 正则表达式查询 GET/POST请求</h5><ul>
<li>请求</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell">GET /person/_search<br>&#123;<br>  // 语义: 查询name 为Ro.*s  .表示任意 *为多个<br>  &quot;query&quot;: &#123;<br>    &quot;regexp&quot;: &#123;<br>      &quot;name&quot;: &quot;Ro.*s&quot;<br>    &#125;<br>  &#125;,<br>  &quot;from&quot;: 0,<br>  &quot;size&quot;: 3<br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="6-2-6-ids-query-通过id批量查询-GET-POST请求"><a href="#6-2-6-ids-query-通过id批量查询-GET-POST请求" class="headerlink" title="6.2.6 ids query 通过id批量查询 GET/POST请求"></a>6.2.6 ids query 通过id批量查询 GET/POST请求</h5><ul>
<li>请求</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs json">GET /person/_search<br>&#123;<br>  <span class="hljs-attr">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;ids&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;values&quot;</span>: [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;from&quot;</span>: <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">3</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="6-3-范围查询"><a href="#6-3-范围查询" class="headerlink" title="6.3 范围查询"></a>6.3 范围查询</h4><h5 id="6-3-1-第一种范围查询-GET-POST请求"><a href="#6-3-1-第一种范围查询-GET-POST请求" class="headerlink" title="6.3.1 第一种范围查询 GET/POST请求"></a>6.3.1 第一种范围查询 GET/POST请求</h5><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /person/_search<br>&#123;<br>  <span class="hljs-comment">// 语义: 查找在person打了2年年到10年以内的球员</span><br>  <span class="hljs-string">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;range&quot;</span>: &#123;<br>      <span class="hljs-string">&quot;playYear&quot;</span>:&#123; <span class="hljs-comment">//playYear 是Long类型 不要写成字符串</span><br>      	<span class="hljs-string">&quot;gte&quot;</span>: <span class="hljs-number">2</span>,<br>      	<span class="hljs-string">&quot;lte&quot;</span> : <span class="hljs-number">10</span><br>      &#125;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-string">&quot;from&quot;</span>: <span class="hljs-number">0</span>,<br>  <span class="hljs-string">&quot;size&quot;</span>: <span class="hljs-number">3</span><br>&#125;<br></code></pre></td></tr></table></figure>

<blockquote>
<p>gt: greater than 大于<br>gte: greater than or equal 大于等于<br>lt: less than 小于<br>lte: less than or equal 小于等于</p>
</blockquote>
<h5 id="6-3-2-第二种范围查询-GET-POST请求"><a href="#6-3-2-第二种范围查询-GET-POST请求" class="headerlink" title="6.3.2 第二种范围查询 GET/POST请求"></a>6.3.2 第二种范围查询 GET/POST请求</h5><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /person/_search<br>&#123;<br>    <span class="hljs-comment">// 语义: 查找1980年年到1999年年出⽣生的球员</span><br>  <span class="hljs-string">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;range&quot;</span>: &#123;<br>      <span class="hljs-string">&quot;birthDay&quot;</span>:&#123;<br>      	<span class="hljs-string">&quot;gte&quot;</span>: <span class="hljs-string">&quot;01/01/1999&quot;</span>,<br>      	<span class="hljs-string">&quot;lte&quot;</span> : <span class="hljs-string">&quot;1999&quot;</span>,,<br>      	<span class="hljs-string">&quot;format&quot;</span>: <span class="hljs-string">&quot;dd/MM/yyyy||yyyy&quot;</span> <span class="hljs-comment">// 日期格式要对应get lte</span><br>      &#125;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-string">&quot;from&quot;</span>: <span class="hljs-number">0</span>,<br>  <span class="hljs-string">&quot;size&quot;</span>: <span class="hljs-number">3</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="6-4-布尔查询"><a href="#6-4-布尔查询" class="headerlink" title="6.4 布尔查询"></a>6.4 布尔查询</h4><table>
<thead>
<tr>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody><tr>
<td>must</td>
<td>必须出现在匹配文档中</td>
</tr>
<tr>
<td>filter</td>
<td>必须出现在文档中，但是不打分</td>
</tr>
<tr>
<td>must_not</td>
<td>不能出现在文档中</td>
</tr>
<tr>
<td>should</td>
<td>应该出现在文档中</td>
</tr>
</tbody></table>
<h5 id="6-4-1-must查询-GET-POST请求"><a href="#6-4-1-must查询-GET-POST请求" class="headerlink" title="6.4.1 must查询 GET/POST请求"></a>6.4.1 must查询 GET/POST请求</h5><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /person/_search<br>&#123;<br>  <span class="hljs-comment">// 语义: 查询名字叫做james的人</span><br>  <span class="hljs-string">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;bool&quot;</span>: &#123; <span class="hljs-comment">// 布尔查询</span><br>      <span class="hljs-string">&quot;must&quot;</span>:[ <span class="hljs-comment">//匹配查询方式</span><br>        &#123;<br>          <span class="hljs-string">&quot;match&quot;</span>: &#123; <span class="hljs-comment">// 全文搜索</span><br>            <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;james&quot;</span><br>          &#125;<br>        &#125;<br>      ]<br>    &#125;<br>  &#125;,<br>  <span class="hljs-string">&quot;from&quot;</span>: <span class="hljs-number">0</span>,<br>  <span class="hljs-string">&quot;size&quot;</span>: <span class="hljs-number">3</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="6-4-2-filter查询-GET-POST请求"><a href="#6-4-2-filter查询-GET-POST请求" class="headerlink" title="6.4.2 filter查询 GET/POST请求"></a>6.4.2 filter查询 GET/POST请求</h5><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /person/_search<br>&#123;<br>  <span class="hljs-comment">// 语义: 查询名字叫做james的球员 不包含打分</span><br>  <span class="hljs-string">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;bool&quot;</span>: &#123;<br>      <span class="hljs-string">&quot;filter&quot;</span>:[<br>        &#123;<br>          <span class="hljs-string">&quot;match&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;james&quot;</span><br>          &#125;<br>        &#125;<br>      ]<br>    &#125;<br>  &#125;,<br>  <span class="hljs-string">&quot;from&quot;</span>: <span class="hljs-number">0</span>,<br>  <span class="hljs-string">&quot;size&quot;</span>: <span class="hljs-number">3</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="6-4-3-must-not查询-GET-POST请求"><a href="#6-4-3-must-not查询-GET-POST请求" class="headerlink" title="6.4.3 must_not查询 GET/POST请求"></a>6.4.3 must_not查询 GET/POST请求</h5><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person/_search<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-comment">// 语义: 查询名字叫做james的人,一定不在东部的</span><br>  <span class="hljs-attr">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;bool&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;filter&quot;</span>:[<br>        &#123;<br>          <span class="hljs-attr">&quot;match&quot;</span>: &#123;<br>            <span class="hljs-attr">&quot;displayNameEn&quot;</span>: <span class="hljs-string">&quot;james&quot;</span><br>          &#125;<br>        &#125;<br>      ],<br>      <span class="hljs-attr">&quot;must_not&quot;</span>: [<br>        &#123;<br>          <span class="hljs-attr">&quot;term&quot;</span>: &#123;<br>            <span class="hljs-attr">&quot;teamConferenceEn&quot;</span>: &#123;<br>              <span class="hljs-attr">&quot;value&quot;</span>: <span class="hljs-string">&quot;eastern&quot;</span><br>            &#125;<br>          &#125;<br>        &#125;<br>      ]<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;from&quot;</span>: <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">3</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="6-4-4-should-第一种-查询-GET-POST请求"><a href="#6-4-4-should-第一种-查询-GET-POST请求" class="headerlink" title="6.4.4 should 第一种 查询 GET/POST请求"></a>6.4.4 should 第一种 查询 GET/POST请求</h5><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person/_search<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-comment">// 语义: 查找名字叫做james的打球时间应该在11到20年的西部球员</span><br>    <span class="hljs-comment">// should应该 但是不是必须</span><br>  <span class="hljs-attr">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;bool&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;filter&quot;</span>:[<br>        &#123;<br>          <span class="hljs-attr">&quot;match&quot;</span>: &#123;<br>            <span class="hljs-attr">&quot;displayNameEn&quot;</span>: <span class="hljs-string">&quot;james&quot;</span><br>          &#125;<br>        &#125;<br>      ],<br>      <span class="hljs-attr">&quot;must_not&quot;</span>: [<br>        &#123;<br>          <span class="hljs-attr">&quot;term&quot;</span>: &#123;<br>            <span class="hljs-attr">&quot;teamConferenceEn&quot;</span>: &#123;<br>              <span class="hljs-attr">&quot;value&quot;</span>: <span class="hljs-string">&quot;eastern&quot;</span><br>            &#125;<br>          &#125;<br>        &#125;<br>      ],<br>      <span class="hljs-attr">&quot;should&quot;</span>: [<br>        &#123;<br>          <span class="hljs-attr">&quot;range&quot;</span>: &#123;<br>            <span class="hljs-attr">&quot;playYear&quot;</span>: &#123;<br>              <span class="hljs-attr">&quot;gte&quot;</span>: <span class="hljs-number">11</span>,<br>              <span class="hljs-attr">&quot;lte&quot;</span>: <span class="hljs-number">20</span><br>            &#125;<br>          &#125;<br>        &#125;<br>      ]<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;from&quot;</span>: <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">3</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="6-4-5-should-第二种-查询-GET-POST请求"><a href="#6-4-5-should-第二种-查询-GET-POST请求" class="headerlink" title="6.4.5 should 第二种 查询 GET/POST请求"></a>6.4.5 should 第二种 查询 GET/POST请求</h5><ul>
<li>请求</li>
</ul>
<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-comment">// 语义: 查找名字叫做james的打球时间应该在11到20年的西部球员</span><br>    <span class="hljs-comment">// minimum_should_match = 1 最小匹配精度,至少有一个条件满足</span><br>  <span class="hljs-attr">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;bool&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;filter&quot;</span>:[<br>        &#123;<br>          <span class="hljs-attr">&quot;match&quot;</span>: &#123;<br>            <span class="hljs-attr">&quot;displayNameEn&quot;</span>: <span class="hljs-string">&quot;james&quot;</span><br>          &#125;<br>        &#125;<br>      ],<br>      <span class="hljs-attr">&quot;must_not&quot;</span>: [<br>        &#123;<br>          <span class="hljs-attr">&quot;term&quot;</span>: &#123;<br>            <span class="hljs-attr">&quot;teamConferenceEn&quot;</span>: &#123;<br>              <span class="hljs-attr">&quot;value&quot;</span>: <span class="hljs-string">&quot;eastern&quot;</span><br>            &#125;<br>          &#125;<br>        &#125;<br>      ],<br>      <span class="hljs-attr">&quot;should&quot;</span>: [<br>        &#123;<br>          <span class="hljs-attr">&quot;range&quot;</span>: &#123;<br>            <span class="hljs-attr">&quot;playYear&quot;</span>: &#123;<br>              <span class="hljs-attr">&quot;gte&quot;</span>: <span class="hljs-number">11</span>,<br>              <span class="hljs-attr">&quot;lte&quot;</span>: <span class="hljs-number">20</span><br>            &#125;<br>          &#125;<br>        &#125;<br>      ]<br>      , <span class="hljs-attr">&quot;minimum_should_match&quot;</span>: <span class="hljs-number">1</span><br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;from&quot;</span>: <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">3</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;took&quot;</span> : <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;skipped&quot;</span> : <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;hits&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">1</span>,<br>      <span class="hljs-attr">&quot;relation&quot;</span> : <span class="hljs-string">&quot;eq&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;max_score&quot;</span> : <span class="hljs-number">1.0</span>,<br>    <span class="hljs-attr">&quot;hits&quot;</span> : [<br>      &#123;<br>        <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person&quot;</span>,<br>        <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>        <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;267&quot;</span>,<br>        <span class="hljs-attr">&quot;_score&quot;</span> : <span class="hljs-number">1.0</span>,<br>        <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;countryEn&quot;</span> : <span class="hljs-string">&quot;United States&quot;</span>,<br>          <span class="hljs-attr">&quot;teamName&quot;</span> : <span class="hljs-string">&quot;湖人&quot;</span>,<br>          <span class="hljs-attr">&quot;birthDay&quot;</span> : <span class="hljs-number">473230800000</span>,<br>          <span class="hljs-attr">&quot;country&quot;</span> : <span class="hljs-string">&quot;美国&quot;</span>,<br>          <span class="hljs-attr">&quot;teamCityEn&quot;</span> : <span class="hljs-string">&quot;Los Angeles&quot;</span>,<br>          <span class="hljs-attr">&quot;code&quot;</span> : <span class="hljs-string">&quot;lebron_james&quot;</span>,<br>          <span class="hljs-attr">&quot;displayAffiliation&quot;</span> : <span class="hljs-string">&quot;No College/United States&quot;</span>,<br>          <span class="hljs-attr">&quot;displayName&quot;</span> : <span class="hljs-string">&quot;勒布朗 詹姆斯&quot;</span>,<br>          <span class="hljs-attr">&quot;schoolType&quot;</span> : <span class="hljs-string">&quot;High School&quot;</span>,<br>          <span class="hljs-attr">&quot;teamConference&quot;</span> : <span class="hljs-string">&quot;西部&quot;</span>,<br>          <span class="hljs-attr">&quot;teamConferenceEn&quot;</span> : <span class="hljs-string">&quot;Western&quot;</span>,<br>          <span class="hljs-attr">&quot;weight&quot;</span> : <span class="hljs-string">&quot;113.4 公斤&quot;</span>,<br>          <span class="hljs-attr">&quot;teamCity&quot;</span> : <span class="hljs-string">&quot;洛杉矶&quot;</span>,<br>          <span class="hljs-attr">&quot;playYear&quot;</span> : <span class="hljs-number">16</span>,<br>          <span class="hljs-attr">&quot;jerseyNo&quot;</span> : <span class="hljs-string">&quot;23&quot;</span>,<br>          <span class="hljs-attr">&quot;teamNameEn&quot;</span> : <span class="hljs-string">&quot;Lakers&quot;</span>,<br>          <span class="hljs-attr">&quot;draft&quot;</span> : <span class="hljs-number">2003</span>,<br>          <span class="hljs-attr">&quot;displayNameEn&quot;</span> : <span class="hljs-string">&quot;LeBron James&quot;</span>,<br>          <span class="hljs-attr">&quot;heightValue&quot;</span> : <span class="hljs-number">2.03</span>,<br>          <span class="hljs-attr">&quot;birthDayStr&quot;</span> : <span class="hljs-string">&quot;1984-12-30&quot;</span>,<br>          <span class="hljs-attr">&quot;position&quot;</span> : <span class="hljs-string">&quot;前锋&quot;</span>,<br>          <span class="hljs-attr">&quot;age&quot;</span> : <span class="hljs-number">35</span>,<br>          <span class="hljs-attr">&quot;playerId&quot;</span> : <span class="hljs-string">&quot;2544&quot;</span><br>        &#125;<br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="6-5-排序查询"><a href="#6-5-排序查询" class="headerlink" title="6.5 排序查询"></a>6.5 排序查询</h4><h5 id="6-5-1-第一种排序查询-GET-POST请求"><a href="#6-5-1-第一种排序查询-GET-POST请求" class="headerlink" title="6.5.1 第一种排序查询 GET/POST请求"></a>6.5.1 第一种排序查询 GET/POST请求</h5><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person/_search<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-comment">// 语义: ⽕箭队中按打球时间从⼤到⼩排序的球员</span><br>  <span class="hljs-attr">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;match&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;teamName&quot;</span>: <span class="hljs-string">&quot;Rockets&quot;</span><br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;sort&quot;</span>: [<br>    &#123;<br>      <span class="hljs-attr">&quot;playYear&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;order&quot;</span>: <span class="hljs-string">&quot;desc&quot;</span><br>      &#125;<br>    &#125;<br>  ],<br>  <span class="hljs-attr">&quot;from&quot;</span>: <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">3</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="6-5-2-第一种排序查询-GET-POST请求"><a href="#6-5-2-第一种排序查询-GET-POST请求" class="headerlink" title="6.5.2 第一种排序查询 GET/POST请求"></a>6.5.2 第一种排序查询 GET/POST请求</h5><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person/_search<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-comment">// 语义: ⽕箭队中按打球时间从⼤到⼩，如果年龄相同则按照身⾼从⾼到低排序的球员</span><br>  <span class="hljs-attr">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;match&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;teamNameEn&quot;</span>: <span class="hljs-string">&quot;Rockets&quot;</span><br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;sort&quot;</span>: [<br>    &#123;<br>      <span class="hljs-attr">&quot;playYear&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;order&quot;</span>: <span class="hljs-string">&quot;desc&quot;</span><br>      &#125;<br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">&quot;heightValue&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;order&quot;</span>: <span class="hljs-string">&quot;asc&quot;</span><br>      &#125;<br>    &#125;<br>  ],<br>  <span class="hljs-attr">&quot;from&quot;</span>: <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">3</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="6-6-聚合查询指标聚合"><a href="#6-6-聚合查询指标聚合" class="headerlink" title="6.6 聚合查询指标聚合"></a>6.6 聚合查询指标聚合</h4><ul>
<li>ES聚合分析是什么</li>
</ul>
<ol>
<li> 聚合分析是数据库中重要的功能特性，完成对⼀个查询的数据集中数据的聚合计算，如：找出某字段（或计算表达式的结果）的最⼤值、最⼩值，计算和、平均值等。ES作为搜索引擎兼数据库，同样提供了强⼤的聚合分析能力。 </li>
<li> 对⼀个数据集求最大、最小、和、平均值等指标的聚合，在ES中称为<strong>指标聚合</strong> </li>
<li> 而关系型数据库中除了有聚合函数外，还可以对查询出的数据行分组group by，再在组上进行指标聚合。在ES中称为<strong>桶聚合</strong> </li>
</ol>
<h5 id="6-6-1-max-min-sum-avg-指标聚合查询-GET-POST"><a href="#6-6-1-max-min-sum-avg-指标聚合查询-GET-POST" class="headerlink" title="6.6.1 max min sum avg 指标聚合查询 GET/POST"></a>6.6.1 max min sum avg 指标聚合查询 GET/POST</h5><ul>
<li> max min sum avg 指标聚合 </li>
<li> 请求 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person/_search<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-comment">// 语义: 查询火箭队球员平均年龄</span><br>  <span class="hljs-attr">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;term&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;teamNameEn&quot;</span>: <span class="hljs-string">&quot;Rockets&quot;</span><br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;aggs&quot;</span>: &#123; <span class="hljs-comment">// aggs 代表使用聚合函数</span><br>    <span class="hljs-attr">&quot;avgAge&quot;</span>: &#123; <span class="hljs-comment">// avgAge是自定义的，因为是查年年龄平均所以起名avgAge</span><br>      <span class="hljs-attr">&quot;avg&quot;</span>: &#123; <span class="hljs-comment">// avg 平均</span><br>        <span class="hljs-attr">&quot;field&quot;</span>: <span class="hljs-string">&quot;age&quot;</span><br>      &#125;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">0</span> <span class="hljs-comment">// 不看数据只看指标聚合</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;took&quot;</span> : <span class="hljs-number">1</span>,<br>  <span class="hljs-attr">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;skipped&quot;</span> : <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;hits&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">21</span>,<br>      <span class="hljs-attr">&quot;relation&quot;</span> : <span class="hljs-string">&quot;eq&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;max_score&quot;</span> : <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">&quot;hits&quot;</span> : [ ]<br>  &#125;,<br>  <span class="hljs-attr">&quot;aggregations&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;avgAge&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">26.761904761904763</span> <span class="hljs-comment">// 平均年龄</span><br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="6-6-2-value-count-指标聚合查询-GET-POST"><a href="#6-6-2-value-count-指标聚合查询-GET-POST" class="headerlink" title="6.6.2 value_count 指标聚合查询 GET/POST"></a>6.6.2 value_count 指标聚合查询 GET/POST</h5><ul>
<li> 统计非空字段的文档数 </li>
<li> 请求 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person/_search<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-comment">// 语义: 查询火箭队中球员打球时间不为空的数量</span><br>  <span class="hljs-attr">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;term&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;teamNameEn&quot;</span>: <span class="hljs-string">&quot;Rockets&quot;</span><br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;aggs&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;countPlayerYear&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;value_count&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;field&quot;</span>: <span class="hljs-string">&quot;playYear&quot;</span><br>      &#125;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">0</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;took&quot;</span> : <span class="hljs-number">4</span>,<br>  <span class="hljs-attr">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;skipped&quot;</span> : <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;hits&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">21</span>,<br>      <span class="hljs-attr">&quot;relation&quot;</span> : <span class="hljs-string">&quot;eq&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;max_score&quot;</span> : <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">&quot;hits&quot;</span> : [ ]<br>  &#125;,<br>  <span class="hljs-attr">&quot;aggregations&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;countPlayerYear&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">21</span><br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="6-6-3-count-指标聚合查询（严格来说不属于聚合）-GET-POST"><a href="#6-6-3-count-指标聚合查询（严格来说不属于聚合）-GET-POST" class="headerlink" title="6.6.3 _count 指标聚合查询（严格来说不属于聚合） GET/POST"></a>6.6.3 _count 指标聚合查询（严格来说不属于聚合） GET/POST</h5><ul>
<li> 查询火箭队有多少文档，也就是有多少球员 </li>
<li> 请求 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person/_count<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;term&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;teamNameEn&quot;</span>: <span class="hljs-string">&quot;Rockets&quot;</span><br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;count&quot;</span>: <span class="hljs-number">21</span>,<br>    <span class="hljs-attr">&quot;_shards&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;total&quot;</span>: <span class="hljs-number">1</span>,<br>        <span class="hljs-attr">&quot;successful&quot;</span>: <span class="hljs-number">1</span>,<br>        <span class="hljs-attr">&quot;skipped&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-attr">&quot;failed&quot;</span>: <span class="hljs-number">0</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="6-6-4-cardinality-指标聚合查询-GET-POST"><a href="#6-6-4-cardinality-指标聚合查询-GET-POST" class="headerlink" title="6.6.4 cardinality 指标聚合查询 GET/POST"></a>6.6.4 cardinality 指标聚合查询 GET/POST</h5><ul>
<li> Cardinality 值去重计算 </li>
<li> 请求 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person/_search<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-comment">// 语义: 查询火箭队中年龄不同的数量</span><br>  <span class="hljs-attr">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;term&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;teamNameEn&quot;</span>: <span class="hljs-string">&quot;Rockets&quot;</span><br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;aggs&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;countAge&quot;</span>: &#123; <span class="hljs-comment">// 自定义名字</span><br>      <span class="hljs-attr">&quot;cardinality&quot;</span>: &#123; <span class="hljs-comment">// 去掉相同的只保留一个值</span><br>        <span class="hljs-attr">&quot;field&quot;</span>: <span class="hljs-string">&quot;age&quot;</span><br>      &#125;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">0</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;took&quot;</span> : <span class="hljs-number">1</span>,<br>  <span class="hljs-attr">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;skipped&quot;</span> : <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;hits&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">21</span>,<br>      <span class="hljs-attr">&quot;relation&quot;</span> : <span class="hljs-string">&quot;eq&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;max_score&quot;</span> : <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">&quot;hits&quot;</span> : [ ]<br>  &#125;,<br>  <span class="hljs-attr">&quot;aggregations&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;countAge&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">13</span><br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="6-6-5-status-种指标聚合查询-GET-POST"><a href="#6-6-5-status-种指标聚合查询-GET-POST" class="headerlink" title="6.6.5 status 种指标聚合查询 GET/POST"></a>6.6.5 status 种指标聚合查询 GET/POST</h5><ul>
<li> stats 统计count max min avg sum 5个值 </li>
<li> 请求 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person/_search<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-comment">// 语义:　查询火箭球员的年龄status</span><br>  <span class="hljs-attr">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;term&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;teamNameEn&quot;</span>: <span class="hljs-string">&quot;Rockets&quot;</span><br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;aggs&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;status&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;stats&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;field&quot;</span>: <span class="hljs-string">&quot;age&quot;</span><br>      &#125;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">0</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;took&quot;</span> : <span class="hljs-number">1</span>,<br>  <span class="hljs-attr">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;skipped&quot;</span> : <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;hits&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">21</span>,<br>      <span class="hljs-attr">&quot;relation&quot;</span> : <span class="hljs-string">&quot;eq&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;max_score&quot;</span> : <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">&quot;hits&quot;</span> : [ ]<br>  &#125;,<br>  <span class="hljs-attr">&quot;aggregations&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;status&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;count&quot;</span> : <span class="hljs-number">21</span>,<br>      <span class="hljs-attr">&quot;min&quot;</span> : <span class="hljs-number">21.0</span>,<br>      <span class="hljs-attr">&quot;max&quot;</span> : <span class="hljs-number">37.0</span>,<br>      <span class="hljs-attr">&quot;avg&quot;</span> : <span class="hljs-number">26.761904761904763</span>,<br>      <span class="hljs-attr">&quot;sum&quot;</span> : <span class="hljs-number">562.0</span><br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="6-6-6-extended-status-种指标聚合查询-GET-POST"><a href="#6-6-6-extended-status-种指标聚合查询-GET-POST" class="headerlink" title="6.6.6 extended status 种指标聚合查询 GET/POST"></a>6.6.6 extended status 种指标聚合查询 GET/POST</h5><ul>
<li> Extended stats ⽐比stats多4个统计结果： 平⽅方和、⽅方差、标准差、平均值加减两个标准差的区间 </li>
<li> 请求 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person/_search<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-comment">// 查出火箭队球员的年龄Extend stats</span><br>  <span class="hljs-attr">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;term&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;teamNameEn&quot;</span>: <span class="hljs-string">&quot;Rockets&quot;</span><br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;aggs&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;extendedStatsAge&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;extended_stats&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;field&quot;</span>: <span class="hljs-string">&quot;age&quot;</span><br>      &#125;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">0</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;took&quot;</span> : <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;skipped&quot;</span> : <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;hits&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">21</span>,<br>      <span class="hljs-attr">&quot;relation&quot;</span> : <span class="hljs-string">&quot;eq&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;max_score&quot;</span> : <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">&quot;hits&quot;</span> : [ ]<br>  &#125;,<br>  <span class="hljs-attr">&quot;aggregations&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;extendedStatsAge&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;count&quot;</span> : <span class="hljs-number">21</span>,<br>      <span class="hljs-attr">&quot;min&quot;</span> : <span class="hljs-number">21.0</span>,<br>      <span class="hljs-attr">&quot;max&quot;</span> : <span class="hljs-number">37.0</span>,<br>      <span class="hljs-attr">&quot;avg&quot;</span> : <span class="hljs-number">26.761904761904763</span>,<br>      <span class="hljs-attr">&quot;sum&quot;</span> : <span class="hljs-number">562.0</span>,<br>      <span class="hljs-attr">&quot;sum_of_squares&quot;</span> : <span class="hljs-number">15534.0</span>,<br>      <span class="hljs-attr">&quot;variance&quot;</span> : <span class="hljs-number">23.5147392290249</span>,<br>      <span class="hljs-attr">&quot;std_deviation&quot;</span> : <span class="hljs-number">4.84919985451465</span>,<br>      <span class="hljs-attr">&quot;std_deviation_bounds&quot;</span> : &#123;<br>        <span class="hljs-attr">&quot;upper&quot;</span> : <span class="hljs-number">36.46030447093406</span>,<br>        <span class="hljs-attr">&quot;lower&quot;</span> : <span class="hljs-number">17.063505052875463</span><br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="6-6-7-percentiles-种指标聚合查询-GET-POST"><a href="#6-6-7-percentiles-种指标聚合查询-GET-POST" class="headerlink" title="6.6.7 percentiles 种指标聚合查询 GET/POST"></a>6.6.7 percentiles 种指标聚合查询 GET/POST</h5><ul>
<li> Percentiles 占比百分位对应的值统计，默认返回[ 1, 5, 25, 50, 75, 95, 99 ]分位上的值 </li>
<li> 请求 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person/_search<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-comment">// 语义: 查出火箭的球员的年龄占比</span><br>  <span class="hljs-attr">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;term&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;teamNameEn&quot;</span>: <span class="hljs-string">&quot;Rockets&quot;</span><br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;aggs&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;percentilesAge&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;percentiles&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;field&quot;</span>: <span class="hljs-string">&quot;age&quot;</span>,<br>        <span class="hljs-comment">// 这里可以指定，不使用默认</span><br>        <span class="hljs-comment">// &quot;percents&quot;: [</span><br>        <span class="hljs-comment">//   25,</span><br>        <span class="hljs-comment">//   50,</span><br>        <span class="hljs-comment">//   75</span><br>        <span class="hljs-comment">// ]</span><br>      &#125;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">0</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;took&quot;</span> : <span class="hljs-number">1</span>,<br>  <span class="hljs-attr">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;skipped&quot;</span> : <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;hits&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">21</span>,<br>      <span class="hljs-attr">&quot;relation&quot;</span> : <span class="hljs-string">&quot;eq&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;max_score&quot;</span> : <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">&quot;hits&quot;</span> : [ ]<br>  &#125;,<br>  <span class="hljs-attr">&quot;aggregations&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;percentilesAge&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;values&quot;</span> : &#123;<br>        <span class="hljs-attr">&quot;1.0&quot;</span> : <span class="hljs-number">21.0</span>,<br>        <span class="hljs-attr">&quot;5.0&quot;</span> : <span class="hljs-number">21.0</span>,<br>        <span class="hljs-attr">&quot;25.0&quot;</span> : <span class="hljs-number">22.75</span>, <span class="hljs-comment">// 小于22.75岁的 占25%</span><br>        <span class="hljs-attr">&quot;50.0&quot;</span> : <span class="hljs-number">25.0</span>,<br>        <span class="hljs-attr">&quot;75.0&quot;</span> : <span class="hljs-number">30.25</span>,<span class="hljs-comment">// 小于30.25岁的 占75%</span><br>        <span class="hljs-attr">&quot;95.0&quot;</span> : <span class="hljs-number">35.349999999999994</span>,<br>        <span class="hljs-attr">&quot;99.0&quot;</span> : <span class="hljs-number">37.0</span><br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="6-7-聚合查询桶聚合"><a href="#6-7-聚合查询桶聚合" class="headerlink" title="6.7 聚合查询桶聚合"></a>6.7 聚合查询桶聚合</h4><h5 id="6-7-1-terms-aggregation-桶聚合查询-GET-POST"><a href="#6-7-1-terms-aggregation-桶聚合查询-GET-POST" class="headerlink" title="6.7.1 terms aggregation 桶聚合查询 GET/POST"></a>6.7.1 terms aggregation 桶聚合查询 GET/POST</h5><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person/_search<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-comment">// 语义: 火箭队根据年龄进行分组</span><br>  <span class="hljs-attr">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;term&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;teamNameEn&quot;</span>: <span class="hljs-string">&quot;Rockets&quot;</span><br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;aggs&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;aggrAge&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;terms&quot;</span>: &#123; <span class="hljs-comment">// 因为根据年龄做桶聚合所以使用terms</span><br>        <span class="hljs-attr">&quot;field&quot;</span>: <span class="hljs-string">&quot;age&quot;</span>,<br>        <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">3</span> <span class="hljs-comment">// 指定显示桶数</span><br>      &#125;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">0</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;took&quot;</span> : <span class="hljs-number">1</span>,<br>  <span class="hljs-attr">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;skipped&quot;</span> : <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;hits&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">21</span>,<br>      <span class="hljs-attr">&quot;relation&quot;</span> : <span class="hljs-string">&quot;eq&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;max_score&quot;</span> : <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">&quot;hits&quot;</span> : [ ]<br>  &#125;,<br>  <span class="hljs-attr">&quot;aggregations&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;aggrAge&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;doc_count_error_upper_bound&quot;</span> : <span class="hljs-number">0</span>,<br>      <span class="hljs-attr">&quot;sum_other_doc_count&quot;</span> : <span class="hljs-number">3</span>,<br>      <span class="hljs-attr">&quot;buckets&quot;</span> : [<br>        &#123;<br>          <span class="hljs-attr">&quot;key&quot;</span> : <span class="hljs-number">21</span>, <span class="hljs-comment">// 指定的字段 age</span><br>          <span class="hljs-attr">&quot;doc_count&quot;</span> : <span class="hljs-number">4</span> <span class="hljs-comment">// 21岁的文档数有4个</span><br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">&quot;key&quot;</span> : <span class="hljs-number">25</span>,<br>          <span class="hljs-attr">&quot;doc_count&quot;</span> : <span class="hljs-number">3</span><br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">&quot;key&quot;</span> : <span class="hljs-number">23</span>,<br>          <span class="hljs-attr">&quot;doc_count&quot;</span> : <span class="hljs-number">2</span><br>        &#125;<br>      ]<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="6-7-2-order-第一种分组聚合查询-GET-POST"><a href="#6-7-2-order-第一种分组聚合查询-GET-POST" class="headerlink" title="6.7.2 order 第一种分组聚合查询 GET/POST"></a>6.7.2 order 第一种分组聚合查询 GET/POST</h5><ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-comment">// 语义: 根据火箭队年龄进行分组，分组信息通过年龄从大到小排序（通过指定字段）</span><br>  <span class="hljs-attr">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;term&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;teamNameEn&quot;</span>: <span class="hljs-string">&quot;Rockets&quot;</span><br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;aggs&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;aggrAge&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;terms&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;field&quot;</span>: <span class="hljs-string">&quot;age&quot;</span>,<br>        <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">3</span>,<br>        <span class="hljs-attr">&quot;order&quot;</span>: &#123;<br>          <span class="hljs-attr">&quot;_key&quot;</span>: <span class="hljs-string">&quot;desc&quot;</span> <span class="hljs-comment">//&quot;_key关键字 倒序排序</span><br>        <span class="hljs-comment">//   &quot;_count&quot;: &quot;desc&quot;  通过文档排序</span><br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">0</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;took&quot;</span> : <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;skipped&quot;</span> : <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;hits&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">21</span>,<br>      <span class="hljs-attr">&quot;relation&quot;</span> : <span class="hljs-string">&quot;eq&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;max_score&quot;</span> : <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">&quot;hits&quot;</span> : [ ]<br>  &#125;,<br>  <span class="hljs-attr">&quot;aggregations&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;aggrAge&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;doc_count_error_upper_bound&quot;</span> : <span class="hljs-number">0</span>,<br>      <span class="hljs-attr">&quot;sum_other_doc_count&quot;</span> : <span class="hljs-number">17</span>,<br>      <span class="hljs-attr">&quot;buckets&quot;</span> : [<br>        &#123;<br>          <span class="hljs-attr">&quot;key&quot;</span> : <span class="hljs-number">37</span>,<br>          <span class="hljs-attr">&quot;doc_count&quot;</span> : <span class="hljs-number">1</span><br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">&quot;key&quot;</span> : <span class="hljs-number">34</span>,<br>          <span class="hljs-attr">&quot;doc_count&quot;</span> : <span class="hljs-number">2</span><br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">&quot;key&quot;</span> : <span class="hljs-number">33</span>,<br>          <span class="hljs-attr">&quot;doc_count&quot;</span> : <span class="hljs-number">1</span><br>        &#125;<br>      ]<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="6-7-3-order-第二种分组聚合查询-GET-POST"><a href="#6-7-3-order-第二种分组聚合查询-GET-POST" class="headerlink" title="6.7.3 order 第二种分组聚合查询 GET/POST"></a>6.7.3 order 第二种分组聚合查询 GET/POST</h5><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person/_search<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-comment">// 语义: 每支球队按该队所有球员的平均年龄进行分组排序（通过分组指标值）</span><br>  <span class="hljs-attr">&quot;aggs&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;aggsTeamName&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;terms&quot;</span>: &#123; <span class="hljs-comment">// 因为使用分组所以用terms</span><br>        <span class="hljs-attr">&quot;field&quot;</span>: <span class="hljs-string">&quot;teamNameEn&quot;</span>,<br>        <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">3</span>, <span class="hljs-comment">// 显示3条</span><br>        <span class="hljs-attr">&quot;order&quot;</span>: &#123;<br>          <span class="hljs-attr">&quot;avgAge&quot;</span>: <span class="hljs-string">&quot;desc&quot;</span><br>        &#125;<br>      &#125;, <span class="hljs-comment">// 因为需要通过对球队的平均年龄进行分组排序，所以再写aggs</span><br>      <span class="hljs-attr">&quot;aggs&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;avgAge&quot;</span>: &#123;<br>          <span class="hljs-attr">&quot;avg&quot;</span>: &#123;<br>            <span class="hljs-attr">&quot;field&quot;</span>: <span class="hljs-string">&quot;age&quot;</span><br>          &#125;<br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">0</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;took&quot;</span> : <span class="hljs-number">3</span>,<br>  <span class="hljs-attr">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;skipped&quot;</span> : <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;hits&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">566</span>,<br>      <span class="hljs-attr">&quot;relation&quot;</span> : <span class="hljs-string">&quot;eq&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;max_score&quot;</span> : <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">&quot;hits&quot;</span> : [ ]<br>  &#125;,<br>  <span class="hljs-attr">&quot;aggregations&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;aggsTeamName&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;doc_count_error_upper_bound&quot;</span> : <span class="hljs-number">-1</span>,<br>      <span class="hljs-attr">&quot;sum_other_doc_count&quot;</span> : <span class="hljs-number">511</span>,<br>      <span class="hljs-attr">&quot;buckets&quot;</span> : [<br>        &#123;<br>          <span class="hljs-attr">&quot;key&quot;</span> : <span class="hljs-string">&quot;Bucks&quot;</span>,<br>          <span class="hljs-attr">&quot;doc_count&quot;</span> : <span class="hljs-number">14</span>,<br>          <span class="hljs-attr">&quot;avgAge&quot;</span> : &#123;<br>            <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">28.142857142857142</span><br>          &#125;<br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">&quot;key&quot;</span> : <span class="hljs-string">&quot;Mavericks&quot;</span>,<br>          <span class="hljs-attr">&quot;doc_count&quot;</span> : <span class="hljs-number">20</span>,<br>          <span class="hljs-attr">&quot;avgAge&quot;</span> : &#123;<br>            <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">27.85</span><br>          &#125;<br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">&quot;key&quot;</span> : <span class="hljs-string">&quot;Lakers&quot;</span>,<br>          <span class="hljs-attr">&quot;doc_count&quot;</span> : <span class="hljs-number">21</span>,<br>          <span class="hljs-attr">&quot;avgAge&quot;</span> : &#123;<br>            <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">27.714285714285715</span><br>          &#125;<br>        &#125;<br>      ]<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="6-7-3-include-筛选分组聚合查询-GET-POST"><a href="#6-7-3-include-筛选分组聚合查询-GET-POST" class="headerlink" title="6.7.3 include 筛选分组聚合查询 GET/POST"></a>6.7.3 include 筛选分组聚合查询 GET/POST</h5><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person/_search<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-comment">// 语义: 湖人和火箭队按球队平均年龄进行分组排序（指定值列表 ）</span><br>  <span class="hljs-attr">&quot;aggs&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;aggsTeamName&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;terms&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;field&quot;</span>: <span class="hljs-string">&quot;teamNameEn&quot;</span>,<br>        <span class="hljs-comment">// include指定队伍  [&quot;Lakes&quot;,&quot;Rockets&quot;,&quot;warriors&quot;]</span><br>        <span class="hljs-attr">&quot;include&quot;</span>: [<span class="hljs-string">&quot;Lakes&quot;</span>,<span class="hljs-string">&quot;Rockets&quot;</span>,<span class="hljs-string">&quot;warriors&quot;</span>],<br>        <span class="hljs-comment">// exclude去除[&quot;warriors&quot;]</span><br>        <span class="hljs-attr">&quot;exclude&quot;</span>: [<span class="hljs-string">&quot;warriors&quot;</span>],<br>        <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">3</span>,<br>        <span class="hljs-attr">&quot;order&quot;</span>: &#123;<br>          <span class="hljs-attr">&quot;avgAge&quot;</span>: <span class="hljs-string">&quot;desc&quot;</span><br>        &#125;<br>      &#125;,<br>      <span class="hljs-attr">&quot;aggs&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;avgAge&quot;</span>: &#123;<br>          <span class="hljs-attr">&quot;avg&quot;</span>: &#123;<br>            <span class="hljs-attr">&quot;field&quot;</span>: <span class="hljs-string">&quot;age&quot;</span><br>          &#125;<br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">0</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;took&quot;</span> : <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;skipped&quot;</span> : <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;hits&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">566</span>,<br>      <span class="hljs-attr">&quot;relation&quot;</span> : <span class="hljs-string">&quot;eq&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;max_score&quot;</span> : <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">&quot;hits&quot;</span> : [ ]<br>  &#125;,<br>  <span class="hljs-attr">&quot;aggregations&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;aggsTeamName&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;doc_count_error_upper_bound&quot;</span> : <span class="hljs-number">0</span>,<br>      <span class="hljs-attr">&quot;sum_other_doc_count&quot;</span> : <span class="hljs-number">0</span>,<br>      <span class="hljs-attr">&quot;buckets&quot;</span> : [<br>        &#123;<br>          <span class="hljs-attr">&quot;key&quot;</span> : <span class="hljs-string">&quot;Rockets&quot;</span>,<br>          <span class="hljs-attr">&quot;doc_count&quot;</span> : <span class="hljs-number">21</span>,<br>          <span class="hljs-attr">&quot;avgAge&quot;</span> : &#123;<br>            <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">26.761904761904763</span><br>          &#125;<br>        &#125;<br>      ]<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="6-7-4-include-正则筛选分组聚合查询-GET-POST"><a href="#6-7-4-include-正则筛选分组聚合查询-GET-POST" class="headerlink" title="6.7.4 include 正则筛选分组聚合查询 GET/POST"></a>6.7.4 include 正则筛选分组聚合查询 GET/POST</h5><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person/_search<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-comment">// 语义: 湖人和火箭队按球队平均年龄进行分组排序（指定值列表 ）</span><br>  <span class="hljs-attr">&quot;aggs&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;aggsTeamName&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;terms&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;field&quot;</span>: <span class="hljs-string">&quot;teamNameEn&quot;</span>,<br>        <span class="hljs-comment">// 使用正则表达式</span><br>        <span class="hljs-attr">&quot;include&quot;</span>: <span class="hljs-string">&quot;Lakers|Ro.*|Warriors.*&quot;</span>,<br>        <span class="hljs-attr">&quot;exclude&quot;</span>: <span class="hljs-string">&quot;warriors&quot;</span>,<br>        <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">3</span>,<br>        <span class="hljs-attr">&quot;order&quot;</span>: &#123;<br>          <span class="hljs-attr">&quot;avgAge&quot;</span>: <span class="hljs-string">&quot;desc&quot;</span><br>        &#125;<br>      &#125;,<br>      <span class="hljs-attr">&quot;aggs&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;avgAge&quot;</span>: &#123;<br>          <span class="hljs-attr">&quot;avg&quot;</span>: &#123;<br>            <span class="hljs-attr">&quot;field&quot;</span>: <span class="hljs-string">&quot;age&quot;</span><br>          &#125;<br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">0</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;took&quot;</span> : <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;skipped&quot;</span> : <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;hits&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">566</span>,<br>      <span class="hljs-attr">&quot;relation&quot;</span> : <span class="hljs-string">&quot;eq&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;max_score&quot;</span> : <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">&quot;hits&quot;</span> : [ ]<br>  &#125;,<br>  <span class="hljs-attr">&quot;aggregations&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;aggsTeamName&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;doc_count_error_upper_bound&quot;</span> : <span class="hljs-number">0</span>,<br>      <span class="hljs-attr">&quot;sum_other_doc_count&quot;</span> : <span class="hljs-number">0</span>,<br>      <span class="hljs-attr">&quot;buckets&quot;</span> : [<br>        &#123;<br>          <span class="hljs-attr">&quot;key&quot;</span> : <span class="hljs-string">&quot;Lakers&quot;</span>,<br>          <span class="hljs-attr">&quot;doc_count&quot;</span> : <span class="hljs-number">21</span>,<br>          <span class="hljs-attr">&quot;avgAge&quot;</span> : &#123;<br>            <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">27.714285714285715</span><br>          &#125;<br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">&quot;key&quot;</span> : <span class="hljs-string">&quot;Rockets&quot;</span>,<br>          <span class="hljs-attr">&quot;doc_count&quot;</span> : <span class="hljs-number">21</span>,<br>          <span class="hljs-attr">&quot;avgAge&quot;</span> : &#123;<br>            <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">26.761904761904763</span><br>          &#125;<br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">&quot;key&quot;</span> : <span class="hljs-string">&quot;Warriors&quot;</span>,<br>          <span class="hljs-attr">&quot;doc_count&quot;</span> : <span class="hljs-number">20</span>,<br>          <span class="hljs-attr">&quot;avgAge&quot;</span> : &#123;<br>            <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">26.25</span><br>          &#125;<br>        &#125;<br>      ]<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="6-7-4-range-aggregation-范围分组聚合查询-GET-POST"><a href="#6-7-4-range-aggregation-范围分组聚合查询-GET-POST" class="headerlink" title="6.7.4 range aggregation 范围分组聚合查询 GET/POST"></a>6.7.4 range aggregation 范围分组聚合查询 GET/POST</h5><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person/_search<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-comment">// 语义: 球员年龄按20、20-35、35 这样分组</span><br>  <span class="hljs-attr">&quot;aggs&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;ageRange&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;range&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;field&quot;</span>: <span class="hljs-string">&quot;age&quot;</span>,<br>        <span class="hljs-attr">&quot;ranges&quot;</span>: [<br>          &#123;<br>            <span class="hljs-attr">&quot;to&quot;</span>: <span class="hljs-number">20</span>,  <span class="hljs-comment">// 小于等于 20</span><br>            <span class="hljs-attr">&quot;key&quot;</span>: <span class="hljs-string">&quot;A&quot;</span> <span class="hljs-comment">//别名 A</span><br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">&quot;from&quot;</span>: <span class="hljs-number">20</span>, <span class="hljs-comment">// 大于等于20</span><br>            <span class="hljs-attr">&quot;to&quot;</span>: <span class="hljs-number">35</span>, <span class="hljs-comment">//  小于等于 35</span><br>            <span class="hljs-attr">&quot;key&quot;</span>: <span class="hljs-string">&quot;B&quot;</span>  <span class="hljs-comment">//别名 B</span><br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">&quot;from&quot;</span>: <span class="hljs-number">35</span>, <span class="hljs-comment">// 大于等于35</span><br>            <span class="hljs-attr">&quot;key&quot;</span>: <span class="hljs-string">&quot;C&quot;</span> <span class="hljs-comment">//别名 C</span><br>          &#125;<br>        ]<br>      &#125;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">0</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;took&quot;</span> : <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;skipped&quot;</span> : <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;hits&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">566</span>,<br>      <span class="hljs-attr">&quot;relation&quot;</span> : <span class="hljs-string">&quot;eq&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;max_score&quot;</span> : <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">&quot;hits&quot;</span> : [ ]<br>  &#125;,<br>  <span class="hljs-attr">&quot;aggregations&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;ageRange&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;buckets&quot;</span> : [<br>        &#123;<br>          <span class="hljs-attr">&quot;key&quot;</span> : <span class="hljs-string">&quot;A&quot;</span>,<br>          <span class="hljs-attr">&quot;to&quot;</span> : <span class="hljs-number">20.0</span>,<br>          <span class="hljs-attr">&quot;doc_count&quot;</span> : <span class="hljs-number">15</span><br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">&quot;key&quot;</span> : <span class="hljs-string">&quot;B&quot;</span>,<br>          <span class="hljs-attr">&quot;from&quot;</span> : <span class="hljs-number">20.0</span>,<br>          <span class="hljs-attr">&quot;to&quot;</span> : <span class="hljs-number">35.0</span>,<br>          <span class="hljs-attr">&quot;doc_count&quot;</span> : <span class="hljs-number">531</span><br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">&quot;key&quot;</span> : <span class="hljs-string">&quot;C&quot;</span>,<br>          <span class="hljs-attr">&quot;from&quot;</span> : <span class="hljs-number">35.0</span>,<br>          <span class="hljs-attr">&quot;doc_count&quot;</span> : <span class="hljs-number">20</span><br>        &#125;<br>      ]<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="6-7-5-date-rabge-aggregation-时间范围分组聚合查询-GET-POST"><a href="#6-7-5-date-rabge-aggregation-时间范围分组聚合查询-GET-POST" class="headerlink" title="6.7.5 date rabge aggregation 时间范围分组聚合查询 GET/POST"></a>6.7.5 date rabge aggregation 时间范围分组聚合查询 GET/POST</h5><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person/_search<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-comment">// 语义: 球员按出生年月分组</span><br>  <span class="hljs-attr">&quot;aggs&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;birthDayRange&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;date_range&quot;</span>: &#123;   <span class="hljs-comment">// 时间类型</span><br>        <span class="hljs-attr">&quot;field&quot;</span>: <span class="hljs-string">&quot;birthDay&quot;</span>, <span class="hljs-comment">// 生日 生日是时间类型</span><br>        <span class="hljs-attr">&quot;format&quot;</span>: <span class="hljs-string">&quot;MM-yyy&quot;</span>,  <span class="hljs-comment">//时间格式 月份年份</span><br>        <span class="hljs-attr">&quot;ranges&quot;</span>: [<br>          &#123;<br>            <span class="hljs-attr">&quot;from&quot;</span>: <span class="hljs-string">&quot;01-1989&quot;</span> <span class="hljs-comment">// 小于1989年1月出生</span><br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">&quot;from&quot;</span>: <span class="hljs-string">&quot;01-1989&quot;</span>, <span class="hljs-comment">// 1989年1月到1999年1月</span><br>            <span class="hljs-attr">&quot;to&quot;</span>: <span class="hljs-string">&quot;01-1999&quot;</span><br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">&quot;from&quot;</span>: <span class="hljs-string">&quot;01-1999&quot;</span>, <span class="hljs-comment">// 1999年1月到2009年1月</span><br>            <span class="hljs-attr">&quot;to&quot;</span>: <span class="hljs-string">&quot;01-2009&quot;</span><br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">&quot;from&quot;</span>: <span class="hljs-string">&quot;01-2009&quot;</span><br>          &#125;<br>        ]<br>      &#125;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">0</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;took&quot;</span> : <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;skipped&quot;</span> : <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;hits&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">566</span>,<br>      <span class="hljs-attr">&quot;relation&quot;</span> : <span class="hljs-string">&quot;eq&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;max_score&quot;</span> : <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">&quot;hits&quot;</span> : [ ]<br>  &#125;,<br>  <span class="hljs-attr">&quot;aggregations&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;birthDayRange&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;buckets&quot;</span> : [<br>        &#123;<br>          <span class="hljs-attr">&quot;key&quot;</span> : <span class="hljs-string">&quot;01-1989-01-1999&quot;</span>,<br>          <span class="hljs-attr">&quot;from&quot;</span> : <span class="hljs-number">5.99616E11</span>,<br>          <span class="hljs-attr">&quot;from_as_string&quot;</span> : <span class="hljs-string">&quot;01-1989&quot;</span>,<br>          <span class="hljs-attr">&quot;to&quot;</span> : <span class="hljs-number">9.151488E11</span>,<br>          <span class="hljs-attr">&quot;to_as_string&quot;</span> : <span class="hljs-string">&quot;01-1999&quot;</span>,<br>          <span class="hljs-attr">&quot;doc_count&quot;</span> : <span class="hljs-number">426</span><br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">&quot;key&quot;</span> : <span class="hljs-string">&quot;01-1989-*&quot;</span>,<br>          <span class="hljs-attr">&quot;from&quot;</span> : <span class="hljs-number">5.99616E11</span>,<br>          <span class="hljs-attr">&quot;from_as_string&quot;</span> : <span class="hljs-string">&quot;01-1989&quot;</span>,<br>          <span class="hljs-attr">&quot;doc_count&quot;</span> : <span class="hljs-number">469</span><br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">&quot;key&quot;</span> : <span class="hljs-string">&quot;01-1999-01-2009&quot;</span>,<br>          <span class="hljs-attr">&quot;from&quot;</span> : <span class="hljs-number">9.151488E11</span>,<br>          <span class="hljs-attr">&quot;from_as_string&quot;</span> : <span class="hljs-string">&quot;01-1999&quot;</span>,<br>          <span class="hljs-attr">&quot;to&quot;</span> : <span class="hljs-number">1.230768E12</span>,<br>          <span class="hljs-attr">&quot;to_as_string&quot;</span> : <span class="hljs-string">&quot;01-2009&quot;</span>,<br>          <span class="hljs-attr">&quot;doc_count&quot;</span> : <span class="hljs-number">43</span><br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">&quot;key&quot;</span> : <span class="hljs-string">&quot;01-2009-*&quot;</span>,<br>          <span class="hljs-attr">&quot;from&quot;</span> : <span class="hljs-number">1.230768E12</span>,<br>          <span class="hljs-attr">&quot;from_as_string&quot;</span> : <span class="hljs-string">&quot;01-2009&quot;</span>,<br>          <span class="hljs-attr">&quot;doc_count&quot;</span> : <span class="hljs-number">0</span><br>        &#125;<br>      ]<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="6-7-6-date-histogram-aggregation-时间范围分组聚合查询-GET-POST"><a href="#6-7-6-date-histogram-aggregation-时间范围分组聚合查询-GET-POST" class="headerlink" title="6.7.6 date histogram aggregation 时间范围分组聚合查询 GET/POST"></a>6.7.6 date histogram aggregation 时间范围分组聚合查询 GET/POST</h5><ul>
<li> 按天、月、年等进行聚合统计。可按 year (1y), quarter (1q), month (1M), week (1w), day (1d), hour (1h), minute (1m), second (1s) 间隔聚合 </li>
<li> 请求 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person/_search<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-comment">// 语义: 球员按出⽣生年年分组</span><br>  <span class="hljs-attr">&quot;aggs&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;birthday_aggs&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;date_histogram&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;field&quot;</span>: <span class="hljs-string">&quot;birthDay&quot;</span>, <span class="hljs-comment">//生日字段</span><br>        <span class="hljs-attr">&quot;format&quot;</span>: <span class="hljs-string">&quot;yyyy&quot;</span>,  <span class="hljs-comment">// 时间格式</span><br>        <span class="hljs-attr">&quot;calendar_interval&quot;</span>: <span class="hljs-string">&quot;year&quot;</span> <span class="hljs-comment">// 根据年</span><br>      &#125;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">0</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="6-8-query-string-查询"><a href="#6-8-query-string-查询" class="headerlink" title="6.8 query_string 查询"></a>6.8 query_string 查询</h4><ul>
<li>query_string 查询，如果熟悉lucene的查询语法，我们可以直接⽤用lucene查询语法写⼀一个查询串进行查询，ES中接到请求后，通过查询解析器 ,解析查询串生成对应的查询。</li>
</ul>
<h5 id="6-8-1-query-string-AND-OR-单字段查询-GET-POST请求"><a href="#6-8-1-query-string-AND-OR-单字段查询-GET-POST请求" class="headerlink" title="6.8.1 query_string AND OR 单字段查询 GET/POST请求"></a>6.8.1 query_string AND OR 单字段查询 GET/POST请求</h5><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person/_search<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-comment">// 语义: 指定单个字段查询（查询詹姆斯或者库里的球员）</span><br>  <span class="hljs-attr">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;query_string&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;default_field&quot;</span>: <span class="hljs-string">&quot;displayNameEn&quot;</span>,<br>      <span class="hljs-attr">&quot;query&quot;</span>: <span class="hljs-string">&quot;james OR curry&quot;</span> <span class="hljs-comment">// 这里可以使用or或and也就是sql里的or和and</span><br>    <span class="hljs-comment">//  &quot;query&quot;: &quot;james AND curry&quot;</span><br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">3</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="6-8-2-query-string-AND-OR-多字段查询-GET-POST请求"><a href="#6-8-2-query-string-AND-OR-多字段查询-GET-POST请求" class="headerlink" title="6.8.2 query_string AND OR 多字段查询 GET/POST请求"></a>6.8.2 query_string AND OR 多字段查询 GET/POST请求</h5><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person/_search<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-comment">// 语义: 指定多个字段查询（查询詹姆斯或者库里的球员）</span><br>  <span class="hljs-attr">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;query_string&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;fields&quot;</span>: [ <span class="hljs-comment">// 指定多个字段</span><br>        <span class="hljs-string">&quot;displayNameEn&quot;</span>,<br>        <span class="hljs-string">&quot;teamNameEn&quot;</span><br>        ],<br>        <span class="hljs-attr">&quot;query&quot;</span>: <span class="hljs-string">&quot;james AND Rockets&quot;</span> <span class="hljs-comment">// 查询条件</span><br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">3</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h3 id="七、ElasticSerach-高级搜索"><a href="#七、ElasticSerach-高级搜索" class="headerlink" title="七、ElasticSerach 高级搜索"></a>七、ElasticSerach 高级搜索</h3><h4 id="7-1-索引别名的使用"><a href="#7-1-索引别名的使用" class="headerlink" title="7.1 索引别名的使用"></a>7.1 索引别名的使用</h4><ul>
<li>在开发中，随着业务需求的迭代，较老的业务逻辑就要面临更新甚至是重构，而对于es来说，为了了适应新的业务逻辑，可能就要对原有的索引做一些修改，比如对某些字段做调整，甚至是重建索引。而做这些操作的时候，可能会对业务造成影响，甚至是停机调整等问题。由此，es提供了索引别名来解决这些问题。 索引别名就像一个快捷方式或是软连接，可以指向一个或多个索引，也可以给任意一个需要索引名的API来使⽤用。别名的应用为程序提供了极大地灵活性</li>
</ul>
<h5 id="7-1-1-查询别名-GET请求"><a href="#7-1-1-查询别名-GET请求" class="headerlink" title="7.1.1 查询别名 GET请求"></a>7.1.1 查询别名 GET请求</h5><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person/_alias <span class="hljs-comment">// 查询person别名</span><br>localhost:<span class="hljs-number">9200</span>/_aliases  <span class="hljs-comment">// 查询所有别名</span><br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-comment">// 语义: 查看所有别名</span><br>    <span class="hljs-attr">&quot;person&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;aliases&quot;</span>: &#123;&#125;<br>    &#125;,<br>    <span class="hljs-attr">&quot;.kibana_task_manager&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;aliases&quot;</span>: &#123;&#125;<br>    &#125;,<br>    <span class="hljs-attr">&quot;.kibana_1&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;aliases&quot;</span>: &#123;<br>            <span class="hljs-attr">&quot;.kibana&quot;</span>: &#123;&#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="7-1-2-新增别名-POST请求"><a href="#7-1-2-新增别名-POST请求" class="headerlink" title="7.1.2 新增别名 POST请求"></a>7.1.2 新增别名 POST请求</h5><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/_aliases<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-comment">// 语义: person 新建别名person_v1.0</span><br>  <span class="hljs-attr">&quot;actions&quot;</span>: [<br>    &#123;<br>      <span class="hljs-attr">&quot;add&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;index&quot;</span>: <span class="hljs-string">&quot;person&quot;</span>,<br>        <span class="hljs-attr">&quot;alias&quot;</span>: <span class="hljs-string">&quot;person_v1.0&quot;</span><br>      &#125;<br>    &#125;<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;acknowledged&quot;</span>: <span class="hljs-literal">true</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="7-1-3-删除别名-POST请求"><a href="#7-1-3-删除别名-POST请求" class="headerlink" title="7.1.3 删除别名 POST请求"></a>7.1.3 删除别名 POST请求</h5><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/_aliases<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-comment">// 语义: 删除person的person_v1.0别名</span><br>  <span class="hljs-attr">&quot;actions&quot;</span>: [<br>    &#123;<br>      <span class="hljs-attr">&quot;remove&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;index&quot;</span>: <span class="hljs-string">&quot;person&quot;</span>,<br>        <span class="hljs-attr">&quot;alias&quot;</span>: <span class="hljs-string">&quot;person_v1.0&quot;</span><br>      &#125;<br>    &#125;<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;acknowledged&quot;</span>: <span class="hljs-literal">true</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="7-1-4-重命名别名-POST请求"><a href="#7-1-4-重命名别名-POST请求" class="headerlink" title="7.1.4 重命名别名 POST请求"></a>7.1.4 重命名别名 POST请求</h5><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/_aliases<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-comment">// 先删除person_v1.0 别名 在新增 person_v2.0别名,即是重命名</span><br>  <span class="hljs-attr">&quot;actions&quot;</span>: [<br>    &#123;<br>      <span class="hljs-attr">&quot;remove&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;index&quot;</span>: <span class="hljs-string">&quot;person&quot;</span>,<br>        <span class="hljs-attr">&quot;alias&quot;</span>: <span class="hljs-string">&quot;person_v1.0&quot;</span><br>      &#125;<br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">&quot;add&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;index&quot;</span>: <span class="hljs-string">&quot;person&quot;</span>,<br>        <span class="hljs-attr">&quot;alias&quot;</span>: <span class="hljs-string">&quot;person_v2.0&quot;</span><br>      &#125;<br>    &#125;<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;acknowledged&quot;</span>: <span class="hljs-literal">true</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="7-1-5-通过别名获取索引-GET请求"><a href="#7-1-5-通过别名获取索引-GET请求" class="headerlink" title="7.1.5 通过别名获取索引 GET请求"></a>7.1.5 通过别名获取索引 GET请求</h5><ul>
<li>请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person_v2<span class="hljs-number">.0</span><br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;person&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;aliases&quot;</span>: &#123;<br>            <span class="hljs-attr">&quot;person_v2.0&quot;</span>: &#123;&#125;<br>        &#125;,<br>        <span class="hljs-attr">&quot;mappings&quot;</span>: &#123;<br>            <span class="hljs-attr">&quot;properties&quot;</span>: &#123;<br>                <span class="hljs-attr">&quot;age&quot;</span>: &#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;integer&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;birthDay&quot;</span>: &#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;date&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;birthDayStr&quot;</span>: &#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;keyword&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;code&quot;</span>: &#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;text&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;country&quot;</span>: &#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;text&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;countryEn&quot;</span>: &#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;text&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;displayAffiliation&quot;</span>: &#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;text&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;displayName&quot;</span>: &#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;text&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;displayNameEn&quot;</span>: &#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;text&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;draft&quot;</span>: &#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;long&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;heightValue&quot;</span>: &#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;float&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;jerseyNo&quot;</span>: &#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;text&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;playYear&quot;</span>: &#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;long&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;playerId&quot;</span>: &#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;keyword&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;position&quot;</span>: &#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;text&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;schoolType&quot;</span>: &#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;text&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;teamCity&quot;</span>: &#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;text&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;teamCityEn&quot;</span>: &#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;text&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;teamConference&quot;</span>: &#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;keyword&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;teamConferenceEn&quot;</span>: &#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;keyword&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;teamName&quot;</span>: &#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;keyword&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;teamNameEn&quot;</span>: &#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;keyword&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;weight&quot;</span>: &#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;text&quot;</span><br>                &#125;<br>            &#125;<br>        &#125;,<br>        <span class="hljs-attr">&quot;settings&quot;</span>: &#123;<br>            <span class="hljs-attr">&quot;index&quot;</span>: &#123;<br>                <span class="hljs-attr">&quot;creation_date&quot;</span>: <span class="hljs-string">&quot;1573300240575&quot;</span>,<br>                <span class="hljs-attr">&quot;number_of_shards&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,<br>                <span class="hljs-attr">&quot;number_of_replicas&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,<br>                <span class="hljs-attr">&quot;uuid&quot;</span>: <span class="hljs-string">&quot;X7FLu-8sRcijAYKUkgBZQQ&quot;</span>,<br>                <span class="hljs-attr">&quot;version&quot;</span>: &#123;<br>                    <span class="hljs-attr">&quot;created&quot;</span>: <span class="hljs-string">&quot;7020199&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;provided_name&quot;</span>: <span class="hljs-string">&quot;person&quot;</span><br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="7-1-6-通过别名写索引-POST请求"><a href="#7-1-6-通过别名写索引-POST请求" class="headerlink" title="7.1.6 通过别名写索引 POST请求"></a>7.1.6 通过别名写索引 POST请求</h5><ul>
<li> 当别名指定了一个索引，则可以做写的操作 </li>
<li> 请求 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person_v2<span class="hljs-number">.0</span>/_doc/<span class="hljs-number">566</span><br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-comment">// 语义: 通过别名person_v2.0 修改id为566的球员</span><br>    <span class="hljs-attr">&quot;countryEn&quot;</span>: <span class="hljs-string">&quot;Croatia&quot;</span>,<br>    <span class="hljs-attr">&quot;teamName&quot;</span>: <span class="hljs-string">&quot;快船&quot;</span>,<br>    <span class="hljs-attr">&quot;birthDay&quot;</span>: <span class="hljs-number">858661200000</span>,<br>    <span class="hljs-attr">&quot;country&quot;</span>: <span class="hljs-string">&quot;克罗地亚&quot;</span>,<br>    <span class="hljs-attr">&quot;teamCityEn&quot;</span>: <span class="hljs-string">&quot;LA&quot;</span>,<br>    <span class="hljs-attr">&quot;code&quot;</span>: <span class="hljs-string">&quot;ivica_zubac&quot;</span>,<br>    <span class="hljs-attr">&quot;displayAffiliation&quot;</span>: <span class="hljs-string">&quot;Croatia&quot;</span>,<br>    <span class="hljs-attr">&quot;displayName&quot;</span>: <span class="hljs-string">&quot;伊维察 祖巴茨哥哥&quot;</span>, <span class="hljs-comment">//&quot;伊维察 祖巴茨&quot;修改为&quot;伊维察 祖巴茨哥哥&quot;</span><br>    <span class="hljs-attr">&quot;schoolType&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>    <span class="hljs-attr">&quot;teamConference&quot;</span>: <span class="hljs-string">&quot;西部&quot;</span>,<br>    <span class="hljs-attr">&quot;teamConferenceEn&quot;</span>: <span class="hljs-string">&quot;Western&quot;</span>,<br>    <span class="hljs-attr">&quot;weight&quot;</span>: <span class="hljs-string">&quot;108.9 公斤&quot;</span>,<br>    <span class="hljs-attr">&quot;teamCity&quot;</span>: <span class="hljs-string">&quot;洛杉矶&quot;</span>,<br>    <span class="hljs-attr">&quot;playYear&quot;</span>: <span class="hljs-number">3</span>,<br>    <span class="hljs-attr">&quot;jerseyNo&quot;</span>: <span class="hljs-string">&quot;40&quot;</span>,<br>    <span class="hljs-attr">&quot;teamNameEn&quot;</span>: <span class="hljs-string">&quot;Clippers&quot;</span>,<br>    <span class="hljs-attr">&quot;draft&quot;</span>: <span class="hljs-number">2016</span>,<br>    <span class="hljs-attr">&quot;displayNameEn&quot;</span>: <span class="hljs-string">&quot;Ivica Zubac&quot;</span>,<br>    <span class="hljs-attr">&quot;heightValue&quot;</span>: <span class="hljs-number">2.16</span>,<br>    <span class="hljs-attr">&quot;birthDayStr&quot;</span>: <span class="hljs-string">&quot;1997-03-18&quot;</span>,<br>    <span class="hljs-attr">&quot;position&quot;</span>: <span class="hljs-string">&quot;中锋&quot;</span>,<br>    <span class="hljs-attr">&quot;age&quot;</span>: <span class="hljs-number">22</span>,<br>    <span class="hljs-attr">&quot;playerId&quot;</span>: <span class="hljs-string">&quot;1627826&quot;</span><br><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;_index&quot;</span>: <span class="hljs-string">&quot;person&quot;</span>,<br>    <span class="hljs-attr">&quot;_type&quot;</span>: <span class="hljs-string">&quot;_doc&quot;</span>,<br>    <span class="hljs-attr">&quot;_id&quot;</span>: <span class="hljs-string">&quot;566&quot;</span>,<br>    <span class="hljs-attr">&quot;_version&quot;</span>: <span class="hljs-number">2</span>,<br>    <span class="hljs-attr">&quot;result&quot;</span>: <span class="hljs-string">&quot;updated&quot;</span>,<br>    <span class="hljs-attr">&quot;_shards&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;total&quot;</span>: <span class="hljs-number">2</span>,<br>        <span class="hljs-attr">&quot;successful&quot;</span>: <span class="hljs-number">1</span>,<br>        <span class="hljs-attr">&quot;failed&quot;</span>: <span class="hljs-number">0</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;_seq_no&quot;</span>: <span class="hljs-number">566</span>,<br>    <span class="hljs-attr">&quot;_primary_term&quot;</span>: <span class="hljs-number">1</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="7-2-如何重建索引"><a href="#7-2-如何重建索引" class="headerlink" title="7.2 如何重建索引"></a>7.2 如何重建索引</h4><ul>
<li> Elasticsearch是⼀一个实时的分布式搜索引擎，为用户提供搜索服务，当我们决定存储某种数据时，在创建索引的时候需要将数据结构完整确定下来，于此同时索引的设定和很多固定配置将用不能改变。当需要改变数据结构时，就需要重新建立索引，为此，Elastic团队提供了很多辅助工具帮助开发人员进行重建索引 </li>
<li> 步骤 </li>
</ul>
<ol>
<li>person取一个别名person_latest, person_latest作为对外使用</li>
</ol>
<ul>
<li>POST 请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/_aliases<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;actions&quot;</span>: [<br>    &#123;<br>      <span class="hljs-attr">&quot;add&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;index&quot;</span>: <span class="hljs-string">&quot;person&quot;</span>,<br>        <span class="hljs-attr">&quot;alias&quot;</span>: <span class="hljs-string">&quot;person_latest&quot;</span><br>      &#125;<br>    &#125;<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;acknowledged&quot;</span> : <span class="hljs-literal">true</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="2">
<li>新增一个索引person_20220101，结构复制于person索引，根据业务要求修改字段</li>
</ol>
<ul>
<li>PUT 请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person_20220101<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>	<span class="hljs-attr">&quot;mappings&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;properties&quot;</span>: &#123;<br>            <span class="hljs-attr">&quot;age&quot;</span>: &#123;<br>                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;integer&quot;</span><br>            &#125;,<br>            <span class="hljs-attr">&quot;birthDay&quot;</span>: &#123;<br>                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;date&quot;</span><br>            &#125;,<br>            <span class="hljs-attr">&quot;birthDayStr&quot;</span>: &#123;<br>                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;keyword&quot;</span><br>            &#125;,<br>            <span class="hljs-attr">&quot;code&quot;</span>: &#123;<br>                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;text&quot;</span><br>            &#125;,<br>            <span class="hljs-attr">&quot;country&quot;</span>: &#123;<br>                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;keyword&quot;</span><br>            &#125;,<br>            <span class="hljs-attr">&quot;countryEn&quot;</span>: &#123;<br>                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;keyword&quot;</span><br>            &#125;,<br>            <span class="hljs-attr">&quot;displayAffiliation&quot;</span>: &#123;<br>                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;text&quot;</span><br>            &#125;,<br>            <span class="hljs-attr">&quot;displayName&quot;</span>: &#123;<br>                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;text&quot;</span><br>            &#125;,<br>            <span class="hljs-attr">&quot;displayNameEn&quot;</span>: &#123;<br>                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;text&quot;</span><br>            &#125;,<br>            <span class="hljs-attr">&quot;draft&quot;</span>: &#123;<br>                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;long&quot;</span><br>            &#125;,<br>            <span class="hljs-attr">&quot;heightValue&quot;</span>: &#123;<br>                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;float&quot;</span><br>            &#125;,<br>            <span class="hljs-attr">&quot;jerseyNo&quot;</span>: &#123;<br>                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;keyword&quot;</span><br>            &#125;,<br>            <span class="hljs-attr">&quot;playYear&quot;</span>: &#123;<br>                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;long&quot;</span><br>            &#125;,<br>            <span class="hljs-attr">&quot;playerId&quot;</span>: &#123;<br>                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;keyword&quot;</span><br>            &#125;,<br>            <span class="hljs-attr">&quot;position&quot;</span>: &#123;<br>                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;text&quot;</span><br>            &#125;,<br>            <span class="hljs-attr">&quot;schoolType&quot;</span>: &#123;<br>                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;text&quot;</span><br>            &#125;,<br>            <span class="hljs-attr">&quot;teamCity&quot;</span>: &#123;<br>                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;text&quot;</span><br>            &#125;,<br>            <span class="hljs-attr">&quot;teamCityEn&quot;</span>: &#123;<br>                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;text&quot;</span><br>            &#125;,<br>            <span class="hljs-attr">&quot;teamConference&quot;</span>: &#123;<br>                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;keyword&quot;</span><br>            &#125;,<br>            <span class="hljs-attr">&quot;teamConferenceEn&quot;</span>: &#123;<br>                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;keyword&quot;</span><br>            &#125;,<br>            <span class="hljs-attr">&quot;teamName&quot;</span>: &#123;<br>                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;keyword&quot;</span><br>            &#125;,<br>            <span class="hljs-attr">&quot;teamNameEn&quot;</span>: &#123;<br>                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;keyword&quot;</span><br>            &#125;,<br>            <span class="hljs-attr">&quot;weight&quot;</span>: &#123;<br>                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;text&quot;</span><br>            &#125;<br>        &#125;<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;acknowledged&quot;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">&quot;shards_acknowledged&quot;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">&quot;index&quot;</span>: <span class="hljs-string">&quot;person_20220101&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="3">
<li>将person数据同步到person_20220101</li>
</ol>
<ul>
<li>POST 请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/_reindex <span class="hljs-comment">//同步请求 等待响应</span><br>localhost:<span class="hljs-number">9200</span>/_reindex?wait_for_completion=<span class="hljs-keyword">false</span>  <span class="hljs-comment">// 异步请求 直接返回</span><br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;source&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;index&quot;</span>: <span class="hljs-string">&quot;person&quot;</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;dest&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;index&quot;</span>: <span class="hljs-string">&quot;person_20220101&quot;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;took&quot;</span> : <span class="hljs-number">102</span>,<br>  <span class="hljs-attr">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">566</span>,<br>  <span class="hljs-attr">&quot;updated&quot;</span> : <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;created&quot;</span> : <span class="hljs-number">566</span>,<br>  <span class="hljs-attr">&quot;deleted&quot;</span> : <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;batches&quot;</span> : <span class="hljs-number">1</span>,<br>  <span class="hljs-attr">&quot;version_conflicts&quot;</span> : <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;noops&quot;</span> : <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;retries&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;bulk&quot;</span> : <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;search&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;throttled_millis&quot;</span> : <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;requests_per_second&quot;</span> : <span class="hljs-number">-1.0</span>,<br>  <span class="hljs-attr">&quot;throttled_until_millis&quot;</span> : <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;failures&quot;</span> : [ ]<br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="4">
<li>给person_20220101添加别名person_latest，删除person别名person_latest</li>
</ol>
<ul>
<li>POST请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/_aliases<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;actions&quot;</span>: [<br>    &#123;<br>      <span class="hljs-attr">&quot;add&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;index&quot;</span>: <span class="hljs-string">&quot;person_20220101&quot;</span>,<br>        <span class="hljs-attr">&quot;alias&quot;</span>: <span class="hljs-string">&quot;person_latest&quot;</span><br>      &#125;<br>    &#125;<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;acknowledged&quot;</span> : <span class="hljs-literal">true</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="5">
<li>删除person索引</li>
</ol>
<ul>
<li>DELETE请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;acknowledged&quot;</span> : <span class="hljs-literal">true</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="7-3-refresh操作"><a href="#7-3-refresh操作" class="headerlink" title="7.3 refresh操作"></a>7.3 refresh操作</h4><ul>
<li>理想的搜索</li>
</ul>
<ol>
<li> 新的数据一添加到索引中立马就能搜索到，但是真实情况不是这样的 </li>
<li> 我们使⽤用链式命令请求，先添加⼀一个⽂文档，再⽴立刻搜索 </li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">curl -X PUT localhost:<span class="hljs-number">9200</span>/star/_doc/<span class="hljs-number">888</span> -H <span class="hljs-string">&#x27;Content-Type:</span><br><span class="hljs-string"></span><br><span class="hljs-string">application/json&#x27;</span>	-d <span class="hljs-string">&#x27;&#123; &quot;displayName&quot;: &quot;蔡徐坤&quot; &#125;&#x27;</span><br><br>curl	-X GET localhost:<span class="hljs-number">9200</span>/star/_doc/_search?pretty<br></code></pre></td></tr></table></figure>

<ol start="3">
<li>强制刷新</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">curl -X PUT localhost:<span class="hljs-number">9200</span>/star/_doc/<span class="hljs-number">666</span>?refresh -H <span class="hljs-string">&#x27;Content-Type:</span><br><span class="hljs-string"></span><br><span class="hljs-string">application/json&#x27;</span>	-d <span class="hljs-string">&#x27;&#123; &quot;displayName&quot;: &quot;杨超越&quot; &#125;&#x27;</span><br><br>curl	-X GET localhost:<span class="hljs-number">9200</span>/star/_doc/_search?pretty<br></code></pre></td></tr></table></figure>

<ol start="4">
<li>修改默认更更新时间(默认时间是1s)</li>
</ol>
<ul>
<li>PUT 请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/star/_settings<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;index&quot;</span>:&#123;<br>    <span class="hljs-attr">&quot;refresh_interval&quot;</span>: <span class="hljs-string">&quot;5s&quot;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;acknowledged&quot;</span> : <span class="hljs-literal">true</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="5">
<li>将refresh关闭</li>
</ol>
<ul>
<li>PUT 请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/star/_settings<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;index&quot;</span>:&#123;<br>    <span class="hljs-attr">&quot;refresh_interval&quot;</span>: <span class="hljs-string">&quot;-1&quot;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;acknowledged&quot;</span> : <span class="hljs-literal">true</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="7-4-高亮查询"><a href="#7-4-高亮查询" class="headerlink" title="7.4 高亮查询"></a>7.4 高亮查询</h4><ul>
<li> 如果返回的结果集中很多符合条件的结果，那怎么能一眼就能看到我们想要的那个结果呢？比如，我们搜索苍井空 ，在结果集中，将所有苍井空 高亮显示？ </li>
<li> 请求 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person_latest/_search<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-comment">// 语义: 查找person james球员，对james做高亮显示</span><br>  <span class="hljs-attr">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;match&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;displayNameEn&quot;</span>: <span class="hljs-string">&quot;james&quot;</span><br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;highlight&quot;</span>: &#123; <span class="hljs-comment">// 高亮关键字</span><br>    <span class="hljs-attr">&quot;fields&quot;</span>: &#123; <span class="hljs-comment">// 对displayNameEn做高亮</span><br>      <span class="hljs-attr">&quot;displayNameEn&quot;</span>: &#123;&#125;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">2</span><br>&#125;<br><br> <span class="hljs-comment">// 也可以自定义标签</span><br>&#123;<br>  <span class="hljs-attr">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;match&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;displayNameEn&quot;</span>: <span class="hljs-string">&quot;james&quot;</span><br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;highlight&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;fields&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;displayNameEn&quot;</span>: &#123;<br>        <span class="hljs-comment">// 定义高亮标签为 h1</span><br>        <span class="hljs-attr">&quot;pre_tags&quot;</span>: [<span class="hljs-string">&quot;&lt;h1&gt;&quot;</span>],<br>        <span class="hljs-attr">&quot;post_tags&quot;</span>: [<span class="hljs-string">&quot;&lt;/h1&gt;&quot;</span>]<br><br>      &#125;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;size&quot;</span>: <span class="hljs-number">2</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;took&quot;</span> : <span class="hljs-number">2</span>,<br>  <span class="hljs-attr">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;skipped&quot;</span> : <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;hits&quot;</span> : &#123;<br>    <span class="hljs-attr">&quot;total&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;value&quot;</span> : <span class="hljs-number">5</span>,<br>      <span class="hljs-attr">&quot;relation&quot;</span> : <span class="hljs-string">&quot;eq&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;max_score&quot;</span> : <span class="hljs-number">4.699642</span>,<br>    <span class="hljs-attr">&quot;hits&quot;</span> : [<br>      &#123;<br>        <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person_20220101&quot;</span>,<br>        <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>        <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;214&quot;</span>,<br>        <span class="hljs-attr">&quot;_score&quot;</span> : <span class="hljs-number">4.699642</span>,<br>        <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;countryEn&quot;</span> : <span class="hljs-string">&quot;United States&quot;</span>,<br>          <span class="hljs-attr">&quot;teamName&quot;</span> : <span class="hljs-string">&quot;火箭&quot;</span>,<br>          <span class="hljs-attr">&quot;birthDay&quot;</span> : <span class="hljs-number">620107200000</span>,<br>          <span class="hljs-attr">&quot;country&quot;</span> : <span class="hljs-string">&quot;美国&quot;</span>,<br>          <span class="hljs-attr">&quot;teamCityEn&quot;</span> : <span class="hljs-string">&quot;Houston&quot;</span>,<br>          <span class="hljs-attr">&quot;code&quot;</span> : <span class="hljs-string">&quot;james_harden&quot;</span>,<br>          <span class="hljs-attr">&quot;displayAffiliation&quot;</span> : <span class="hljs-string">&quot;Arizona State/United States&quot;</span>,<br>          <span class="hljs-attr">&quot;displayName&quot;</span> : <span class="hljs-string">&quot;詹姆斯 哈登&quot;</span>,<br>          <span class="hljs-attr">&quot;schoolType&quot;</span> : <span class="hljs-string">&quot;College&quot;</span>,<br>          <span class="hljs-attr">&quot;teamConference&quot;</span> : <span class="hljs-string">&quot;西部&quot;</span>,<br>          <span class="hljs-attr">&quot;teamConferenceEn&quot;</span> : <span class="hljs-string">&quot;Western&quot;</span>,<br>          <span class="hljs-attr">&quot;weight&quot;</span> : <span class="hljs-string">&quot;99.8 公斤&quot;</span>,<br>          <span class="hljs-attr">&quot;teamCity&quot;</span> : <span class="hljs-string">&quot;休斯顿&quot;</span>,<br>          <span class="hljs-attr">&quot;playYear&quot;</span> : <span class="hljs-number">10</span>,<br>          <span class="hljs-attr">&quot;jerseyNo&quot;</span> : <span class="hljs-string">&quot;13&quot;</span>,<br>          <span class="hljs-attr">&quot;teamNameEn&quot;</span> : <span class="hljs-string">&quot;Rockets&quot;</span>,<br>          <span class="hljs-attr">&quot;draft&quot;</span> : <span class="hljs-number">2009</span>,<br>          <span class="hljs-attr">&quot;displayNameEn&quot;</span> : <span class="hljs-string">&quot;James Harden&quot;</span>,<br>          <span class="hljs-attr">&quot;heightValue&quot;</span> : <span class="hljs-number">1.96</span>,<br>          <span class="hljs-attr">&quot;birthDayStr&quot;</span> : <span class="hljs-string">&quot;1989-08-26&quot;</span>,<br>          <span class="hljs-attr">&quot;position&quot;</span> : <span class="hljs-string">&quot;后卫&quot;</span>,<br>          <span class="hljs-attr">&quot;age&quot;</span> : <span class="hljs-number">30</span>,<br>          <span class="hljs-attr">&quot;playerId&quot;</span> : <span class="hljs-string">&quot;201935&quot;</span><br>        &#125;,<br>        <span class="hljs-attr">&quot;highlight&quot;</span> : &#123;<br>          <span class="hljs-comment">// &quot;&lt;em&gt; 包裹起来是 高亮的意思</span><br>          <span class="hljs-attr">&quot;displayNameEn&quot;</span> : [<br>            <span class="hljs-string">&quot;&lt;em&gt;James&lt;/em&gt; Harden&quot;</span><br>          ]<br>        &#125;<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">&quot;_index&quot;</span> : <span class="hljs-string">&quot;person_20220101&quot;</span>,<br>        <span class="hljs-attr">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>        <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;266&quot;</span>,<br>        <span class="hljs-attr">&quot;_score&quot;</span> : <span class="hljs-number">4.699642</span>,<br>        <span class="hljs-attr">&quot;_source&quot;</span> : &#123;<br>          <span class="hljs-attr">&quot;countryEn&quot;</span> : <span class="hljs-string">&quot;United States&quot;</span>,<br>          <span class="hljs-attr">&quot;teamName&quot;</span> : <span class="hljs-string">&quot;国王&quot;</span>,<br>          <span class="hljs-attr">&quot;birthDay&quot;</span> : <span class="hljs-number">854082000000</span>,<br>          <span class="hljs-attr">&quot;country&quot;</span> : <span class="hljs-string">&quot;美国&quot;</span>,<br>          <span class="hljs-attr">&quot;teamCityEn&quot;</span> : <span class="hljs-string">&quot;Sacramento&quot;</span>,<br>          <span class="hljs-attr">&quot;code&quot;</span> : <span class="hljs-string">&quot;justin_james&quot;</span>,<br>          <span class="hljs-attr">&quot;displayAffiliation&quot;</span> : <span class="hljs-string">&quot;United States&quot;</span>,<br>          <span class="hljs-attr">&quot;displayName&quot;</span> : <span class="hljs-string">&quot;贾斯汀 詹姆斯&quot;</span>,<br>          <span class="hljs-attr">&quot;schoolType&quot;</span> : <span class="hljs-string">&quot;College&quot;</span>,<br>          <span class="hljs-attr">&quot;teamConference&quot;</span> : <span class="hljs-string">&quot;西部&quot;</span>,<br>          <span class="hljs-attr">&quot;teamConferenceEn&quot;</span> : <span class="hljs-string">&quot;Western&quot;</span>,<br>          <span class="hljs-attr">&quot;weight&quot;</span> : <span class="hljs-string">&quot;86.2 公斤&quot;</span>,<br>          <span class="hljs-attr">&quot;teamCity&quot;</span> : <span class="hljs-string">&quot;萨克拉门托&quot;</span>,<br>          <span class="hljs-attr">&quot;playYear&quot;</span> : <span class="hljs-number">0</span>,<br>          <span class="hljs-attr">&quot;jerseyNo&quot;</span> : <span class="hljs-string">&quot;&quot;</span>,<br>          <span class="hljs-attr">&quot;teamNameEn&quot;</span> : <span class="hljs-string">&quot;Kings&quot;</span>,<br>          <span class="hljs-attr">&quot;draft&quot;</span> : <span class="hljs-number">2019</span>,<br>          <span class="hljs-attr">&quot;displayNameEn&quot;</span> : <span class="hljs-string">&quot;Justin James&quot;</span>,<br>          <span class="hljs-attr">&quot;heightValue&quot;</span> : <span class="hljs-number">2.01</span>,<br>          <span class="hljs-attr">&quot;birthDayStr&quot;</span> : <span class="hljs-string">&quot;1997-01-24&quot;</span>,<br>          <span class="hljs-attr">&quot;position&quot;</span> : <span class="hljs-string">&quot;后卫-前锋&quot;</span>,<br>          <span class="hljs-attr">&quot;age&quot;</span> : <span class="hljs-number">22</span>,<br>          <span class="hljs-attr">&quot;playerId&quot;</span> : <span class="hljs-string">&quot;1629713&quot;</span><br>        &#125;,<br>        <span class="hljs-attr">&quot;highlight&quot;</span> : &#123;<br>          <span class="hljs-comment">// &quot;&lt;em&gt; 包裹起来是 高亮的意思</span><br>          <span class="hljs-attr">&quot;displayNameEn&quot;</span> : [<br>            <span class="hljs-string">&quot;Justin &lt;em&gt;James&lt;/em&gt;&quot;</span><br>          ]<br>        &#125;<br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="7-5-查询建议"><a href="#7-5-查询建议" class="headerlink" title="7.5 查询建议"></a>7.5 查询建议</h4><ul>
<li>查询建议是什么</li>
</ul>
<ol>
<li>查询建议，是为了给用户提供更好的搜索体验。包括：词条检查，自动补全</li>
</ol>
<ul>
<li>Suggester</li>
</ul>
<ol>
<li>Term suggester</li>
<li>Phrase suggester</li>
<li>Completion suggester<table>
<thead>
<tr>
<th>text</th>
<th>指定搜索文本</th>
</tr>
</thead>
<tbody><tr>
<td>field</td>
<td>获取建议词的搜索字段</td>
</tr>
<tr>
<td>analyzer</td>
<td>指定分词器</td>
</tr>
<tr>
<td>size</td>
<td>每个词返回的最大建议词数</td>
</tr>
<tr>
<td>sort</td>
<td>如何对建议词进行排序，可用选项:score:先按评分排序、再按文档频率排、term顺序；frequency:先按文档频率排，再按评分、term顺序排。</td>
</tr>
<tr>
<td>suggest_mode</td>
<td>建议模式，控制提供建议词的方式：missing:仅在搜索的词项在索引中不存在时才提供建议词，默认值；popular:仅建议文档频率比搜索词项高的词；always：总是提供匹配的建议词</td>
</tr>
</tbody></table>
</li>
</ol>
<h5 id="7-5-1-term-suggester"><a href="#7-5-1-term-suggester" class="headerlink" title="7.5.1 term suggester"></a>7.5.1 term suggester</h5><ul>
<li> term 词条建议器 ，对给输入的文本进行分词，为每个分词提供词项建议 </li>
<li> 请求 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person_latest/_search<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;suggest&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;my-suggest&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;text&quot;</span>: <span class="hljs-string">&quot;jamse&quot;</span>, <span class="hljs-comment">//用户可能输入错误 jsmes写成jamse</span><br>      <span class="hljs-attr">&quot;term&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;suggest_mode&quot;</span>: <span class="hljs-string">&quot;missing&quot;</span>,<br>        <span class="hljs-attr">&quot;field&quot;</span>: <span class="hljs-string">&quot;displayNameEn&quot;</span><br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="7-5-2-phrase-suggester"><a href="#7-5-2-phrase-suggester" class="headerlink" title="7.5.2 phrase suggester"></a>7.5.2 phrase suggester</h5><ul>
<li> phrase 短语建议，在term的基础上，会考量多个term之间的关系，比如是否同时出现在索引的原文⾥里，相邻程度，以及词频等 </li>
<li> 请求 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person_latest/_search<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;suggest&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;my-suggest&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;text&quot;</span>: <span class="hljs-string">&quot;jamse hardne&quot;</span>,<br>      <span class="hljs-attr">&quot;phrase&quot;</span>: &#123; <span class="hljs-comment">// 词组 对单词进行联系</span><br>        <span class="hljs-attr">&quot;field&quot;</span>: <span class="hljs-string">&quot;displayNameEn&quot;</span><br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="7-5-3-completion-suggester"><a href="#7-5-3-completion-suggester" class="headerlink" title="7.5.3 completion suggester"></a>7.5.3 completion suggester</h5><ul>
<li> Completion 完成建议 </li>
<li> 请求 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">localhost:<span class="hljs-number">9200</span>/person_latest/_search<br></code></pre></td></tr></table></figure>

<ul>
<li>请求体</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;suggest&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;my-suggest&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;text&quot;</span>: <span class="hljs-string">&quot;Miam&quot;</span>,<br>      <span class="hljs-attr">&quot;completion&quot;</span>:&#123;<br>      <span class="hljs-attr">&quot;field&quot;</span>: <span class="hljs-string">&quot;teamCityEn&quot;</span><br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h3 id="八、person中国官网实战"><a href="#八、person中国官网实战" class="headerlink" title="八、person中国官网实战"></a>八、person中国官网实战</h3><ul>
<li>官方网站<br><code>https://china.person.com/playerindex/</code></li>
</ul>
<h4 id="8-1-项目搭建"><a href="#8-1-项目搭建" class="headerlink" title="8.1 项目搭建"></a>8.1 项目搭建</h4><ul>
<li>springboot 整合 elasticsearch 和 mysql</li>
</ul>
<h5 id="8-1-1-POM依赖"><a href="#8-1-1-POM依赖" class="headerlink" title="8.1.1 POM依赖"></a>8.1.1 POM依赖</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- elasticsearch-rest-high-level-client --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.elasticsearch.client<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>elasticsearch-rest-high-level-client<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>7.2.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-comment">&lt;!-- elasticsearch --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.elasticsearch<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>elasticsearch<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>7.2.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>


<h5 id="8-1-2-YML依赖"><a href="#8-1-2-YML依赖" class="headerlink" title="8.1.2 YML依赖"></a>8.1.2 YML依赖</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">elasticsearch:</span><br>  <span class="hljs-attr">host:</span> <span class="hljs-string">localhost</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">9200</span><br></code></pre></td></tr></table></figure>


<h5 id="8-1-3-ElasticSearch配置文件"><a href="#8-1-3-ElasticSearch配置文件" class="headerlink" title="8.1.3 ElasticSearch配置文件"></a>8.1.3 ElasticSearch配置文件</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.frame.elasticsearch.config;<br><br><span class="hljs-keyword">import</span> lombok.Data;<br><span class="hljs-keyword">import</span> org.apache.http.HttpHost;<br><span class="hljs-keyword">import</span> org.elasticsearch.client.RestClient;<br><span class="hljs-keyword">import</span> org.elasticsearch.client.RestHighLevelClient;<br><span class="hljs-keyword">import</span> org.springframework.boot.SpringBootConfiguration;<br><span class="hljs-keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ElasticSearch配置文件</span><br><span class="hljs-comment"> * Es7使用RestHighLevelClient操作ES</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@SpringBootConfiguration</span><br><span class="hljs-meta">@ConfigurationProperties(prefix = &quot;elasticsearch&quot;)</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ElasticSearchConfig</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String host;<br>    <span class="hljs-keyword">private</span> Integer port;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 创建RestHighLevelClient 实例</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> RestHighLevelClient <span class="hljs-title">restHighLevelClient</span><span class="hljs-params">()</span> </span>&#123;<br>        HttpHost http = <span class="hljs-keyword">new</span> HttpHost(host, port, <span class="hljs-string">&quot;http&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> RestHighLevelClient(RestClient.builder(http));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="8-1-4-ElasticSearch-CRUD入门操作"><a href="#8-1-4-ElasticSearch-CRUD入门操作" class="headerlink" title="8.1.4 ElasticSearch CRUD入门操作"></a>8.1.4 ElasticSearch CRUD入门操作</h5><ul>
<li>对象转Map工具类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.springframework.cglib.beans.BeanMap;<br><br><span class="hljs-keyword">import</span> java.util.HashMap;<br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BeanUtils</span> </span>&#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 对象转为Map</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function">Map&lt;String, Object&gt; <span class="hljs-title">beanToMap</span><span class="hljs-params">(T bean)</span> </span>&#123;<br>        HashMap&lt;String, Object&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();<br>        <span class="hljs-keyword">if</span> (bean != <span class="hljs-keyword">null</span>) &#123;<br>            BeanMap beanMap = BeanMap.create(bean);<br>            <span class="hljs-keyword">for</span> (Object o : beanMap.keySet()) &#123;<br>                <span class="hljs-keyword">if</span> (beanMap.get(o) != <span class="hljs-keyword">null</span>) &#123;<br>                    map.put(o.toString(), beanMap.get(o));<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> map;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>CRUD 实现方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSON;<br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;<br><span class="hljs-keyword">import</span> com.frame.common.entity.personPlayer;<br><span class="hljs-keyword">import</span> com.frame.common.utils.BeanUtils;<br><span class="hljs-keyword">import</span> com.frame.elasticsearch.mapper.personPlayerMapper;<br><span class="hljs-keyword">import</span> com.frame.elasticsearch.service.personPlayerService;<br><span class="hljs-keyword">import</span> org.elasticsearch.action.delete.DeleteRequest;<br><span class="hljs-keyword">import</span> org.elasticsearch.action.delete.DeleteResponse;<br><span class="hljs-keyword">import</span> org.elasticsearch.action.get.GetRequest;<br><span class="hljs-keyword">import</span> org.elasticsearch.action.get.GetResponse;<br><span class="hljs-keyword">import</span> org.elasticsearch.action.index.IndexRequest;<br><span class="hljs-keyword">import</span> org.elasticsearch.action.index.IndexResponse;<br><span class="hljs-keyword">import</span> org.elasticsearch.action.update.UpdateRequest;<br><span class="hljs-keyword">import</span> org.elasticsearch.action.update.UpdateResponse;<br><span class="hljs-keyword">import</span> org.elasticsearch.client.RequestOptions;<br><span class="hljs-keyword">import</span> org.elasticsearch.client.RestHighLevelClient;<br><span class="hljs-keyword">import</span> org.elasticsearch.index.reindex.BulkByScrollResponse;<br><span class="hljs-keyword">import</span> org.elasticsearch.index.reindex.DeleteByQueryRequest;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * 服务实现类</span><br><span class="hljs-comment"> * &lt;/p&gt;</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> Crazy.X</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@since</span> 2019-11-10</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">personPlayerServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">personPlayerService</span> </span>&#123;<br><br>    <span class="hljs-comment">/* ES索引 */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String person_INDEX = <span class="hljs-string">&quot;person_latest&quot;</span>;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> RestHighLevelClient restHighLevelClient;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 添加一条文档</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">addPlayer</span><span class="hljs-params">(personPlayer player, String id)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        <span class="hljs-comment">// 获取 IndexRequest</span><br>        IndexRequest request = <span class="hljs-keyword">new</span> IndexRequest(person_INDEX)<br>                .id(id)<br>                .source(BeanUtils.beanToMap(player));<br>        <span class="hljs-comment">// 获取 IndexResponse</span><br>        IndexResponse response = restHighLevelClient.index(request, RequestOptions.DEFAULT);<br>        System.out.println(JSON.toJSONString(response));<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 获取一条文档</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Map&lt;String, Object&gt; <span class="hljs-title">getPlayer</span><span class="hljs-params">(String id)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        <span class="hljs-comment">// 获取 GetRequest</span><br>        GetRequest getRequest = <span class="hljs-keyword">new</span> GetRequest(person_INDEX, id);<br>        <span class="hljs-comment">// 获取 GetResponse</span><br>        GetResponse getResponse = restHighLevelClient.get(getRequest, RequestOptions.DEFAULT);<br>        <span class="hljs-comment">// 返回结果</span><br>        <span class="hljs-keyword">return</span> getResponse.getSource();<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 更新一条文档</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">updatePlayer</span><span class="hljs-params">(personPlayer personPlayer, String id)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        <span class="hljs-comment">// 获取 UpdateRequest</span><br>        UpdateRequest updateRequest = <span class="hljs-keyword">new</span> UpdateRequest(person_INDEX, id)<br>                .doc(BeanUtils.beanToMap(personPlayer));<br>        <span class="hljs-comment">// 获取 UpdateResponse</span><br>        UpdateResponse update = restHighLevelClient.update(updateRequest, RequestOptions.DEFAULT);<br>        System.out.println(JSON.toJSONString(update));<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 删除一条文档</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">deletePlayer</span><span class="hljs-params">(String id)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        <span class="hljs-comment">// 获取 DeleteRequest</span><br>        DeleteRequest deleteRequest = <span class="hljs-keyword">new</span> DeleteRequest(person_INDEX, id).id(id);<br>        <span class="hljs-comment">// 获取 DeleteResponse</span><br>        DeleteResponse delete = restHighLevelClient.delete(deleteRequest, RequestOptions.DEFAULT);<br>        System.out.println(delete);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 删除所有文档</span><br><span class="hljs-comment">     * 先查询所所有在进行删除</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">deleteAllPlayer</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        <span class="hljs-comment">// 获取 deleteByQueryRequest</span><br>        DeleteByQueryRequest deleteByQueryRequest = <span class="hljs-keyword">new</span> DeleteByQueryRequest(person_INDEX);<br>        <span class="hljs-comment">// 获取 BulkByScrollResponse</span><br>        BulkByScrollResponse bulkByScrollResponse = restHighLevelClient.deleteByQuery(<br>                deleteByQueryRequest,<br>                RequestOptions.DEFAULT<br>        );<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>CRUD 测试类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> com.frame.common.entity.personPlayer;<br><span class="hljs-keyword">import</span> com.frame.elasticsearch.service.personPlayerService;<br><span class="hljs-keyword">import</span> org.junit.Test;<br><span class="hljs-keyword">import</span> org.junit.runner.RunWith;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.springframework.test.context.junit4.SpringRunner;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-meta">@RunWith(SpringRunner.class)</span><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">personPlayerServiceImplTest</span> </span>&#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    personPlayerService personPlayerService;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addPlayer</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        personPlayer personPlayer = <span class="hljs-keyword">new</span> personPlayer()<br>                .setId(<span class="hljs-number">999</span>)<br>                .setDisplayName(<span class="hljs-string">&quot;苍井空&quot;</span>);<br>        <span class="hljs-keyword">boolean</span> result = personPlayerService.addPlayer(personPlayer, <span class="hljs-string">&quot;999&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">getPlayer</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        Map&lt;String, Object&gt; player = personPlayerService.getPlayer(<span class="hljs-string">&quot;999&quot;</span>);<br>        System.out.println(player);<br>    &#125;<br><br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">updatePlayer</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        personPlayer personPlayer = <span class="hljs-keyword">new</span> personPlayer()<br>                .setId(<span class="hljs-number">999</span>)<br>                .setDisplayName(<span class="hljs-string">&quot;小泽玛利亚&quot;</span>);<br>        <span class="hljs-keyword">boolean</span> result = personPlayerService.updatePlayer(personPlayer, <span class="hljs-string">&quot;999&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">deletePlayer</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        <span class="hljs-keyword">boolean</span> result = personPlayerService.deletePlayer(<span class="hljs-string">&quot;999&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">deleteAllPlayer</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        <span class="hljs-keyword">boolean</span> result = personPlayerService.deleteAllPlayer();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="8-2-接口开发"><a href="#8-2-接口开发" class="headerlink" title="8.2 接口开发"></a>8.2 接口开发</h4><ul>
<li>Result结果集Vo</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> com.frame.common.enums.ResultEnum;<br><span class="hljs-keyword">import</span> lombok.AllArgsConstructor;<br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 结果封装Vo</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Result</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br><br>    <span class="hljs-keyword">private</span> Integer code;<br>    <span class="hljs-keyword">private</span> String msg;<br>    <span class="hljs-keyword">private</span> T data;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function">Result <span class="hljs-title">success</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> success(<span class="hljs-keyword">null</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function">Result <span class="hljs-title">success</span><span class="hljs-params">(T data)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> success(ResultEnum.SUCCESS.getCode(), data);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function">Result <span class="hljs-title">success</span><span class="hljs-params">(Integer code, T data)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> success(code, ResultEnum.SUCCESS.getMsg(), data);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function">Result <span class="hljs-title">success</span><span class="hljs-params">(String msg, T data)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> success(ResultEnum.SUCCESS.getCode(), msg, data);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function">Result <span class="hljs-title">success</span><span class="hljs-params">(Integer code, String msg, T data)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Result&lt;T&gt;(code, msg, data);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function">Result <span class="hljs-title">fail</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> fail(ResultEnum.FAIL.getCode());<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function">Result <span class="hljs-title">fail</span><span class="hljs-params">(Integer code)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> fail(code, ResultEnum.FAIL.getMsg());<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function">Result <span class="hljs-title">fail</span><span class="hljs-params">(String msg)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> fail(ResultEnum.FAIL.getCode(), msg);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function">Result <span class="hljs-title">fail</span><span class="hljs-params">(Integer code, String msg)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> success(code, msg, <span class="hljs-keyword">null</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>结果集对应的枚举</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> lombok.AllArgsConstructor;<br><span class="hljs-keyword">import</span> lombok.Getter;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Result结果集枚举类</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Getter</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">ResultEnum</span> </span>&#123;<br><br>    SUCCESS(<span class="hljs-number">200</span>, <span class="hljs-string">&quot;操作成功&quot;</span>),<br>    FAIL(<span class="hljs-number">400</span>,<span class="hljs-string">&quot;操作失败&quot;</span>)<br>    ;<br>    <span class="hljs-keyword">private</span> Integer code;<br>    <span class="hljs-keyword">private</span> String msg;<br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="8-2-1-将数据库数据导入到elastic-search"><a href="#8-2-1-将数据库数据导入到elastic-search" class="headerlink" title="8.2.1 将数据库数据导入到elastic search"></a>8.2.1 将数据库数据导入到elastic search</h5><ul>
<li>controller层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 从mysql导入数据到es</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@GetMapping(&quot;/import&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Result <span class="hljs-title">importAllPlayer</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>        personPlayerService.importAllPlayer();<br>        <span class="hljs-keyword">return</span> Result.success(<span class="hljs-string">&quot;数据导入成功&quot;</span>);<br>    &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>        log.error(<span class="hljs-string">&quot;ElasticSearch导入数据失败&quot;</span>);<br>        e.printStackTrace();<br>        <span class="hljs-keyword">return</span> Result.fail(<span class="hljs-string">&quot;ElasticSearch导入数据失败&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>service层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 从mysql导入数据到es</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-meta">@Transactional</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">importAllPlayer</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>    <span class="hljs-comment">// 查询所有数据,这里使用MybatisPlus不作解释</span><br>    List&lt;personPlayer&gt; personPlayers = list();<br>    <span class="hljs-keyword">for</span> (personPlayer e : personPlayers) &#123;<br>        <span class="hljs-comment">// 此处调用的增加文档方法</span><br>        addPlayer(e, String.valueOf(e.getId()));<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="8-2-2-通过姓名查找球员"><a href="#8-2-2-通过姓名查找球员" class="headerlink" title="8.2.2 通过姓名查找球员"></a>8.2.2 通过姓名查找球员</h5><ul>
<li>controller层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 通过姓名查找球员</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@GetMapping(&quot;/searchMatch&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Result <span class="hljs-title">searchMatch</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;key&quot;)</span> String key,</span></span><br><span class="hljs-params"><span class="hljs-function">                          <span class="hljs-meta">@RequestParam(&quot;val&quot;)</span> String val,</span></span><br><span class="hljs-params"><span class="hljs-function">                          <span class="hljs-meta">@RequestParam(value = &quot;page&quot;, required = false, defaultValue = &quot;0&quot;)</span> Integer page,</span></span><br><span class="hljs-params"><span class="hljs-function">                          <span class="hljs-meta">@RequestParam(value = &quot;limit&quot;, required = false, defaultValue = &quot;10&quot;)</span> Integer limit)</span> </span>&#123;<br>    List&lt;personPlayer&gt; personPlayers = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">try</span> &#123;<br>        personPlayers = personPlayerService.searchTerm(key, val, page, limit);<br>    &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>        log.error(<span class="hljs-string">&quot;searchMatch失败,参数[key=&#123;&#125;]][val=&#123;&#125;]]&quot;</span>, key, val);<br>        e.printStackTrace();<br>    &#125;<br>    <span class="hljs-keyword">return</span> Result.success(personPlayers);<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>service层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 通过姓名查找球员</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;personPlayer&gt; <span class="hljs-title">searchMatch</span><span class="hljs-params">(String key, String val, Integer page, Integer limit)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>    <span class="hljs-comment">// 获取 SearchRequest</span><br>    SearchRequest searchRequest = <span class="hljs-keyword">new</span> SearchRequest(person_INDEX);<br>    <span class="hljs-comment">// 创建 SearchSourceBuilder 用于查询语句</span><br>    SearchSourceBuilder searchSourceBuilder = <span class="hljs-keyword">new</span> SearchSourceBuilder();<br>    searchSourceBuilder<br>            <span class="hljs-comment">// 查询 通过match查询 key 字段名称 val 字段值</span><br>            .query(QueryBuilders.termQuery(key, val))<br>            <span class="hljs-comment">// 起始页</span><br>            .from(page)<br>            <span class="hljs-comment">// 显示条数</span><br>            .size(limit);<br>    <span class="hljs-comment">// 设置 请求源 理解为设置查询语句</span><br>    searchRequest.source(searchSourceBuilder);<br>    <span class="hljs-comment">// 获取 SearchResponse 查询数据</span><br>    SearchResponse searchResponse = restHighLevelClient.search(searchRequest, RequestOptions.DEFAULT);<br>    <span class="hljs-comment">// 获取碰撞之后的结果 (固定写法)</span><br>    SearchHit[] hits = searchResponse.getHits().getHits();<br>    <span class="hljs-comment">// 进行对象转换并返回</span><br>    <span class="hljs-keyword">return</span> Stream.of(hits)<br>            .map(e -&gt; JSON.parseObject(e.getSourceAsString(), personPlayer.class))<br>            .collect(Collectors.toList());<br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="8-2-3-通过国家或者球队查询球员"><a href="#8-2-3-通过国家或者球队查询球员" class="headerlink" title="8.2.3 通过国家或者球队查询球员"></a>8.2.3 通过国家或者球队查询球员</h5><ul>
<li>controller层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 通过国家或者球队查询球员</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@GetMapping(&quot;/searchTerm&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Result <span class="hljs-title">searchTerm</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = &quot;country&quot;, required = false)</span> String country,</span></span><br><span class="hljs-params"><span class="hljs-function">                         <span class="hljs-meta">@RequestParam(value = &quot;teamName&quot;, required = false)</span> String teamName,</span></span><br><span class="hljs-params"><span class="hljs-function">                         <span class="hljs-meta">@RequestParam(value = &quot;page&quot;, required = false, defaultValue = &quot;0&quot;)</span> Integer page,</span></span><br><span class="hljs-params"><span class="hljs-function">                         <span class="hljs-meta">@RequestParam(value = &quot;limit&quot;, required = false, defaultValue = &quot;10&quot;)</span> Integer limit)</span> </span>&#123;<br>    List&lt;personPlayer&gt; personPlayers = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-comment">// 路由选择国家 或者 球队</span><br>        <span class="hljs-keyword">if</span> (StringUtils.isNotBlank(country)) &#123;<br>            personPlayers = personPlayerService.searchTerm(<span class="hljs-string">&quot;country&quot;</span>, country, page, limit);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            personPlayers = personPlayerService.searchTerm(<span class="hljs-string">&quot;teamName&quot;</span>, teamName, page, limit);<br>        &#125;<br>    &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>        log.error(<span class="hljs-string">&quot;searchTerm失败,参数[country=&#123;&#125;]][teamName=&#123;&#125;]]&quot;</span>, country, teamName);<br>        e.printStackTrace();<br>    &#125;<br>    <span class="hljs-keyword">return</span> CollectionUtils.isNotEmpty(personPlayers) ? Result.success(personPlayers) : Result.success();<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>service层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 通过国家或者球队查询球员</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;personPlayer&gt; <span class="hljs-title">searchTerm</span><span class="hljs-params">(String key, String val, Integer page, Integer limit)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>    <span class="hljs-comment">// 获取 SearchRequest</span><br>    SearchRequest searchRequest = <span class="hljs-keyword">new</span> SearchRequest(person_INDEX);<br>    <span class="hljs-comment">// 创建 SearchSourceBuilder 用于查询语句</span><br>    SearchSourceBuilder searchSourceBuilder = <span class="hljs-keyword">new</span> SearchSourceBuilder();<br>    searchSourceBuilder<br>            <span class="hljs-comment">// 查询 通过match查询 key 字段名称 val 字段值</span><br>            .query(QueryBuilders.termQuery(key, val))<br>            <span class="hljs-comment">// 起始页</span><br>            .from(page)<br>            <span class="hljs-comment">// 显示条数</span><br>            .size(limit);<br>    <span class="hljs-comment">// 设置 请求源 理解为设置查询语句</span><br>    searchRequest.source(searchSourceBuilder);<br>    <span class="hljs-comment">// 获取 SearchResponse 查询数据</span><br>    SearchResponse searchResponse = restHighLevelClient.search(searchRequest, RequestOptions.DEFAULT);<br>    <span class="hljs-comment">// 获取碰撞之后的结果 (固定写法)</span><br>    SearchHit[] hits = searchResponse.getHits().getHits();<br>    <span class="hljs-comment">// 进行对象转换并返回</span><br>    <span class="hljs-keyword">return</span> Stream.of(hits)<br>            .map(e -&gt; JSON.parseObject(e.getSourceAsString(), personPlayer.class))<br>            .collect(Collectors.toList());<br>&#125;<br></code></pre></td></tr></table></figure>


<h5 id="8-2-4-通过姓名字母查找球员"><a href="#8-2-4-通过姓名字母查找球员" class="headerlink" title="8.2.4 通过姓名字母查找球员"></a>8.2.4 通过姓名字母查找球员</h5><ul>
<li>controller层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 通过姓名字母查找球员</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@GetMapping(&quot;/searchPrefix&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Result <span class="hljs-title">searchPrefix</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = &quot;prefix&quot;, required = false, defaultValue = &quot;A&quot;)</span> String prefix,</span></span><br><span class="hljs-params"><span class="hljs-function">                           <span class="hljs-meta">@RequestParam(value = &quot;page&quot;, required = false, defaultValue = &quot;0&quot;)</span> Integer page,</span></span><br><span class="hljs-params"><span class="hljs-function"></span></span><br><span class="hljs-params"><span class="hljs-function">                           <span class="hljs-meta">@RequestParam(value = &quot;limit&quot;, required = false, defaultValue = &quot;10&quot;)</span> Integer limit)</span> </span>&#123;<br>    List&lt;personPlayer&gt; personPlayers = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">try</span> &#123;<br>        personPlayers = personPlayerService.searchPrefix(prefix, page, limit);<br>    &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>        log.error(<span class="hljs-string">&quot;searchPrefix失败,参数[prefix=&#123;&#125;]]&quot;</span>, prefix);<br>        e.printStackTrace();<br>    &#125;<br>    <span class="hljs-keyword">return</span> CollectionUtils.isNotEmpty(personPlayers) ? Result.success(personPlayers) : Result.success();<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>service层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 通过姓名字母查找球员</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;personPlayer&gt; <span class="hljs-title">searchPrefix</span><span class="hljs-params">(String prefix, Integer page, Integer limit)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>    <span class="hljs-comment">// 获取 SearchRequest</span><br>    SearchRequest searchRequest = <span class="hljs-keyword">new</span> SearchRequest(person_INDEX);<br>    <span class="hljs-comment">// 创建 SearchSourceBuilder 用于查询语句</span><br>    SearchSourceBuilder searchSourceBuilder = <span class="hljs-keyword">new</span> SearchSourceBuilder();<br>    searchSourceBuilder<br>            <span class="hljs-comment">// 查询 通过prefix查询 displayNameEn.keyword 名字字段 prefix 前缀字母</span><br>            .query(QueryBuilders.prefixQuery(<span class="hljs-string">&quot;displayNameEn.keyword&quot;</span>, prefix))<br>            <span class="hljs-comment">// 起始页</span><br>            .from(page)<br>            <span class="hljs-comment">// 显示条数</span><br>            .size(limit);<br>    <span class="hljs-comment">// 设置 请求源 理解为设置查询语句</span><br>    searchRequest.source(searchSourceBuilder);<br>    <span class="hljs-comment">// 获取 SearchResponse 查询数据</span><br>    SearchResponse searchResponse = restHighLevelClient.search(searchRequest, RequestOptions.DEFAULT);<br>    <span class="hljs-comment">// 获取碰撞之后的结果 (固定写法)</span><br>    SearchHit[] hits = searchResponse.getHits().getHits();<br>    <span class="hljs-comment">// 进行对象转换并返回</span><br>    <span class="hljs-keyword">return</span> Stream.of(hits)<br>            .map(e -&gt; JSON.parseObject(e.getSourceAsString(), personPlayer.class))<br>            .collect(Collectors.toList());<br>&#125;<br></code></pre></td></tr></table></figure>

              
            </div>
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%AF%87/" class="category-chain-item">中间件篇</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Elasticsearch/">#Elasticsearch</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>中间件篇-ElasticSearch7.x教程</div>
      <div>https://mikeygithub.github.io/2021/03/30/yuque/tesk05/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Mikey</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2021年3月30日</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>许可协议</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - 署名">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/04/04/yuque/nhfllh/" title="笔记篇-分布式锁的实现">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">笔记篇-分布式锁的实现</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/03/29/yuque/uoxpex/" title="Java篇-Java解析大型XML文件">
                        <span class="hidden-mobile">Java篇-Java解析大型XML文件</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <script type="text/javascript">
    Fluid.utils.loadComments('#comments', function() {
      var light = 'github-light';
      var dark = 'github-dark';
      var schema = document.documentElement.getAttribute('data-user-color-scheme');
      if (schema === 'dark') {
        schema = dark;
      } else {
        schema = light;
      }
      window.UtterancesThemeLight = light;
      window.UtterancesThemeDark = dark;
      var s = document.createElement('script');
      s.setAttribute('src', 'https://utteranc.es/client.js');
      s.setAttribute('repo', 'mikeygithub/commit-utterance');
      s.setAttribute('issue-term', 'pathname');
      
      s.setAttribute('label', 'utterances');
      
      s.setAttribute('theme', schema);
      s.setAttribute('crossorigin', 'anonymous');
      document.getElementById('comments').appendChild(s);
    })
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  





  <script>
  Fluid.utils.createScript('https://lib.baomitu.com/mermaid/8.13.10/mermaid.min.js', function() {
    mermaid.initialize({"theme":"default"});
  });
</script>




  <!-- Custom -->
  <div class="col-lg-7 mx-auto nopadding-x-md">
    <div class="container custom post-custom mx-auto">
      <img src="https://octodex.github.com/images/jetpacktocat.png" srcset="/img/loading.gif" lazyload class="rounded mx-auto d-block mt-5" style="width:150px; height:150px;">
    </div>
  </div>


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       Copyright © 麦奇 Powered by <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> and <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> core on github page 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
    <!-- 备案信息 ICP for China -->
    <div class="beian">
  <span>
    <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
      桂ICP备2020009931号-1
    </a>
  </span>
  
    
      <span>
        <a
          href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=2020009931"
          rel="nofollow noopener"
          class="beian-police"
          target="_blank"
        >
          
            <span style="visibility: hidden; width: 0">|</span>
            <img src="/img/police_beian.png" srcset="/img/loading.gif" lazyload alt="police-icon"/>
          
          <span>桂公网安备2020009931号</span>
        </a>
      </span>
    
  
</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":200})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <!-- Baidu Analytics -->
    <script defer>
      if (!Fluid.ctx.dnt) {
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?74301a15e5497361e93588eeee69f4b2";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
      }
    </script>
  

  

  

  

  

  

  




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.0/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script>
  (function() {
    var enableLang = CONFIG.code_language.enable && CONFIG.code_language.default;
    var enableCopy = CONFIG.copy_btn;
    if (!enableLang && !enableCopy) {
      return;
    }

    function getBgClass(ele) {
      return Fluid.utils.getBackgroundLightness(ele) >= 0 ? 'code-widget-light' : 'code-widget-dark';
    }

    var copyTmpl = '';
    copyTmpl += '<div class="code-widget">';
    copyTmpl += 'LANG';
    copyTmpl += '</div>';
    jQuery('.markdown-body pre').each(function() {
      var $pre = jQuery(this);
      if ($pre.find('code.mermaid').length > 0) {
        return;
      }
      if ($pre.find('span.line').length > 0) {
        return;
      }

      var lang = '';

      if (enableLang) {
        lang = CONFIG.code_language.default;
        if ($pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2 && $pre.children().hasClass('hljs')) {
          lang = $pre[0].children[0].classList[1];
        } else if ($pre[0].getAttribute('data-language')) {
          lang = $pre[0].getAttribute('data-language');
        } else if ($pre.parent().hasClass('sourceCode') && $pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2) {
          lang = $pre[0].children[0].classList[1];
          $pre.parent().addClass('code-wrapper');
        } else if ($pre.parent().hasClass('markdown-body') && $pre[0].classList.length === 0) {
          $pre.wrap('<div class="code-wrapper"></div>');
        }
        lang = lang.toUpperCase().replace('NONE', CONFIG.code_language.default);
      }
      $pre.append(copyTmpl.replace('LANG', lang).replace('code-widget">',
        getBgClass($pre[0]) + (enableCopy ? ' code-widget copy-btn" data-clipboard-snippet><i class="iconfont icon-copy"></i>' : ' code-widget">')));

      if (enableCopy) {
        Fluid.utils.createScript('https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js', function() {
          var clipboard = new window.ClipboardJS('.copy-btn', {
            target: function(trigger) {
              var nodes = trigger.parentNode.childNodes;
              for (var i = 0; i < nodes.length; i++) {
                if (nodes[i].tagName === 'CODE') {
                  return nodes[i];
                }
              }
            }
          });
          clipboard.on('success', function(e) {
            e.clearSelection();
            e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-copy', 'icon-success');
            setTimeout(function() {
              e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-success', 'icon-copy');
            }, 2000);
          });
        });
      }
    });
  })();
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        MathJax = {
          tex    : {
            inlineMath: { '[+]': [['$', '$']] }
          },
          loader : {
            load: ['ui/lazy']
          },
          options: {
            renderActions: {
              findScript    : [10, doc => {
                document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
                  const display = !!node.type.match(/; *mode=display/);
                  const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                  const text = document.createTextNode('');
                  node.parentNode.replaceChild(text, node);
                  math.start = { node: text, delim: '', n: 0 };
                  math.end = { node: text, delim: '', n: 0 };
                  doc.math.push(math);
                });
              }, '', false],
              insertedScript: [200, () => {
                document.querySelectorAll('mjx-container').forEach(node => {
                  let target = node.parentNode;
                  if (target.nodeName.toLowerCase() === 'li') {
                    target.parentNode.classList.add('has-jax');
                  }
                });
              }, '', false]
            }
          }
        };
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.0/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
