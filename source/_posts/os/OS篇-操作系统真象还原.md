---
title: OS篇-操作系统真象还原
index_img: 'https://cdn.jsdelivr.net/gh/mikeygithub/jsDeliver@master/resource/img/czxt-zxhy.png'
hide: false
date: 2021-02-21 22:09:25
category: 操作系统
tags: 手写操作系统
---

# 条件准备

# 准备知识

## 软件是如何访问硬件的

>硬件是各种各样的,发展速度还是非常快的。各个硬件都有自己的个性,操作系统不可能及时更新各
种硬件的驱动方法吧。比如,刚出来某个新硬件,OS 开发者们便开始为其写驱动,这不太现实,会把人
累死的。于是乎,便出现了各种硬件适配设备,这就是 IO 接口。接口其实就是标准,大家生产出来的硬
件按照这个标准工作就实现了通用。
硬件在输入输出上大体分为串行和并行,相应的接口也就是串行接口和并行接口。串行硬件通过串行
接口与 CPU 通信,反过来也是,CPU 通过串行接口与串行设备数据传输。并行设备的访问类似,只不过
是通过并行接口进行的。
访问外部硬件有两个方式。
(1)将某个外设的内存映射到一定范围的地址空间中,CPU 通过地址总线访问该内存区域时会落到外设
的内存中,这种映射让 CPU 访问外设的内存就如同访问主板上的物理内存一样。有的设备是这样做的,比如
显卡,显卡是显示器的适配器,CPU 不直接和显示器交互,它只和显卡通信。显卡上有片内存叫显存,它被
映射到主机物理内存上的低端 1MB 的 0xB8000~0xBFFFF。CPU 访问这片内存就是访问显存,往这片内存上
写字节便是往屏幕上打印内容。看上去这么高大上的做法是怎么实现的,这个我们就不关心了,前面说过,计
算机中处处是分层,我们要充分相信上一层的工作。
(2)外设是通过 IO 接口与 CPU 通信的,CPU 访问外设,就是访问 IO 接口,由 IO 接口将信息传递
给另一端的外设,也就是说,CPU 从来不知道有这些设备的存在,它只知道自己操作的 IO 接口,你看,
处处体现着分层。
于是问题来了,如何访问到 IO 接口呢,答案就是 IO 接口上面有一些寄存器,访问 IO 接口本质上就是
访问这些寄存器,这些寄存器就是人们常说的端口。这些端口是人家 IO 接口给咱们提供的接口。人家接口
电路也有自己的思维(系统)
,看到寄存器中写了什么就做出相应的反应。接口提供接口,哈哈,有意思。
不过这是人家的约定,没有约定就乱了,各干各的,大家都累,咱们只要遵循人家的规定就能访问成功。

# 参考资料

[《操作系统真相还原》](https://cdn.jsdelivr.net/gh/mikeygithub/jsDeliver@master/resource/pdf/操作系统真象还原.pdf)
