---
title: 算法篇-牛顿迭代法求平方根
index_img: https://cdn.jsdelivr.net/gh/mikeygithub/jsDeliver@master/resource/img/niudun.gif
hide: false
date: 2021-01-08 10:59:26
category: 算法学习
tags: 求平方根
---

# 简介

<p class="note note-primary">
    牛顿迭代法（Newton's method）又称为牛顿-拉夫逊（拉弗森）方法（Newton-Raphson method），它是牛顿在17世纪提出的一种在实数域和复数域上近似求解方程的方法。
</p>

联系知识

<p class="note note-primary">
    泰勒公式:泰勒公式是一个用函数在某点的信息描述其附近取值的公式。如果函数足够平滑的话，在已知函数在某一点的各阶导数值的情况之下，泰勒公式可以用这些导数值做系数构建一个多项式来近似函数在这一点的邻域中的值。
</p>

公式 = `f(x)=f(x0)+f'(x0)*(x-x0)+f''(x0)/2!*(x-x0)^2+...+f(n)(x0)/n!*(x-x0)^n`

$$f(x)=\sum_{i=0}^\infty\frac{f^n(a)}{n!}{(x-a)}^n$$

f(n)(x.)是f(x.)的n阶导数

# 具体内容

<p class="note note-primary">
    其采用一阶泰勒展开，f(x) = 0,求 x = ? 
</p>

$$f(x)=f(x_0)+(x-x_0)f'(x_0)$$

$$x=x_0-\frac{f(x_0)}{f'(x_0)}$$

$$x_{n+1}=x_n-\frac{f(x_n)}{f'(x_n)}$$

# 简单例子

<p class="note note-primary">
    求x平方根？
</p>

$$\sqrt{x}$$ 
$$y=\sqrt{x}$$ 
$$y^2=x$$
$$y^2-x=0$$

令 $$y_0=x$$
则 $$y_{n+1}=y_n-\frac{f(y_n)}{f'(y_n)}=y_n-\frac{y_n^2-x}{2y_n}=\frac{y_n^2+x}{2y_n}=\frac{y_n+\frac{x}{y_n}}{2}$$

<p class="note note-primary">
    求三次方根？
</p>

# 代码实现

Java实现开平方的牛顿迭代法. 求c(c>0)的算术平方根就是求 $$f(x) = x^2-c$$ 的正根, 
得迭代公式: $$x_{n+1}=\frac{1}{2}(x_n+\frac{c}{x_n})$$
代码中取初始值 c , 误差控制在 $$ 1*10^{-15} $$

```java
class Solution{
    public static double sqrt(double c) {
        if (c < 0) return Double.NaN;
        double e = 1e-15;
        double x = c;
        double y = (x + c / x) / 2;
        while (Math.abs(x - y) > e) {
            x = y;
            y = (x + c / x) / 2;
        }
        return x;
    }
}
```

# 参考资料

[如何通俗易懂地讲解牛顿迭代法？](https://www.matongxue.com/madocs/205/)

[基本数学公式语法(of MathJax)](https://blog.csdn.net/ethmery/article/details/50670297)

[牛顿迭代法](https://www.mobibrw.com/2020/23324)


 